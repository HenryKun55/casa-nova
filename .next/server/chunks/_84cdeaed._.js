module.exports=[98323,e=>{"use strict";var t,i,r,n,s,o,a=Object.create,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,h=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty,d=(e,t)=>l(e,"name",{value:t,configurable:!0}),p=(e,t)=>()=>(e&&(t=e(e=0)),t),g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),m=(e,t)=>{for(var i in t)l(e,i,{get:t[i],enumerable:!0})},y=(e,t,i,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of c(t))f.call(e,n)||n===i||l(e,n,{get:()=>t[n],enumerable:!(r=u(t,n))||r.enumerable});return e},b=(e,t,i)=>(i=null!=e?a(h(e)):{},y(!t&&e&&e.__esModule?i:l(i,"default",{value:e,enumerable:!0}),e)),w=e=>y(l({},"__esModule",{value:!0}),e),v=(e,t,i)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?l(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i},S=g(e=>{P(),e.byteLength=l,e.toByteArray=c,e.fromByteArray=p;var t,i,r=[],n=[],s="u">typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,i=o.length;t<i;++t)r[t]=o[t],n[o.charCodeAt(t)]=t;function a(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var r=i===t?0:4-i%4;return[i,r]}function l(e){var t=a(e),i=t[0],r=t[1];return(i+r)*3/4-r}function u(e,t,i){return(t+i)*3/4-i}function c(e){var t,i,r=a(e),o=r[0],l=r[1],c=new s(u(e,o,l)),h=0,f=l>0?o-4:o;for(i=0;i<f;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],c[h++]=t>>16&255,c[h++]=t>>8&255,c[h++]=255&t;return 2===l&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,c[h++]=255&t),1===l&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,c[h++]=t>>8&255,c[h++]=255&t),c}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,i){for(var r=[],n=t;n<i;n+=3)r.push(h((e[n]<<16&0xff0000)+(e[n+1]<<8&65280)+(255&e[n+2])));return r.join("")}function p(e){for(var t,i=e.length,n=i%3,s=[],o=0,a=i-n;o<a;o+=16383)s.push(f(e,o,o+16383>a?a:o+16383));return 1===n?s.push(r[(t=e[i-1])>>2]+r[t<<4&63]+"=="):2===n&&s.push(r[(t=(e[i-2]<<8)+e[i-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")}n[45]=62,n[95]=63,d(a,"getLens"),d(l,"byteLength"),d(u,"_byteLength"),d(c,"toByteArray"),d(h,"tripletToBase64"),d(f,"encodeChunk"),d(p,"fromByteArray")}),x=g(e=>{P(),e.read=function(e,t,i,r,n){var s,o,a=8*n-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=i?n-1:0,f=i?-1:1,d=e[t+h];for(h+=f,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+e[t+h],h+=f,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=256*o+e[t+h],h+=f,c-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=u}return(d?-1:1)*o*Math.pow(2,s-r)},e.write=function(e,t,i,r,n,s){var o,a,l,u=8*s-n-1,c=(1<<u)-1,h=c>>1,f=5960464477539062e-23*(23===n),d=r?0:s-1,p=r?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?t+=f/l:t+=f*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=c?(a=0,o=c):o+h>=1?(a=(t*l-1)*Math.pow(2,n),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;e[i+d]=255&a,d+=p,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;e[i+d]=255&o,d+=p,o/=256,u-=8);e[i+d-p]|=128*g}}),C=g(e=>{P();var t=S(),i=x(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function n(){try{let e=new Uint8Array(1),t={foo:d(function(){return 42},"foo")};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,i){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return a(e,t,i)}function a(e,t,i){if("string"==typeof e)return h(e,t);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(eo(e,ArrayBuffer)||e&&eo(e.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(eo(e,SharedArrayBuffer)||e&&eo(e.buffer,SharedArrayBuffer)))return g(e,t,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,i);let n=m(e);if(n)return n;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e,t,i){return l(e),e<=0?s(e):void 0!==t?"string"==typeof i?s(e).fill(t,i):s(e).fill(t):s(e)}function c(e){return l(e),s(e<0?0:0|y(e))}function h(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw TypeError("Unknown encoding: "+t);let i=0|w(e,t),r=s(i),n=r.write(e,t);return n!==i&&(r=r.slice(0,n)),r}function f(e){let t=e.length<0?0:0|y(e.length),i=s(t);for(let r=0;r<t;r+=1)i[r]=255&e[r];return i}function p(e){if(eo(e,Uint8Array)){let t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength)}return f(e)}function g(e,t,i){let r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),o.prototype),r}function m(e){if(o.isBuffer(e)){let t=0|y(e.length),i=s(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0!==e.length?"number"!=typeof e.length||ea(e.length)?s(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}function y(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function b(e){return+e!=e&&(e=0),o.alloc(+e)}function w(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||eo(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let i=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return et(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return en(e).length;default:if(n)return r?-1:et(e).length;t=(""+t).toLowerCase(),n=!0}}function v(e,t,i){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0)||(i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return k(this,t,i);case"latin1":case"binary":return D(this,t,i);case"base64":return B(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,i);default:if(r)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function C(e,t,i){let r=e[t];e[t]=e[i],e[i]=r}function T(e,t,i,r,n){if(0===e.length)return -1;if("string"==typeof i?(r=i,i=0):i>0x7fffffff?i=0x7fffffff:i<-0x80000000&&(i=-0x80000000),ea(i*=1)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return -1;i=e.length-1}else if(i<0)if(!n)return -1;else i=0;if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:E(e,t,i,r,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):E(e,[t],i,r,n);throw TypeError("val must be string, number or Buffer")}function E(e,t,i,r,n){let s,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,i/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(d(u,"read"),n){let r=-1;for(s=i;s<a;s++)if(u(e,s)===u(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===l)return r*o}else -1!==r&&(s-=s-r),r=-1}else for(i+l>a&&(i=a-l),s=i;s>=0;s--){let i=!0;for(let r=0;r<l;r++)if(u(e,s+r)!==u(t,r)){i=!1;break}if(i)return s}return -1}function _(e,t,i,r){let n;i=Number(i)||0;let s=e.length-i;r?(r=Number(r))>s&&(r=s):r=s;let o=t.length;for(r>o/2&&(r=o/2),n=0;n<r;++n){let r=parseInt(t.substr(2*n,2),16);if(ea(r))break;e[i+n]=r}return n}function A(e,t,i,r){return es(et(t,e.length-i),e,i,r)}function N(e,t,i,r){return es(ei(t),e,i,r)}function q(e,t,i,r){return es(en(t),e,i,r)}function L(e,t,i,r){return es(er(t,e.length-i),e,i,r)}function B(e,i,r){return 0===i&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(i,r))}function I(e,t,i){i=Math.min(e.length,i);let r=[],n=t;for(;n<i;){let t=e[n],s=null,o=t>239?4:t>223?3:t>191?2:1;if(n+o<=i){let i,r,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:(192&(i=e[n+1]))==128&&(l=(31&t)<<6|63&i)>127&&(s=l);break;case 3:i=e[n+1],r=e[n+2],(192&i)==128&&(192&r)==128&&(l=(15&t)<<12|(63&i)<<6|63&r)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:i=e[n+1],r=e[n+2],a=e[n+3],(192&i)==128&&(192&r)==128&&(192&a)==128&&(l=(15&t)<<18|(63&i)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),n+=o}return O(r)}function O(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let i="",r=0;for(;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return i}function k(e,t,i){let r="";i=Math.min(e.length,i);for(let n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}function D(e,t,i){let r="";i=Math.min(e.length,i);for(let n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}function M(e,t,i){let r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);let n="";for(let r=t;r<i;++r)n+=el[e[r]];return n}function R(e,t,i){let r=e.slice(t,i),n="";for(let e=0;e<r.length-1;e+=2)n+=String.fromCharCode(r[e]+256*r[e+1]);return n}function Q(e,t,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>i)throw RangeError("Trying to access beyond buffer length")}function $(e,t,i,r,n,s){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw RangeError('"value" argument is out of bounds');if(i+r>e.length)throw RangeError("Index out of range")}function F(e,t,i,r,n){J(t,r,n,e,i,7);let s=Number(t&BigInt(0xffffffff));e[i++]=s,s>>=8,e[i++]=s,s>>=8,e[i++]=s,s>>=8,e[i++]=s;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,i}function U(e,t,i,r,n){J(t,r,n,e,i,7);let s=Number(t&BigInt(0xffffffff));e[i+7]=s,s>>=8,e[i+6]=s,s>>=8,e[i+5]=s,s>>=8,e[i+4]=s;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[i+3]=o,o>>=8,e[i+2]=o,o>>=8,e[i+1]=o,o>>=8,e[i]=o,i+8}function j(e,t,i,r,n,s){if(i+r>e.length||i<0)throw RangeError("Index out of range")}function K(e,t,r,n,s){return t*=1,r>>>=0,s||j(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function z(e,t,r,n,s){return t*=1,r>>>=0,s||j(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}e.Buffer=o,e.SlowBuffer=b,e.INSPECT_MAX_BYTES=50,e.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=n(),!o.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),d(n,"typedArraySupport"),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:d(function(){if(o.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:d(function(){if(o.isBuffer(this))return this.byteOffset},"get")}),d(s,"createBuffer"),d(o,"Buffer"),o.poolSize=8192,d(a,"from"),o.from=function(e,t,i){return a(e,t,i)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),d(l,"assertSize"),d(u,"alloc"),o.alloc=function(e,t,i){return u(e,t,i)},d(c,"allocUnsafe"),o.allocUnsafe=function(e){return c(e)},o.allocUnsafeSlow=function(e){return c(e)},d(h,"fromString"),d(f,"fromArrayLike"),d(p,"fromArrayView"),d(g,"fromArrayBuffer"),d(m,"fromObject"),d(y,"checked"),d(b,"SlowBuffer"),o.isBuffer=d(function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},"isBuffer"),o.compare=d(function(e,t){if(eo(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),eo(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,r=t.length;for(let n=0,s=Math.min(i,r);n<s;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:+(r<i)},"compare"),o.isEncoding=d(function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),o.concat=d(function(e,t){let i;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let r=o.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){let t=e[i];if(eo(t,Uint8Array))n+t.length>r.length?(o.isBuffer(t)||(t=o.from(t)),t.copy(r,n)):Uint8Array.prototype.set.call(r,t,n);else if(o.isBuffer(t))t.copy(r,n);else throw TypeError('"list" argument must be an Array of Buffers');n+=t.length}return r},"concat"),d(w,"byteLength"),o.byteLength=w,d(v,"slowToString"),o.prototype._isBuffer=!0,d(C,"swap"),o.prototype.swap16=d(function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)C(this,t,t+1);return this},"swap16"),o.prototype.swap32=d(function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)C(this,t,t+3),C(this,t+1,t+2);return this},"swap32"),o.prototype.swap64=d(function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)C(this,t,t+7),C(this,t+1,t+6),C(this,t+2,t+5),C(this,t+3,t+4);return this},"swap64"),o.prototype.toString=d(function(){let e=this.length;return 0===e?"":0==arguments.length?I(this,0,e):v.apply(this,arguments)},"toString"),o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=d(function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},"equals"),o.prototype.inspect=d(function(){let t="",i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},"inspect"),r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=d(function(e,t,i,r,n){if(eo(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw RangeError("out of range index");if(r>=n&&t>=i)return 0;if(r>=n)return -1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,n>>>=0,this===e)return 0;let s=n-r,a=i-t,l=Math.min(s,a),u=this.slice(r,n),c=e.slice(t,i);for(let e=0;e<l;++e)if(u[e]!==c[e]){s=u[e],a=c[e];break}return s<a?-1:+(a<s)},"compare"),d(T,"bidirectionalIndexOf"),d(E,"arrayIndexOf"),o.prototype.includes=d(function(e,t,i){return -1!==this.indexOf(e,t,i)},"includes"),o.prototype.indexOf=d(function(e,t,i){return T(this,e,t,i,!0)},"indexOf"),o.prototype.lastIndexOf=d(function(e,t,i){return T(this,e,t,i,!1)},"lastIndexOf"),d(_,"hexWrite"),d(A,"utf8Write"),d(N,"asciiWrite"),d(q,"base64Write"),d(L,"ucs2Write"),o.prototype.write=d(function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let n=this.length-t;if((void 0===i||i>n)&&(i=n),e.length>0&&(i<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return _(this,e,t,i);case"utf8":case"utf-8":return A(this,e,t,i);case"ascii":case"latin1":case"binary":return N(this,e,t,i);case"base64":return q(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,t,i);default:if(s)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},"write"),o.prototype.toJSON=d(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON"),d(B,"base64Slice"),d(I,"utf8Slice"),d(O,"decodeCodePointsArray"),d(k,"asciiSlice"),d(D,"latin1Slice"),d(M,"hexSlice"),d(R,"utf16leSlice"),o.prototype.slice=d(function(e,t){let i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);let r=this.subarray(e,t);return Object.setPrototypeOf(r,o.prototype),r},"slice"),d(Q,"checkOffset"),o.prototype.readUintLE=o.prototype.readUIntLE=d(function(e,t,i){e>>>=0,t>>>=0,i||Q(e,t,this.length);let r=this[e],n=1,s=0;for(;++s<t&&(n*=256);)r+=this[e+s]*n;return r},"readUIntLE"),o.prototype.readUintBE=o.prototype.readUIntBE=d(function(e,t,i){e>>>=0,t>>>=0,i||Q(e,t,this.length);let r=this[e+--t],n=1;for(;t>0&&(n*=256);)r+=this[e+--t]*n;return r},"readUIntBE"),o.prototype.readUint8=o.prototype.readUInt8=d(function(e,t){return e>>>=0,t||Q(e,1,this.length),this[e]},"readUInt8"),o.prototype.readUint16LE=o.prototype.readUInt16LE=d(function(e,t){return e>>>=0,t||Q(e,2,this.length),this[e]|this[e+1]<<8},"readUInt16LE"),o.prototype.readUint16BE=o.prototype.readUInt16BE=d(function(e,t){return e>>>=0,t||Q(e,2,this.length),this[e]<<8|this[e+1]},"readUInt16BE"),o.prototype.readUint32LE=o.prototype.readUInt32LE=d(function(e,t){return e>>>=0,t||Q(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},"readUInt32LE"),o.prototype.readUint32BE=o.prototype.readUInt32BE=d(function(e,t){return e>>>=0,t||Q(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},"readUInt32BE"),o.prototype.readBigUInt64LE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];(void 0===t||void 0===i)&&Z(e,this.length-8);let r=t+256*this[++e]+65536*this[++e]+0x1000000*this[++e],n=this[++e]+256*this[++e]+65536*this[++e]+0x1000000*i;return BigInt(r)+(BigInt(n)<<BigInt(32))},"readBigUInt64LE")),o.prototype.readBigUInt64BE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];(void 0===t||void 0===i)&&Z(e,this.length-8);let r=0x1000000*t+65536*this[++e]+256*this[++e]+this[++e],n=0x1000000*this[++e]+65536*this[++e]+256*this[++e]+i;return(BigInt(r)<<BigInt(32))+BigInt(n)},"readBigUInt64BE")),o.prototype.readIntLE=d(function(e,t,i){e>>>=0,t>>>=0,i||Q(e,t,this.length);let r=this[e],n=1,s=0;for(;++s<t&&(n*=256);)r+=this[e+s]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},"readIntLE"),o.prototype.readIntBE=d(function(e,t,i){e>>>=0,t>>>=0,i||Q(e,t,this.length);let r=t,n=1,s=this[e+--r];for(;r>0&&(n*=256);)s+=this[e+--r]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},"readIntBE"),o.prototype.readInt8=d(function(e,t){return e>>>=0,t||Q(e,1,this.length),128&this[e]?-((255-this[e]+1)*1):this[e]},"readInt8"),o.prototype.readInt16LE=d(function(e,t){e>>>=0,t||Q(e,2,this.length);let i=this[e]|this[e+1]<<8;return 32768&i?0xffff0000|i:i},"readInt16LE"),o.prototype.readInt16BE=d(function(e,t){e>>>=0,t||Q(e,2,this.length);let i=this[e+1]|this[e]<<8;return 32768&i?0xffff0000|i:i},"readInt16BE"),o.prototype.readInt32LE=d(function(e,t){return e>>>=0,t||Q(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},"readInt32LE"),o.prototype.readInt32BE=d(function(e,t){return e>>>=0,t||Q(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},"readInt32BE"),o.prototype.readBigInt64LE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];return(void 0===t||void 0===i)&&Z(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(i<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+0x1000000*this[++e])},"readBigInt64LE")),o.prototype.readBigInt64BE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];return(void 0===t||void 0===i)&&Z(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(0x1000000*this[++e]+65536*this[++e]+256*this[++e]+i)},"readBigInt64BE")),o.prototype.readFloatLE=d(function(e,t){return e>>>=0,t||Q(e,4,this.length),i.read(this,e,!0,23,4)},"readFloatLE"),o.prototype.readFloatBE=d(function(e,t){return e>>>=0,t||Q(e,4,this.length),i.read(this,e,!1,23,4)},"readFloatBE"),o.prototype.readDoubleLE=d(function(e,t){return e>>>=0,t||Q(e,8,this.length),i.read(this,e,!0,52,8)},"readDoubleLE"),o.prototype.readDoubleBE=d(function(e,t){return e>>>=0,t||Q(e,8,this.length),i.read(this,e,!1,52,8)},"readDoubleBE"),d($,"checkInt"),o.prototype.writeUintLE=o.prototype.writeUIntLE=d(function(e,t,i,r){if(e*=1,t>>>=0,i>>>=0,!r){let r=Math.pow(2,8*i)-1;$(this,e,t,i,r,0)}let n=1,s=0;for(this[t]=255&e;++s<i&&(n*=256);)this[t+s]=e/n&255;return t+i},"writeUIntLE"),o.prototype.writeUintBE=o.prototype.writeUIntBE=d(function(e,t,i,r){if(e*=1,t>>>=0,i>>>=0,!r){let r=Math.pow(2,8*i)-1;$(this,e,t,i,r,0)}let n=i-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+i},"writeUIntBE"),o.prototype.writeUint8=o.prototype.writeUInt8=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,1,255,0),this[t]=255&e,t+1},"writeUInt8"),o.prototype.writeUint16LE=o.prototype.writeUInt16LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},"writeUInt16LE"),o.prototype.writeUint16BE=o.prototype.writeUInt16BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},"writeUInt16BE"),o.prototype.writeUint32LE=o.prototype.writeUInt32LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},"writeUInt32LE"),o.prototype.writeUint32BE=o.prototype.writeUInt32BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},"writeUInt32BE"),d(F,"wrtBigUInt64LE"),d(U,"wrtBigUInt64BE"),o.prototype.writeBigUInt64LE=eu(d(function(e,t=0){return F(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),o.prototype.writeBigUInt64BE=eu(d(function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),o.prototype.writeIntLE=d(function(e,t,i,r){if(e*=1,t>>>=0,!r){let r=Math.pow(2,8*i-1);$(this,e,t,i,r-1,-r)}let n=0,s=1,o=0;for(this[t]=255&e;++n<i&&(s*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/s|0)-o&255;return t+i},"writeIntLE"),o.prototype.writeIntBE=d(function(e,t,i,r){if(e*=1,t>>>=0,!r){let r=Math.pow(2,8*i-1);$(this,e,t,i,r-1,-r)}let n=i-1,s=1,o=0;for(this[t+n]=255&e;--n>=0&&(s*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/s|0)-o&255;return t+i},"writeIntBE"),o.prototype.writeInt8=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},"writeInt8"),o.prototype.writeInt16LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},"writeInt16LE"),o.prototype.writeInt16BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},"writeInt16BE"),o.prototype.writeInt32LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},"writeInt32LE"),o.prototype.writeInt32BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},"writeInt32BE"),o.prototype.writeBigInt64LE=eu(d(function(e,t=0){return F(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),o.prototype.writeBigInt64BE=eu(d(function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE")),d(j,"checkIEEE754"),d(K,"writeFloat"),o.prototype.writeFloatLE=d(function(e,t,i){return K(this,e,t,!0,i)},"writeFloatLE"),o.prototype.writeFloatBE=d(function(e,t,i){return K(this,e,t,!1,i)},"writeFloatBE"),d(z,"writeDouble"),o.prototype.writeDoubleLE=d(function(e,t,i){return z(this,e,t,!0,i)},"writeDoubleLE"),o.prototype.writeDoubleBE=d(function(e,t,i){return z(this,e,t,!1,i)},"writeDoubleBE"),o.prototype.copy=d(function(e,t,i,r){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);let n=r-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),n},"copy"),o.prototype.fill=d(function(e,t,i,r){let n;if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){let t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(n=t;n<i;++n)this[n]=e;else{let s=o.isBuffer(e)?e:o.from(e,r),a=s.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<i-t;++n)this[n+t]=s[n%a]}return this},"fill");var V={};function W(e,t,i){var r;V[e]=(d(r=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}\
]: ${this.message}`}},"NodeError"),r)}function H(e){let t="",i=e.length,r=+("-"===e[0]);for(;i>=r+4;i-=3)t=`\
_${e.slice(i-3,i)}${t}`;return`${e.slice(0,i)}${t}`}function G(e,t,i){Y(t,"offset"),(void 0===e[t]||void 0===e[t+i])&&Z(t,e.length-(i+1))}function J(e,t,i,r,n,s){if(e>i||e<t){let r="bigint"==typeof t?"n":"",n;throw n=s>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r}\
 ** ${(s+1)*8}${r}`:`>= -(2${r} ** ${(s+1)*8-1}${r}) and < 2 ** ${(s+1)*8-1}${r}`:`>= ${t}${r} a\
nd <= ${i}${r}`,new V.ERR_OUT_OF_RANGE("value",n,e)}G(r,n,s)}function Y(e,t){if("number"!=typeof e)throw new V.ERR_INVALID_ARG_TYPE(t,"number",e)}function Z(e,t,i){throw Math.floor(e)!==e?(Y(e,i),new V.ERR_OUT_OF_RANGE(i||"offset","an integer",e)):t<0?new V.ERR_BUFFER_OUT_OF_BOUNDS:new V.ERR_OUT_OF_RANGE(i||"offset",`>= ${+!!i} and <= ${t}`,e)}d(W,"E"),W("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),W("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received typ\
e ${typeof t}`},TypeError),W("ERR_OUT_OF_RANGE",function(e,t,i){let r=`The value of "${e}" is out o\
f range.`,n=i;return Number.isInteger(i)&&Math.abs(i)>0x100000000?n=H(String(i)):"bigint"==typeof i&&(n=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(n=H(n)),n+="n"),r+=` It must be ${t}. Re\
ceived ${n}`},RangeError),d(H,"addNumericalSeparator"),d(G,"checkBounds"),d(J,"checkIntBI"),d(Y,"validateNumber"),d(Z,"boundsError");var X=/[^+/0-9A-Za-z-_]/g;function ee(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function et(e,t){t=t||1/0;let i,r=e.length,n=null,s=[];for(let o=0;o<r;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!n){if(i>56319||o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}n=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),n=i;continue}i=(n-55296<<10|i-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return s}function ei(e){let t=[];for(let i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function er(e,t){let i,r,n=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=(i=e.charCodeAt(s))>>8,n.push(i%256),n.push(r);return n}function en(e){return t.toByteArray(ee(e))}function es(e,t,i,r){let n;for(n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function eo(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ea(e){return e!=e}d(ee,"base64clean"),d(et,"utf8ToBytes"),d(ei,"asciiToBytes"),d(er,"utf16leToBytes"),d(en,"base64ToBytes"),d(es,"blitBuffer"),d(eo,"isInstance"),d(ea,"numberIsNaN");var el=function(){let e="0123456789abcdef",t=Array(256);for(let i=0;i<16;++i){let r=16*i;for(let n=0;n<16;++n)t[r+n]=e[i]+e[n]}return t}();function eu(e){return typeof BigInt>"u"?ec:e}function ec(){throw Error("BigInt not supported")}d(eu,"defineBigIntMethod"),d(ec,"BufferBigIntNotDefined")}),P=p(()=>{r=globalThis,n=globalThis.setImmediate??(e=>setTimeout(e,0)),globalThis.clearImmediate??(e=>clearTimeout(e)),s="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:C().Buffer,(o=globalThis.process??{}).env??(o.env={});try{o.nextTick(()=>{})}catch{let e=Promise.resolve();o.nextTick=e.then.bind(e)}}),T=g((e,t)=>{P();var i,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:d(function(e,t,i){return Function.prototype.apply.call(e,t,i)},"ReflectApply");function s(e){console&&console.warn&&console.warn(e)}i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?d(function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))},"ReflectOwnKeys"):d(function(e){return Object.getOwnPropertyNames(e)},"ReflectOwnKeys"),d(s,"ProcessEmitWarning");var o=Number.isNaN||d(function(e){return e!=e},"NumberIsNaN");function a(){a.init.call(this)}d(a,"EventEmitter"),t.exports=a,t.exports.once=v,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,i,r){var n,o,a;if(u(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),a=o[t]),void 0===a)a=o[t]=i,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[i,a]:[a,i]:r?a.unshift(i):a.push(i),(n=c(e))>0&&a.length>n&&!a.warned){a.warned=!0;var l=Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,s(l)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=f.bind(r);return n.listener=i,r.wrapFn=n,n}function g(e,t,i){var r=e._events;if(void 0===r)return[];var n=r[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?w(n):y(n,n.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function y(e,t){for(var i=Array(t),r=0;r<t;++r)i[r]=e[r];return i}function b(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function w(e){for(var t=Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}function v(e,t){return new Promise(function(i,r){function n(i){e.removeListener(t,s),r(i)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",n),i([].slice.call(arguments))}d(n,"errorListener"),d(s,"resolver"),x(e,t,s,{once:!0}),"error"!==t&&S(e,n,{once:!0})})}function S(e,t,i){"function"==typeof e.on&&x(e,"error",t,i)}function x(e,t,i,r){if("function"==typeof e.on)r.once?e.once(t,i):e.on(t,i);else if("function"==typeof e.addEventListener)e.addEventListener(t,d(function n(s){r.once&&e.removeEventListener(t,n),i(s)},"wrapListener"));else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}d(u,"checkListener"),Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:d(function(){return l},"get"),set:d(function(e){if("number"!=typeof e||e<0||o(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e},"set")}),a.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=d(function(e){if("number"!=typeof e||e<0||o(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},"setMaxListeners"),d(c,"_getMaxListeners"),a.prototype.getMaxListeners=d(function(){return c(this)},"getMaxListeners"),a.prototype.emit=d(function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var o,a=Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else for(var u=l.length,c=y(l,u),i=0;i<u;++i)n(c[i],this,t);return!0},"emit"),d(h,"_addListener"),a.prototype.addListener=d(function(e,t){return h(this,e,t,!1)},"addListener"),a.prototype.on=a.prototype.addListener,a.prototype.prependListener=d(function(e,t){return h(this,e,t,!0)},"prependListener"),d(f,"onceWrapper"),d(p,"_onceWrap"),a.prototype.once=d(function(e,t){return u(t),this.on(e,p(this,e,t)),this},"once"),a.prototype.prependOnceListener=d(function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},"prependOnceListener"),a.prototype.removeListener=d(function(e,t){var i,r,n,s,o;if(u(t),void 0===(r=this._events)||void 0===(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,n=s;break}if(n<0)return this;0===n?i.shift():b(i,n),1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},"removeListener"),a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=d(function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0==arguments.length){var n,s=Object.keys(i);for(r=0;r<s.length;++r)"removeListener"!==(n=s[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},"removeAllListeners"),d(g,"_listeners"),a.prototype.listeners=d(function(e){return g(this,e,!0)},"listeners"),a.prototype.rawListeners=d(function(e){return g(this,e,!1)},"rawListeners"),a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,d(m,"listenerCount"),a.prototype.eventNames=d(function(){return this._eventsCount>0?i(this._events):[]},"eventNames"),d(y,"arrayClone"),d(b,"spliceOne"),d(w,"unwrapListeners"),d(v,"once"),d(S,"addErrorHandlerIfEventEmitter"),d(x,"eventTargetAgnosticAddListener")}),E={};function _(e){return 0}m(E,{Socket:()=>L,isIP:()=>_});var A,N,q,L,B=p(()=>{P(),A=b(T(),1),d(_,"isIP"),N=/^[^.]+\./,q=class e extends A.EventEmitter{constructor(){super(...arguments),v(this,"opts",{}),v(this,"connecting",!1),v(this,"pending",!0),v(this,"writable",!0),v(this,"encrypted",!1),v(this,"authorized",!1),v(this,"destroyed",!1),v(this,"ws",null),v(this,"writeBuffer"),v(this,"tlsState",0),v(this,"tlsRead"),v(this,"tlsWrite")}static get poolQueryViaFetch(){return e.opts.poolQueryViaFetch??e.defaults.poolQueryViaFetch}static set poolQueryViaFetch(t){e.opts.poolQueryViaFetch=t}static get fetchEndpoint(){return e.opts.fetchEndpoint??e.defaults.fetchEndpoint}static set fetchEndpoint(t){e.opts.fetchEndpoint=t}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return e.opts.fetchFunction??e.defaults.fetchFunction}static set fetchFunction(t){e.opts.fetchFunction=t}static get webSocketConstructor(){return e.opts.webSocketConstructor??e.defaults.webSocketConstructor}static set webSocketConstructor(t){e.opts.webSocketConstructor=t}get webSocketConstructor(){return this.opts.webSocketConstructor??e.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return e.opts.wsProxy??e.defaults.wsProxy}static set wsProxy(t){e.opts.wsProxy=t}get wsProxy(){return this.opts.wsProxy??e.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return e.opts.coalesceWrites??e.defaults.coalesceWrites}static set coalesceWrites(t){e.opts.coalesceWrites=t}get coalesceWrites(){return this.opts.coalesceWrites??e.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return e.opts.useSecureWebSocket??e.defaults.useSecureWebSocket}static set useSecureWebSocket(t){e.opts.useSecureWebSocket=t}get useSecureWebSocket(){return this.opts.useSecureWebSocket??e.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return e.opts.forceDisablePgSSL??e.defaults.forceDisablePgSSL}static set forceDisablePgSSL(t){e.opts.forceDisablePgSSL=t}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??e.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return e.opts.disableSNI??e.defaults.disableSNI}static set disableSNI(t){e.opts.disableSNI=t}get disableSNI(){return this.opts.disableSNI??e.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get disableWarningInBrowsers(){return e.opts.disableWarningInBrowsers??e.defaults.disableWarningInBrowsers}static set disableWarningInBrowsers(t){e.opts.disableWarningInBrowsers=t}get disableWarningInBrowsers(){return this.opts.disableWarningInBrowsers??e.disableWarningInBrowsers}set disableWarningInBrowsers(e){this.opts.disableWarningInBrowsers=e}static get pipelineConnect(){return e.opts.pipelineConnect??e.defaults.pipelineConnect}static set pipelineConnect(t){e.opts.pipelineConnect=t}get pipelineConnect(){return this.opts.pipelineConnect??e.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return e.opts.subtls??e.defaults.subtls}static set subtls(t){e.opts.subtls=t}get subtls(){return this.opts.subtls??e.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return e.opts.pipelineTLS??e.defaults.pipelineTLS}static set pipelineTLS(t){e.opts.pipelineTLS=t}get pipelineTLS(){return this.opts.pipelineTLS??e.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return e.opts.rootCerts??e.defaults.rootCerts}static set rootCerts(t){e.opts.rootCerts=t}get rootCerts(){return this.opts.rootCerts??e.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let i=this.wsProxy;if(void 0===i)throw Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return"function"==typeof i?i(e,t):`${i}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,i){this.connecting=!0,i&&this.once("connect",i);let r=d(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),n=d((e,t=!1)=>{e.binaryType="arraybuffer",e.addEventListener("error",e=>{this.emit("error",e),this.emit("close")}),e.addEventListener("message",e=>{if(0===this.tlsState){let t=s.from(e.data);this.emit("data",t)}}),e.addEventListener("close",()=>{this.emit("close")}),t?r():e.addEventListener("open",r)},"configureWebSocket"),o;try{o=this.wsProxyAddrForHost(t,"string"==typeof e?parseInt(e,10):e)}catch(e){this.emit("error",e),this.emit("close");return}try{let e=(this.useSecureWebSocket?"wss:":"ws:")+"//"+o;if(void 0!==this.webSocketConstructor)this.ws=new this.webSocketConstructor(e),n(this.ws);else try{this.ws=new WebSocket(e),n(this.ws)}catch{this.ws=new __unstable_WebSocket(e),n(this.ws)}}catch(e){fetch((this.useSecureWebSocket?"https:":"http:")+"//"+o,{headers:{Upgrade:"websocket"}}).then(t=>{if(this.ws=t.webSocket,null==this.ws)throw e;this.ws.accept(),n(this.ws,!0)}).catch(e=>{this.emit("error",Error(`All attempts to open a WebSocket to connect to the database failed. Please refer \
to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websoc\
ket--undefined. Details: ${e}`)),this.emit("close")})}}async startTls(e){if(void 0===this.subtls)throw Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=await this.subtls.TrustedCert.databaseFromPEM(this.rootCerts),i=new this.subtls.WebSocketReadQueue(this.ws),r=i.read.bind(i),n=this.rawWrite.bind(this),{read:s,write:o}=await this.subtls.startTls(e,t,r,n,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=s,this.tlsWrite=o,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(void 0===e)break;{let t=s.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws&&this.ws.send(e);return}if(void 0===this.writeBuffer)this.writeBuffer=e,setTimeout(()=>{this.ws&&this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",i=e=>{}){return 0===e.length?i():("string"==typeof e&&(e=s.from(e,t)),0===this.tlsState?(this.rawWrite(e),i()):1===this.tlsState?this.once("secureConnection",()=>{this.write(e,t,i)}):(this.tlsWrite(e),i())),!0}end(e=s.alloc(0),t="utf8",i=()=>{}){return this.write(e,t,()=>{this.ws.close(),i()}),this}destroy(){return this.destroyed=!0,this.end()}},d(q,"Socket"),v(q,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:d((e,t,i)=>"https://"+(i?.jwtAuth?e.replace(N,"apiauth."):e.replace(N,"api."))+"/sql","fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:d(e=>e+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1,disableWarningInBrowsers:!1}),v(q,"opts",{}),L=q}),I={};function O(e,t=!1){let{protocol:i}=new URL(e),{username:r,password:n,host:s,hostname:o,port:a,pathname:l,search:u,searchParams:c,hash:h}=new URL("http:"+e.substring(i.length));n=decodeURIComponent(n),r=decodeURIComponent(r),l=decodeURIComponent(l);let f=r+":"+n,d=t?Object.fromEntries(c.entries()):u;return{href:e,protocol:i,auth:f,username:r,password:n,host:s,hostname:o,port:a,pathname:l,search:u,query:d,hash:h}}m(I,{parse:()=>O});var k=p(()=>{P(),d(O,"parse")}),D=g(e=>{P(),e.parse=function(e,t){return new i(e,t).parse()};var t=class e{constructor(e,t){this.source=e,this.transform=t||r,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return"\\"===e?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&("NULL"!==(t=this.recorded.join(""))||e||(t=null),null!==t&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if("["===this.source[0])for(;!this.isEof()&&"="!==this.nextCharacter().value;);}parse(t){var i,r,n;for(this.consumeDimensions();!this.isEof();)if("{"!==(i=this.nextCharacter()).value||n){if("}"!==i.value||n)'"'!==i.value||i.escaped?","!==i.value||n?this.record(i.value):this.newEntry():(n&&this.newEntry(!0),n=!n);else if(this.dimension--,!this.dimension&&(this.newEntry(),t))return this.entries}else this.dimension++,this.dimension>1&&(r=new e(this.source.substr(this.position-1),this.transform),this.entries.push(r.parse(!0)),this.position+=r.position-2);if(0!==this.dimension)throw Error("array dimension not balanced");return this.entries}};d(t,"ArrayParser");var i=t;function r(e){return e}d(r,"identity")}),M=g((e,t)=>{P();var i=D();t.exports={create:d(function(e,t){return{parse:d(function(){return i.parse(e,t)},"parse")}},"create")}}),R=g((e,t)=>{P();var i=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,r=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,n=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,s=/^-?infinity$/;function o(e){var t=r.exec(e);if(t){var i=parseInt(t[1],10);t[4]&&(i=l(i));var n=new Date(i,parseInt(t[2],10)-1,t[3]);return u(i)&&n.setFullYear(i),n}}function a(e){if(e.endsWith("+00"))return 0;var t=n.exec(e.split(" ")[1]);if(t){var i=t[1];return"Z"===i?0:(3600*parseInt(t[2],10)+60*parseInt(t[3]||0,10)+parseInt(t[4]||0,10))*("-"===i?-1:1)*1e3}}function l(e){return-(e-1)}function u(e){return e>=0&&e<100}t.exports=d(function(e){if(s.test(e))return Number(e.replace("i","I"));var t=i.exec(e);if(!t)return o(e)||null;var r=!!t[8],n=parseInt(t[1],10);r&&(n=l(n));var c=parseInt(t[2],10)-1,h=t[3],f=parseInt(t[4],10),d=parseInt(t[5],10),p=parseInt(t[6],10),g=t[7];g=g?1e3*parseFloat(g):0;var m,y=a(e);return null!=y?(m=new Date(Date.UTC(n,c,h,f,d,p,g)),u(n)&&m.setUTCFullYear(n),0!==y&&m.setTime(m.getTime()-y)):(m=new Date(n,c,h,f,d,p,g),u(n)&&m.setFullYear(n)),m},"parseDate"),d(o,"getDate"),d(a,"timeZoneOffset"),d(l,"bcYearToNegativeYear"),d(u,"is0To99")}),Q=g((e,t)=>{P(),t.exports=r;var i=Object.prototype.hasOwnProperty;function r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)i.call(r,n)&&(e[n]=r[n])}return e}d(r,"extend")}),$=g((e,t)=>{P();var i=Q();function r(e){if(!(this instanceof r))return new r(e);i(this,p(e))}t.exports=r,d(r,"PostgresInterval");var n=["seconds","minutes","hours","days","months","years"];r.prototype.toPostgres=function(){var e=n.filter(this.hasOwnProperty,this);return this.milliseconds&&0>e.indexOf("seconds")&&e.push("seconds"),0===e.length?"0":e.map(function(e){var t=this[e]||0;return"seconds"===e&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var s={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},o=["years","months","days"],a=["hours","minutes","seconds"];r.prototype.toISOString=r.prototype.toISO=function(){return"P"+o.map(e,this).join("")+"T"+a.map(e,this).join("");function e(e){var t=this[e]||0;return"seconds"===e&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),t+s[e]}};var l="([+-]?\\d+)",u=new RegExp([l+"\\s+years?",l+"\\s+mons?",l+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map(function(e){return"("+e+")?"}).join("\\s*")),c={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},h=["hours","minutes","seconds","milliseconds"];function f(e){return parseInt(e+"000000".slice(e.length),10)/1e3}function p(e){if(!e)return{};var t=u.exec(e),i="-"===t[8];return Object.keys(c).reduce(function(e,r){var n=t[c[r]];return n&&(n="milliseconds"===r?f(n):parseInt(n,10))&&(i&&~h.indexOf(r)&&(n*=-1),e[r]=n),e},{})}d(f,"parseMilliseconds"),d(p,"parse")}),F=g((e,t)=>{P(),t.exports=d(function(e){if(/^\\x/.test(e))return new s(e.substr(2),"hex");for(var t="",i=0;i<e.length;)if("\\"!==e[i])t+=e[i],++i;else if(/[0-7]{3}/.test(e.substr(i+1,3)))t+=String.fromCharCode(parseInt(e.substr(i+1,3),8)),i+=4;else{for(var r=1;i+r<e.length&&"\\"===e[i+r];)r++;for(var n=0;n<Math.floor(r/2);++n)t+="\\";i+=2*Math.floor(r/2)}return new s(t,"binary")},"parseBytea")}),U=g((e,t)=>{P();var i=D(),r=M(),n=R(),s=$(),o=F();function a(e){return d(function(t){return null===t?t:e(t)},"nullAllowed")}function l(e){return null===e?e:"TRUE"===e||"t"===e||"true"===e||"y"===e||"yes"===e||"on"===e||"1"===e}function u(e){return e?i.parse(e,l):null}function c(e){return parseInt(e,10)}function h(e){return e?i.parse(e,a(c)):null}function f(e){return e?i.parse(e,a(function(e){return S(e).trim()})):null}d(a,"allowNull"),d(l,"parseBool"),d(u,"parseBoolArray"),d(c,"parseBaseTenInt"),d(h,"parseIntegerArray"),d(f,"parseBigIntegerArray");var p=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=C(e)),e}).parse():null},"parsePointArray"),g=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=parseFloat(e)),e}).parse():null},"parseFloatArray"),m=d(function(e){return e?r.create(e).parse():null},"parseStringArray"),y=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=n(e)),e}).parse():null},"parseDateArray"),b=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=s(e)),e}).parse():null},"parseIntervalArray"),w=d(function(e){return e?i.parse(e,a(o)):null},"parseByteAArray"),v=d(function(e){return parseInt(e,10)},"parseInteger"),S=d(function(e){var t=String(e);return/^\d+$/.test(t)?t:e},"parseBigInteger"),x=d(function(e){return e?i.parse(e,a(JSON.parse)):null},"parseJsonArray"),C=d(function(e){return"("!==e[0]?null:{x:parseFloat((e=e.substring(1,e.length-1).split(","))[0]),y:parseFloat(e[1])}},"parsePoint"),T=d(function(e){if("<"!==e[0]&&"("!==e[1])return null;for(var t="(",i="",r=!1,n=2;n<e.length-1;n++){if(r||(t+=e[n]),")"===e[n]){r=!0;continue}r&&","!==e[n]&&(i+=e[n])}var s=C(t);return s.radius=parseFloat(i),s},"parseCircle");t.exports={init:d(function(e){e(20,S),e(21,v),e(23,v),e(26,v),e(700,parseFloat),e(701,parseFloat),e(16,l),e(1082,n),e(1114,n),e(1184,n),e(600,C),e(651,m),e(718,T),e(1e3,u),e(1001,w),e(1005,h),e(1007,h),e(1028,h),e(1016,f),e(1017,p),e(1021,g),e(1022,g),e(1231,g),e(1014,m),e(1015,m),e(1008,m),e(1009,m),e(1040,m),e(1041,m),e(1115,y),e(1182,y),e(1185,y),e(1186,s),e(1187,b),e(17,o),e(114,JSON.parse.bind(JSON)),e(3802,JSON.parse.bind(JSON)),e(199,x),e(3807,x),e(3907,m),e(2951,m),e(791,m),e(1183,m),e(1270,m)},"init")}}),j=g((e,t)=>{function i(e){var t=e.readInt32BE(0),i=e.readUInt32BE(4),r="";t<0&&(t=~t+(0===i),i=~i+1>>>0,r="-");var n,s,o,a,l,u,c="";if(n=t%1e6,t=t/1e6>>>0,i=(s=0x100000000*n+i)/1e6>>>0,o=""+(s-1e6*i),0===i&&0===t)return r+o+c;for(a="",l=6-o.length,u=0;u<l;u++)a+="0";if(c=a+o+c,n=t%1e6,t=t/1e6>>>0,i=(s=0x100000000*n+i)/1e6>>>0,o=""+(s-1e6*i),0===i&&0===t)return r+o+c;for(a="",l=6-o.length,u=0;u<l;u++)a+="0";if(c=a+o+c,n=t%1e6,t=t/1e6>>>0,i=(s=0x100000000*n+i)/1e6>>>0,o=""+(s-1e6*i),0===i&&0===t)return r+o+c;for(a="",l=6-o.length,u=0;u<l;u++)a+="0";return c=a+o+c,r+(o=""+(s=0x100000000*(n=t%1e6)+i)%1e6)+c}P(),d(i,"readInt8"),t.exports=i}),K=g((e,t)=>{P();var i=j(),r=d(function(e,t,i,r,n){i=i||0,r=r||!1,n=n||function(e,t,i){return e*Math.pow(2,i)+t};var s=i>>3,o=d(function(e){return r?255&~e:e},"inv"),a=255,l=8-i%8;t<l&&(a=255<<8-t&255,l=t),i&&(a>>=i%8);var u=0;i%8+t>=8&&(u=n(0,o(e[s])&a,l));for(var c=t+i>>3,h=s+1;h<c;h++)u=n(u,o(e[h]),8);var f=(t+i)%8;return f>0&&(u=n(u,o(e[c])>>8-f,f)),u},"parseBits"),n=d(function(e,t,i){var n=Math.pow(2,i-1)-1,s=r(e,1),o=r(e,i,1);if(0===o)return 0;var a=1,l=r(e,t,i+1,!1,d(function(e,t,i){0===e&&(e=1);for(var r=1;r<=i;r++)a/=2,(t&1<<i-r)>0&&(e+=a);return e},"parsePrecisionBits"));return o==Math.pow(2,i+1)-1?0===l?0===s?1/0:-1/0:NaN:(0===s?1:-1)*Math.pow(2,o-n)*l},"parseFloatFromBits"),s=d(function(e){return 1==r(e,1)?-1*(r(e,15,1,!0)+1):r(e,15,1)},"parseInt16"),o=d(function(e){return 1==r(e,1)?-1*(r(e,31,1,!0)+1):r(e,31,1)},"parseInt32"),a=d(function(e){return n(e,23,8)},"parseFloat32"),l=d(function(e){return n(e,52,11)},"parseFloat64"),u=d(function(e){var t=r(e,16,32);if(49152==t)return NaN;for(var i=Math.pow(1e4,r(e,16,16)),n=0,s=r(e,16),o=0;o<s;o++)n+=r(e,16,64+16*o)*i,i/=1e4;var a=Math.pow(10,r(e,16,48));return(0===t?1:-1)*Math.round(n*a)/a},"parseNumeric"),c=d(function(e,t){var i=r(t,1),n=r(t,63,1),s=new Date((0===i?1:-1)*n/1e3+9466848e5);return e||s.setTime(s.getTime()+6e4*s.getTimezoneOffset()),s.usec=n%1e3,s.getMicroSeconds=function(){return this.usec},s.setMicroSeconds=function(e){this.usec=e},s.getUTCMicroSeconds=function(){return this.usec},s},"parseDate"),h=d(function(e){for(var t=r(e,32),i=(r(e,32,32),r(e,32,64)),n=96,s=[],o=0;o<t;o++)s[o]=r(e,32,n),n+=64;var a=d(function(t){var i,s=r(e,32,n);return(n+=32,0xffffffff==s)?null:23==t||20==t?(i=r(e,8*s,n),n+=8*s,i):25==t?e.toString(this.encoding,n>>3,(n+=s<<3)>>3):void console.log("ERROR: ElementType not implemented: "+t)},"parseElement"),l=d(function(e,t){var i,r=[];if(e.length>1){var n=e.shift();for(i=0;i<n;i++)r[i]=l(e,t);e.unshift(n)}else for(i=0;i<e[0];i++)r[i]=a(t);return r},"parse");return l(s,i)},"parseArray"),f=d(function(e){return e.toString("utf8")},"parseText"),p=d(function(e){return null===e?null:r(e,8)>0},"parseBool");t.exports={init:d(function(e){e(20,i),e(21,s),e(23,o),e(26,o),e(1700,u),e(700,a),e(701,l),e(16,p),e(1114,c.bind(null,!1)),e(1184,c.bind(null,!0)),e(1e3,h),e(1007,h),e(1016,h),e(1008,h),e(1009,h),e(25,f)},"init")}}),z=g((e,t)=>{P(),t.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),V=g(e=>{P();var t=U(),i=K(),r=M(),n=z();e.getTypeParser=a,e.setTypeParser=l,e.arrayParser=r,e.builtins=n;var s={text:{},binary:{}};function o(e){return String(e)}function a(e,t){return s[t=t||"text"]&&s[t][e]||o}function l(e,t,i){"function"==typeof t&&(i=t,t="text"),s[t][e]=i}d(o,"noParse"),d(a,"getTypeParser"),d(l,"setTypeParser"),t.init(function(e,t){s.text[e]=t}),i.init(function(e,t){s.binary[e]=t})}),W=g((e,t)=>{P();var i=V();function r(e){this._types=e||i,this.text={},this.binary={}}d(r,"TypeOverrides"),r.prototype.getOverrides=function(e){switch(e){case"text":return this.text;case"binary":return this.binary;default:return{}}},r.prototype.setTypeParser=function(e,t,i){"function"==typeof t&&(i=t,t="text"),this.getOverrides(t)[e]=i},r.prototype.getTypeParser=function(e,t){return t=t||"text",this.getOverrides(t)[e]||this._types.getTypeParser(e,t)},t.exports=r});function H(e){let t=0x6a09e667,i=0xbb67ae85,r=0x3c6ef372,n=0xa54ff53a,s=0x510e527f,o=0x9b05688c,a=0x1f83d9ab,l=0x5be0cd19,u=0,c=0,h=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],f=d((e,t)=>e>>>t|e<<32-t,"rrot"),p=new Uint32Array(64),g=new Uint8Array(64),m=d(()=>{for(let e=0,t=0;e<16;e++,t+=4)p[e]=g[t]<<24|g[t+1]<<16|g[t+2]<<8|g[t+3];for(let e=16;e<64;e++){let t=f(p[e-15],7)^f(p[e-15],18)^p[e-15]>>>3,i=f(p[e-2],17)^f(p[e-2],19)^p[e-2]>>>10;p[e]=p[e-16]+t+p[e-7]+i|0}let e=t,u=i,d=r,m=n,y=s,b=o,w=a,v=l;for(let t=0;t<64;t++){let i=v+(f(y,6)^f(y,11)^f(y,25))+(y&b^~y&w)+h[t]+p[t]|0,r=(f(e,2)^f(e,13)^f(e,22))+(e&u^e&d^u&d)|0;v=w,w=b,b=y,y=m+i|0,m=d,d=u,u=e,e=i+r|0}t=t+e|0,i=i+u|0,r=r+d|0,n=n+m|0,s=s+y|0,o=o+b|0,a=a+w|0,l=l+v|0,c=0},"process"),y=d(e=>{"string"==typeof e&&(e=new TextEncoder().encode(e));for(let t=0;t<e.length;t++)g[c++]=e[t],64===c&&m();u+=e.length},"add"),b=d(()=>{if(g[c++]=128,64==c&&m(),c+8>64){for(;c<64;)g[c++]=0;m()}for(;c<58;)g[c++]=0;let e=8*u;g[c++]=e/0x10000000000&255,g[c++]=e/0x100000000&255,g[c++]=e>>>24,g[c++]=e>>>16&255,g[c++]=e>>>8&255,g[c++]=255&e,m();let h=new Uint8Array(32);return h[0]=t>>>24,h[1]=t>>>16&255,h[2]=t>>>8&255,h[3]=255&t,h[4]=i>>>24,h[5]=i>>>16&255,h[6]=i>>>8&255,h[7]=255&i,h[8]=r>>>24,h[9]=r>>>16&255,h[10]=r>>>8&255,h[11]=255&r,h[12]=n>>>24,h[13]=n>>>16&255,h[14]=n>>>8&255,h[15]=255&n,h[16]=s>>>24,h[17]=s>>>16&255,h[18]=s>>>8&255,h[19]=255&s,h[20]=o>>>24,h[21]=o>>>16&255,h[22]=o>>>8&255,h[23]=255&o,h[24]=a>>>24,h[25]=a>>>16&255,h[26]=a>>>8&255,h[27]=255&a,h[28]=l>>>24,h[29]=l>>>16&255,h[30]=l>>>8&255,h[31]=255&l,h},"digest");return void 0===e?{add:y,digest:b}:(y(e),b())}var G,J,Y=p(()=>{P(),d(H,"sha256")}),Z=p(()=>{P(),d(G=class e{constructor(){v(this,"_dataLength",0),v(this,"_bufferLength",0),v(this,"_state",new Int32Array(4)),v(this,"_buffer",new ArrayBuffer(68)),v(this,"_buffer8"),v(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(t){let i=e.hexChars,r=e.hexOut,n,s,o,a;for(a=0;a<4;a+=1)for(s=8*a,n=t[a],o=0;o<8;o+=2)r[s+1+o]=i.charAt(15&n),n>>>=4,r[s+0+o]=i.charAt(15&n),n>>>=4;return r.join("")}static _md5cycle(e,t){let i=e[0],r=e[1],n=e[2],s=e[3];i+=(r&n|~r&s)+t[0]-0x28955b88|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[1]-0x173848aa|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[2]+0x242070db|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[3]-0x3e423112|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[4]-0xa83f051|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[5]+0x4787c62a|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[6]-0x57cfb9ed|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[7]-0x2b96aff|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[8]+0x698098d8|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[9]-0x74bb0851|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[10]-42063|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[11]-0x76a32842|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[12]+0x6b901122|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[13]-0x2678e6d|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[14]-0x5986bc72|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[15]+0x49b40821|0,i+=((r=(r<<22|r>>>10)+n|0)&s|n&~s)+t[1]-0x9e1da9e|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[6]-0x3fbf4cc0|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[11]+0x265e5a51|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[0]-0x16493856|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[5]-0x29d0efa3|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[10]+0x2441453|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[15]-0x275e197f|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[4]-0x182c0438|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[9]+0x21e1cde6|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[14]-0x3cc8f82a|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[3]-0xb2af279|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[8]+0x455a14ed|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[13]-0x561c16fb|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[2]-0x3105c08|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[7]+0x676f02d9|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[12]-0x72d5b376|0,i+=((r=(r<<20|r>>>12)+n|0)^n^s)+t[5]-378558|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[8]-0x788e097f|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[11]+0x6d9d6122|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[14]-0x21ac7f4|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[1]-0x5b4115bc|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[4]+0x4bdecfa9|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[7]-0x944b4a0|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[10]-0x41404390|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[13]+0x289b7ec6|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[0]-0x155ed806|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[3]-0x2b10cf7b|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[6]+0x4881d05|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[9]-0x262b2fc7|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[12]-0x1924661b|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[15]+0x1fa27cf8|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[2]-0x3b53a99b|0,r=(r<<23|r>>>9)+n|0,i+=(n^(r|~s))+t[0]-0xbd6ddbc|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[7]+0x432aff97|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[14]-0x546bdc59|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[5]-0x36c5fc7|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[12]+0x655b59c3|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[3]-0x70f3336e|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[10]-1051523|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[1]-0x7a7ba22f|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[8]+0x6fa87e4f|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[15]-0x1d31920|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[6]-0x5cfebcec|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[13]+0x4e0811a1|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[4]-0x8ac817e|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[11]-0x42c50dcb|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[2]+0x2ad7d2bb|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[9]-0x14792c6f|0,r=(r<<21|r>>>11)+n|0,e[0]=i+e[0]|0,e[1]=r+e[1]|0,e[2]=n+e[2]|0,e[3]=s+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this}appendStr(t){let i=this._buffer8,r=this._buffer32,n=this._bufferLength,s,o;for(o=0;o<t.length;o+=1){if((s=t.charCodeAt(o))<128)i[n++]=s;else if(s<2048)i[n++]=(s>>>6)+192,i[n++]=63&s|128;else if(s<55296||s>56319)i[n++]=(s>>>12)+224,i[n++]=s>>>6&63|128,i[n++]=63&s|128;else{if((s=(s-55296)*1024+(t.charCodeAt(++o)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");i[n++]=(s>>>18)+240,i[n++]=s>>>12&63|128,i[n++]=s>>>6&63|128,i[n++]=63&s|128}n>=64&&(this._dataLength+=64,e._md5cycle(this._state,r),n-=64,r[0]=r[16])}return this._bufferLength=n,this}appendAsciiStr(t){let i=this._buffer8,r=this._buffer32,n=this._bufferLength,s,o=0;for(;;){for(s=Math.min(t.length-o,64-n);s--;)i[n++]=t.charCodeAt(o++);if(n<64)break;this._dataLength+=64,e._md5cycle(this._state,r),n=0}return this._bufferLength=n,this}appendByteArray(t){let i=this._buffer8,r=this._buffer32,n=this._bufferLength,s,o=0;for(;;){for(s=Math.min(t.length-o,64-n);s--;)i[n++]=t[o++];if(n<64)break;this._dataLength+=64,e._md5cycle(this._state,r),n=0}return this._bufferLength=n,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,i=e.state,r=this._state,n;for(this._dataLength=e.length,this._bufferLength=e.buflen,r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],n=0;n<t.length;n+=1)this._buffer8[n]=t.charCodeAt(n)}end(t=!1){let i=this._bufferLength,r=this._buffer8,n=this._buffer32,s=(i>>2)+1;this._dataLength+=i;let o=8*this._dataLength;if(r[i]=128,r[i+1]=r[i+2]=r[i+3]=0,n.set(e.buffer32Identity.subarray(s),s),i>55&&(e._md5cycle(this._state,n),n.set(e.buffer32Identity)),o<=0xffffffff)n[14]=o;else{let e=o.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;let t=parseInt(e[2],16),i=parseInt(e[1],16)||0;n[14]=t,n[15]=i}return e._md5cycle(this._state,n),t?this._state:e._hex(this._state)}},"Md5"),v(G,"stateIdentity",new Int32Array([0x67452301,-0x10325477,-0x67452302,0x10325476])),v(G,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),v(G,"hexChars","0123456789abcdef"),v(G,"hexOut",[]),v(G,"onePassHasher",new G),J=G}),X={};function ee(e){return crypto.getRandomValues(s.alloc(e))}function et(e){if("sha256"===e)return{update:d(function(e){return{digest:d(function(){return s.from(H(e))},"digest")}},"update")};if("md5"===e)return{update:d(function(e){return{digest:d(function(){return"string"==typeof e?J.hashStr(e):J.hashByteArray(e)},"digest")}},"update")};throw Error(`Hash type '${e}' not supported`)}function ei(e,t){if("sha256"!==e)throw Error(`\
Only sha256 is supported (requested: '${e}')`);return{update:d(function(e){return{digest:d(function(){"string"==typeof t&&(t=new TextEncoder().encode(t)),"string"==typeof e&&(e=new TextEncoder().encode(e));let i=t.length;if(i>64)t=H(t);else if(i<64){let e=new Uint8Array(64);e.set(t),t=e}let r=new Uint8Array(64),n=new Uint8Array(64);for(let e=0;e<64;e++)r[e]=54^t[e],n[e]=92^t[e];let o=new Uint8Array(e.length+64);o.set(r,0),o.set(e,64);let a=new Uint8Array(96);return a.set(n,0),a.set(H(o),64),s.from(H(a))},"digest")}},"update")}}m(X,{createHash:()=>et,createHmac:()=>ei,randomBytes:()=>ee});var er=p(()=>{P(),Y(),Z(),d(ee,"randomBytes"),d(et,"createHash"),d(ei,"createHmac")}),en=g((e,t)=>{P(),t.exports={host:"localhost",user:"win32"===o.platform?o.env.USERNAME:o.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var i=V(),r=i.getTypeParser(20,"text"),n=i.getTypeParser(1016,"text");t.exports.__defineSetter__("parseInt8",function(e){i.setTypeParser(20,"text",e?i.getTypeParser(23,"text"):r),i.setTypeParser(1016,"text",e?i.getTypeParser(1007,"text"):n)})}),es=g((e,t)=>{P();var i=(er(),w(X)),r=en();function n(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function o(e){for(var t="{",i=0;i<e.length;i++)i>0&&(t+=","),null===e[i]||typeof e[i]>"u"?t+="NULL":Array.isArray(e[i])?t+=o(e[i]):e[i]instanceof s?t+="\\\\x"+e[i].toString("hex"):t+=n(a(e[i]));return t+"}"}d(n,"escapeElement"),d(o,"arrayString");var a=d(function(e,t){if(null==e)return null;if(e instanceof s)return e;if(ArrayBuffer.isView(e)){var i=s.from(e.buffer,e.byteOffset,e.byteLength);return i.length===e.byteLength?i:i.slice(e.byteOffset,e.byteOffset+e.byteLength)}return e instanceof Date?r.parseInputDatesAsUTC?h(e):c(e):Array.isArray(e)?o(e):"object"==typeof e?l(e,t):e.toString()},"prepareValue");function l(e,t){if(e&&"function"==typeof e.toPostgres){if(-1!==(t=t||[]).indexOf(e))throw Error('circular reference detected while preparing "'+e+'" for query');return t.push(e),a(e.toPostgres(a),t)}return JSON.stringify(e)}function u(e,t){for(e=""+e;e.length<t;)e="0"+e;return e}function c(e){var t=-e.getTimezoneOffset(),i=e.getFullYear(),r=i<1;r&&(i=Math.abs(i)+1);var n=u(i,4)+"-"+u(e.getMonth()+1,2)+"-"+u(e.getDate(),2)+"T"+u(e.getHours(),2)+":"+u(e.getMinutes(),2)+":"+u(e.getSeconds(),2)+"."+u(e.getMilliseconds(),3);return t<0?(n+="-",t*=-1):n+="+",n+=u(Math.floor(t/60),2)+":"+u(t%60,2),r&&(n+=" BC"),n}function h(e){var t=e.getUTCFullYear(),i=t<1;i&&(t=Math.abs(t)+1);var r=u(t,4)+"-"+u(e.getUTCMonth()+1,2)+"-"+u(e.getUTCDate(),2)+"T"+u(e.getUTCHours(),2)+":"+u(e.getUTCMinutes(),2)+":"+u(e.getUTCSeconds(),2)+"."+u(e.getUTCMilliseconds(),3);return r+="+00:00",i&&(r+=" BC"),r}function f(e,t,i){return e="string"==typeof e?{text:e}:e,t&&("function"==typeof t?e.callback=t:e.values=t),i&&(e.callback=i),e}d(l,"prepareObject"),d(u,"pad"),d(c,"dateToString"),d(h,"dateToStringUTC"),d(f,"normalizeQueryConfig");var p=d(function(e){return i.createHash("md5").update(e,"utf-8").digest("hex")},"md5"),g=d(function(e,t,i){var r=p(t+e);return"md5"+p(s.concat([s.from(r),i]))},"postgresMd5PasswordHash");t.exports={prepareValue:d(function(e){return a(e)},"prepareValueWrapper"),normalizeQueryConfig:f,postgresMd5PasswordHash:g,md5:p}}),eo={};m(eo,{default:()=>ea});var ea,el=p(()=>{P(),ea={}}),eu=g((e,t)=>{P();var i=(er(),w(X));function r(e){if(-1===e.indexOf("SCRAM-SHA-256"))throw Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let t=i.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:t,response:"n,,n=*,r="+t,message:"SASLInitialResponse"}}function n(e,t,i){if("SASLInitialResponse"!==e.message)throw Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof t)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if("string"!=typeof i)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let r=c(i);if(r.nonce.startsWith(e.clientNonce)){if(r.nonce.length===e.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var n=m(t,s.from(r.salt,"base64"),r.iteration),o=g(n,"Client Key"),a=p(o),l="n=*,r="+e.clientNonce,u="r="+r.nonce+",s="+r.salt+",i="+r.iteration,h="c=biws,r="+r.nonce,d=l+","+u+","+h,y=f(o,g(a,d)).toString("base64"),b=g(n,"Server Key"),w=g(b,d);e.message="SASLResponse",e.serverSignature=w.toString("base64"),e.response=h+",p="+y}function o(e,t){if("SASLResponse"!==e.message)throw Error("SASL: Last message was not SASLResponse");if("string"!=typeof t)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:i}=h(t);if(i!==e.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function a(e){if("string"!=typeof e)throw TypeError("SASL: text must be a string");return e.split("").map((t,i)=>e.charCodeAt(i)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function l(e){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(e)}function u(e){if("string"!=typeof e)throw TypeError("SASL: attribute pairs text must be a string");return new Map(e.split(",").map(e=>{if(!/^.=/.test(e))throw Error("SASL: Invalid attribute pair entry");return[e[0],e.substring(2)]}))}function c(e){let t=u(e),i=t.get("r");if(i){if(!a(i))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let r=t.get("s");if(r){if(!l(r))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let n=t.get("i");if(n){if(!/^[1-9][0-9]*$/.test(n))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");return{nonce:i,salt:r,iteration:parseInt(n,10)}}function h(e){let t=u(e).get("v");if(t){if(!l(t))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}function f(e,t){if(!s.isBuffer(e))throw TypeError("first argument must be a Buffer");if(!s.isBuffer(t))throw TypeError("second argument must be a Buffer");if(e.length!==t.length)throw Error("Buffer lengths must match");if(0===e.length)throw Error("Buffers cannot be empty");return s.from(e.map((i,r)=>e[r]^t[r]))}function p(e){return i.createHash("sha256").update(e).digest()}function g(e,t){return i.createHmac("sha256",e).update(t).digest()}function m(e,t,i){for(var r=g(e,s.concat([t,s.from([0,0,0,1])])),n=r,o=0;o<i-1;o++)n=f(n,r=g(e,r));return n}d(r,"startSession"),d(n,"continueSession"),d(o,"finalizeSession"),d(a,"isPrintableChars"),d(l,"isBase64"),d(u,"parseAttributePairs"),d(c,"parseServerFirstMessage"),d(h,"parseServerFinalMessage"),d(f,"xorBuffers"),d(p,"sha256"),d(g,"hmacSha256"),d(m,"Hi"),t.exports={startSession:r,continueSession:n,finalizeSession:o}}),ec={};function eh(...e){return e.join("/")}m(ec,{join:()=>eh});var ef=p(()=>{P(),d(eh,"join")}),ed={};function ep(e,t){t(Error("No filesystem"))}m(ed,{stat:()=>ep});var eg=p(()=>{P(),d(ep,"stat")}),em={};m(em,{default:()=>ey});var ey,eb=p(()=>{P(),ey={}}),ew={};m(ew,{StringDecoder:()=>eS});var ev,eS,ex=p(()=>{P(),d(ev=class{constructor(e){v(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},"StringDecoder"),eS=ev}),eC=g((e,t)=>{P();var{Transform:i}=(eb(),w(em)),{StringDecoder:r}=(ex(),w(ew)),n=Symbol("last"),s=Symbol("decoder");function o(e,t,i){let r;if(this.overflow){if(1===(r=this[s].write(e).split(this.matcher)).length)return i();r.shift(),this.overflow=!1}else this[n]+=this[s].write(e),r=this[n].split(this.matcher);this[n]=r.pop();for(let e=0;e<r.length;e++)try{l(this,this.mapper(r[e]))}catch(e){return i(e)}(this.overflow=this[n].length>this.maxLength,this.overflow&&!this.skipOverflow)?i(Error("maximum buffer reached")):i()}function a(e){if(this[n]+=this[s].end(),this[n])try{l(this,this.mapper(this[n]))}catch(t){return e(t)}e()}function l(e,t){void 0!==t&&e.push(t)}function u(e){return e}function c(e,t,l){switch(e=e||/\r?\n/,t=t||u,l=l||{},arguments.length){case 1:"function"==typeof e?(t=e,e=/\r?\n/):"object"!=typeof e||e instanceof RegExp||e[Symbol.split]||(l=e,e=/\r?\n/);break;case 2:"function"==typeof e?(l=t,t=e,e=/\r?\n/):"object"==typeof t&&(l=t,t=u)}(l=Object.assign({},l)).autoDestroy=!0,l.transform=o,l.flush=a,l.readableObjectMode=!0;let c=new i(l);return c[n]="",c[s]=new r("utf8"),c.matcher=e,c.mapper=t,c.maxLength=l.maxLength,c.skipOverflow=l.skipOverflow||!1,c.overflow=!1,c._destroy=function(e,t){this._writableState.errorEmitted=!1,t(e)},c}d(o,"transform"),d(a,"flush"),d(l,"push"),d(u,"noop"),d(c,"split"),t.exports=c}),eP=g((e,t)=>{P();var i=(ef(),w(ec)),r=(eb(),w(em)).Stream,n=eC(),s=(el(),w(eo)),a="win32"===o.platform,l=o.stderr;function u(e){return(61440&e)==32768}d(u,"isRegFile");var c=["host","port","database","user","password"],h=c.length,f=c[h-1];function p(){if(l instanceof r&&!0===l.writable){var e=Array.prototype.slice.call(arguments).concat(`
`);l.write(s.format.apply(s,e))}}d(p,"warn"),Object.defineProperty(t.exports,"isWin",{get:d(function(){return a},"get"),set:d(function(e){a=e},"set")}),t.exports.warnTo=function(e){var t=l;return l=e,t},t.exports.getFileName=function(e){var t=e||o.env;return t.PGPASSFILE||(a?i.join(t.APPDATA||"./","postgresql","pgpass.conf"):i.join(t.HOME||"./",".pgpass"))},t.exports.usePgPass=function(e,t){return!Object.prototype.hasOwnProperty.call(o.env,"PGPASSWORD")&&(!!a||(t=t||"<unkn>",u(e.mode)?!(63&e.mode)||(p('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',t),!1):(p('WARNING: password file "%s" is not a plain file',t),!1)))};var g=t.exports.match=function(e,t){return c.slice(0,-1).reduce(function(i,r,n){return 1==n&&Number(e[r]||5432)===Number(t[r])?i&&!0:i&&("*"===t[r]||t[r]===e[r])},!0)};t.exports.getPassword=function(e,t,i){var r,s=t.pipe(n());function o(t){var i=m(t);i&&y(i)&&g(e,i)&&(r=i[f],s.end())}d(o,"onLine");var a=d(function(){t.destroy(),i(r)},"onEnd"),l=d(function(e){t.destroy(),p("WARNING: error on reading file: %s",e),i(void 0)},"onErr");t.on("error",l),s.on("data",o).on("end",a).on("error",l)};var m=t.exports.parseLine=function(e){if(e.length<11||e.match(/^\s+#/))return null;for(var t="",i="",r=0,n=0,s={},a=d(function(t,i,r){var n=e.substring(i,r);Object.hasOwnProperty.call(o.env,"PGPASS_NO_DEESCAPE")||(n=n.replace(/\\([:\\])/g,"$1")),s[c[t]]=n},"addToObj"),l=0;l<e.length-1;l+=1){if(t=e.charAt(l+1),i=e.charAt(l),r==h-1){a(r,n);break}l>=0&&":"==t&&"\\"!==i&&(a(r,n,l+1),n=l+2,r+=1)}return s=Object.keys(s).length===h?s:null},y=t.exports.isValidEntry=function(e){for(var t={0:function(e){return e.length>0},1:function(e){return"*"===e||isFinite(e=Number(e))&&e>0&&e<0x20000000000000&&Math.floor(e)===e},2:function(e){return e.length>0},3:function(e){return e.length>0},4:function(e){return e.length>0}},i=0;i<c.length;i+=1)if(!(0,t[i])(e[c[i]]||""))return!1;return!0}}),eT=g((e,t)=>{P(),ef(),w(ec);var i=(eg(),w(ed)),r=eP();t.exports=function(e,t){var n=r.getFileName();i.stat(n,function(s,o){if(s||!r.usePgPass(o,n))return t(void 0);var a=i.createReadStream(n);r.getPassword(e,a,t)})},t.exports.warnTo=r.warnTo}),eE={};m(eE,{default:()=>e_});var e_,eA=p(()=>{P(),e_={}}),eN=g((e,t)=>{P();var i=(k(),w(I)),r=(eg(),w(ed));function n(e){if("/"===e.charAt(0)){var t=e.split(" ");return{host:t[0],database:t[1]}}var n=i.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)?encodeURI(e).replace(/\%25(\d\d)/g,"%$1"):e,!0),t=n.query;for(var s in t)Array.isArray(t[s])&&(t[s]=t[s][t[s].length-1]);var o=(n.auth||":").split(":");if(t.user=o[0],t.password=o.splice(1).join(":"),t.port=n.port,"socket:"==n.protocol)return t.host=decodeURI(n.pathname),t.database=n.query.db,t.client_encoding=n.query.encoding,t;t.host||(t.host=n.hostname);var a=n.pathname;if(!t.host&&a&&/^%2f/i.test(a)){var l=a.split("/");t.host=decodeURIComponent(l[0]),a=l.splice(1).join("/")}switch(a&&"/"===a.charAt(0)&&(a=a.slice(1)||null),t.database=a&&decodeURI(a),("true"===t.ssl||"1"===t.ssl)&&(t.ssl=!0),"0"===t.ssl&&(t.ssl=!1),(t.sslcert||t.sslkey||t.sslrootcert||t.sslmode)&&(t.ssl={}),t.sslcert&&(t.ssl.cert=r.readFileSync(t.sslcert).toString()),t.sslkey&&(t.ssl.key=r.readFileSync(t.sslkey).toString()),t.sslrootcert&&(t.ssl.ca=r.readFileSync(t.sslrootcert).toString()),t.sslmode){case"disable":t.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":t.ssl.rejectUnauthorized=!1}return t}d(n,"parse"),t.exports=n,n.parse=n}),eq=g((e,t)=>{P();var i=(eA(),w(eE)),r=en(),n=eN().parse,s=d(function(e,t,i){return void 0===i?i=o.env["PG"+e.toUpperCase()]:!1===i||(i=o.env[i]),t[e]||i||r[e]},"val"),a=d(function(){switch(o.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return r.ssl},"readSSLConfigFromEnvironment"),l=d(function(e){return"'"+(""+e).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),u=d(function(e,t,i){var r=t[i];null!=r&&e.push(i+"="+l(r))},"add"),c=class{constructor(e){(e="string"==typeof e?n(e):e||{}).connectionString&&(e=Object.assign({},e,n(e.connectionString))),this.user=s("user",e),this.database=s("database",e),void 0===this.database&&(this.database=this.user),this.port=parseInt(s("port",e),10),this.host=s("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:s("password",e)}),this.binary=s("binary",e),this.options=s("options",e),this.ssl=typeof e.ssl>"u"?a():e.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=s("client_encoding",e),this.replication=s("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=s("application_name",e,"PGAPPNAME"),this.fallback_application_name=s("fallback_application_name",e,!1),this.statement_timeout=s("statement_timeout",e,!1),this.lock_timeout=s("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=s("idle_in_transaction_session_timeout",e,!1),this.query_timeout=s("query_timeout",e,!1),void 0===e.connectionTimeoutMillis?this.connect_timeout=o.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),!1===e.keepAlive?this.keepalives=0:!0===e.keepAlive&&(this.keepalives=1),"number"==typeof e.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var t=[];u(t,this,"user"),u(t,this,"password"),u(t,this,"port"),u(t,this,"application_name"),u(t,this,"fallback_application_name"),u(t,this,"connect_timeout"),u(t,this,"options");var r="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(u(t,r,"sslmode"),u(t,r,"sslca"),u(t,r,"sslkey"),u(t,r,"sslcert"),u(t,r,"sslrootcert"),this.database&&t.push("dbname="+l(this.database)),this.replication&&t.push("replication="+l(this.replication)),this.host&&t.push("host="+l(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+l(this.client_encoding)),i.lookup(this.host,function(i,r){return i?e(i,null):(t.push("hostaddr="+l(r)),e(null,t.join(" ")))})}};d(c,"ConnectionParameters"),t.exports=c}),eL=g((e,t)=>{P();var i=V(),r=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,n=class{constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray="array"===e,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var t;(t=e.text?r.exec(e.text):r.exec(e.command))&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){for(var t=Array(e.length),i=0,r=e.length;i<r;i++){var n=e[i];null!==n?t[i]=this._parsers[i](n):t[i]=null}return t}parseRow(e){for(var t={},i=0,r=e.length;i<r;i++){var n=e[i],s=this.fields[i].name;null!==n?t[s]=this._parsers[i](n):t[s]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=Array(e.length));for(var t=0;t<e.length;t++){var r=e[t];this._types?this._parsers[t]=this._types.getTypeParser(r.dataTypeID,r.format||"text"):this._parsers[t]=i.getTypeParser(r.dataTypeID,r.format||"text")}}};d(n,"Result"),t.exports=n}),eB=g((e,t)=>{P();var{EventEmitter:i}=T(),r=eL(),n=es(),s=class extends i{constructor(e,t,i){super(),e=n.normalizeQueryConfig(e,t,i),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,o.domain&&e.callback&&(this.callback=o.domain.bind(e.callback)),this._result=new r(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return!!this.name||!!this.rows||!!this.text&&!!this.values&&this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new r(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(e){this._canceledDueToError=e;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(e){o.nextTick(()=>{throw e})}this.emit("end",this._results)}submit(e){if("string"!=typeof this.text&&"string"!=typeof this.name)return Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];return this.text&&t&&this.text!==t?Error(`Prepared statements must be unique - '${this.name}\
' was used for a different statement`):this.values&&!Array.isArray(this.values)?Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:n.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};d(s,"Query"),t.exports=s}),eI=g(e=>{P(),Object.defineProperty(e,"__esModule",{value:!0}),e.NoticeMessage=e.DataRowMessage=e.CommandCompleteMessage=e.ReadyForQueryMessage=e.NotificationResponseMessage=e.BackendKeyDataMessage=e.AuthenticationMD5Password=e.ParameterStatusMessage=e.ParameterDescriptionMessage=e.RowDescriptionMessage=e.Field=e.CopyResponse=e.CopyDataMessage=e.DatabaseError=e.copyDone=e.emptyQuery=e.replicationStart=e.portalSuspended=e.noData=e.closeComplete=e.bindComplete=e.parseComplete=void 0,e.parseComplete={name:"parseComplete",length:5},e.bindComplete={name:"bindComplete",length:5},e.closeComplete={name:"closeComplete",length:5},e.noData={name:"noData",length:5},e.portalSuspended={name:"portalSuspended",length:5},e.replicationStart={name:"replicationStart",length:4},e.emptyQuery={name:"emptyQuery",length:4},e.copyDone={name:"copyDone",length:4};var t=class extends Error{constructor(e,t,i){super(e),this.length=t,this.name=i}};d(t,"DatabaseError"),e.DatabaseError=t;var i=class{constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};d(i,"CopyDataMessage"),e.CopyDataMessage=i;var r=class{constructor(e,t,i,r){this.length=e,this.name=t,this.binary=i,this.columnTypes=Array(r)}};d(r,"CopyResponse"),e.CopyResponse=r;var n=class{constructor(e,t,i,r,n,s,o){this.name=e,this.tableID=t,this.columnID=i,this.dataTypeID=r,this.dataTypeSize=n,this.dataTypeModifier=s,this.format=o}};d(n,"Field"),e.Field=n;var s=class{constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=Array(this.fieldCount)}};d(s,"RowDescriptionMessage"),e.RowDescriptionMessage=s;var o=class{constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}};d(o,"ParameterDescriptionMessage"),e.ParameterDescriptionMessage=o;var a=class{constructor(e,t,i){this.length=e,this.parameterName=t,this.parameterValue=i,this.name="parameterStatus"}};d(a,"ParameterStatusMessage"),e.ParameterStatusMessage=a;var l=class{constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};d(l,"AuthenticationMD5Password"),e.AuthenticationMD5Password=l;var u=class{constructor(e,t,i){this.length=e,this.processID=t,this.secretKey=i,this.name="backendKeyData"}};d(u,"BackendKeyDataMessage"),e.BackendKeyDataMessage=u;var c=class{constructor(e,t,i,r){this.length=e,this.processId=t,this.channel=i,this.payload=r,this.name="notification"}};d(c,"NotificationResponseMessage"),e.NotificationResponseMessage=c;var h=class{constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};d(h,"ReadyForQueryMessage"),e.ReadyForQueryMessage=h;var f=class{constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};d(f,"CommandCompleteMessage"),e.CommandCompleteMessage=f;var p=class{constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};d(p,"DataRowMessage"),e.DataRowMessage=p;var g=class{constructor(e,t){this.length=e,this.message=t,this.name="notice"}};d(g,"NoticeMessage"),e.NoticeMessage=g}),eO=g(e=>{P(),Object.defineProperty(e,"__esModule",{value:!0}),e.Writer=void 0;var t=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=s.allocUnsafe(e)}ensure(e){if(this.buffer.length-this.offset<e){let t=this.buffer,i=t.length+(t.length>>1)+e;this.buffer=s.allocUnsafe(i),t.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(e){let t=s.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}else this.ensure(1);return this.buffer[this.offset++]=0,this}addString(e=""){let t=s.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(5*!e,this.offset)}flush(e){let t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=s.allocUnsafe(this.size),t}};d(t,"Writer"),e.Writer=t}),ek=g(e=>{P(),Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=void 0;var t=eO(),i=new t.Writer,r=d(e=>{for(let t of(i.addInt16(3).addInt16(0),Object.keys(e)))i.addCString(t).addCString(e[t]);i.addCString("client_encoding").addCString("UTF8");let r=i.addCString("").flush(),n=r.length+4;return new t.Writer().addInt32(n).add(r).flush()},"startup"),n=d(()=>{let e=s.allocUnsafe(8);return e.writeInt32BE(8,0),e.writeInt32BE(0x4d2162f,4),e},"requestSsl"),o=d(e=>i.addCString(e).flush(112),"password"),a=d(function(e,t){return i.addCString(e).addInt32(s.byteLength(t)).addString(t),i.flush(112)},"sendSASLInitialResponseMessage"),l=d(function(e){return i.addString(e).flush(112)},"sendSCRAMClientFinalMessage"),u=d(e=>i.addCString(e).flush(81),"query"),c=[],h=d(e=>{let t=e.name||"";t.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",t,t.length),console.error("This can cause conflicts and silent errors executing queries"));let r=e.types||c,n=r.length,s=i.addCString(t).addCString(e.text).addInt16(n);for(let e=0;e<n;e++)s.addInt32(r[e]);return i.flush(80)},"parse"),f=new t.Writer,p=d(function(e,t){for(let r=0;r<e.length;r++){let n=t?t(e[r],r):e[r];null==n?(i.addInt16(0),f.addInt32(-1)):n instanceof s?(i.addInt16(1),f.addInt32(n.length),f.add(n)):(i.addInt16(0),f.addInt32(s.byteLength(n)),f.addString(n))}},"writeValues"),g=d((e={})=>{let t=e.portal||"",r=e.statement||"",n=e.binary||!1,s=e.values||c,o=s.length;return i.addCString(t).addCString(r),i.addInt16(o),p(s,e.valueMapper),i.addInt16(o),i.add(f.flush()),i.addInt16(+!!n),i.flush(66)},"bind"),m=s.from([69,0,0,0,9,0,0,0,0,0]),y=d(e=>{if(!e||!e.portal&&!e.rows)return m;let t=e.portal||"",i=e.rows||0,r=s.byteLength(t),n=4+r+1+4,o=s.allocUnsafe(1+n);return o[0]=69,o.writeInt32BE(n,1),o.write(t,5,"utf-8"),o[r+5]=0,o.writeUInt32BE(i,o.length-4),o},"execute"),b=d((e,t)=>{let i=s.allocUnsafe(16);return i.writeInt32BE(16,0),i.writeInt16BE(1234,4),i.writeInt16BE(5678,6),i.writeInt32BE(e,8),i.writeInt32BE(t,12),i},"cancel"),w=d((e,t)=>{let i=4+s.byteLength(t)+1,r=s.allocUnsafe(1+i);return r[0]=e,r.writeInt32BE(i,1),r.write(t,5,"utf-8"),r[i]=0,r},"cstringMessage"),v=i.addCString("P").flush(68),S=i.addCString("S").flush(68),x=d(e=>e.name?w(68,`${e.type}${e.name||""}`):"P"===e.type?v:S,"describe"),C=d(e=>w(67,`${e.type}${e.name||""}`),"close"),T=d(e=>i.add(e).flush(100),"copyData"),E=d(e=>w(102,e),"copyFail"),_=d(e=>s.from([e,0,0,0,4]),"codeOnlyBuffer"),A=_(72),N=_(83),q=_(88),L=_(99);e.serialize={startup:r,password:o,requestSsl:n,sendSASLInitialResponseMessage:a,sendSCRAMClientFinalMessage:l,query:u,parse:h,bind:g,execute:y,describe:x,close:C,flush:d(()=>A,"flush"),sync:d(()=>N,"sync"),end:d(()=>q,"end"),copyData:T,copyDone:d(()=>L,"copyDone"),copyFail:E,cancel:b}}),eD=g(e=>{P(),Object.defineProperty(e,"__esModule",{value:!0}),e.BufferReader=void 0;var t=s.allocUnsafe(0),i=class{constructor(e=0){this.offset=e,this.buffer=t,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}uint32(){let e=this.buffer.readUInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;0!==this.buffer[t++];);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};d(i,"BufferReader"),e.BufferReader=i}),eM=g(e=>{P(),Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var t=eI(),i=eD(),r=s.allocUnsafe(0),n=class{constructor(e){if(this.buffer=r,this.bufferLength=0,this.bufferOffset=0,this.reader=new i.BufferReader,e?.mode==="binary")throw Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let i=this.bufferOffset+this.bufferLength,n=this.bufferOffset;for(;n+5<=i;){let e=this.buffer[n],r=this.buffer.readUInt32BE(n+1),s=1+r;if(s+n<=i)t(this.handlePacket(n+5,e,r,this.buffer)),n+=s;else break}n===i?(this.buffer=r,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=i-n,this.bufferOffset=n)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let e;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)e=this.buffer;else{let i=2*this.buffer.byteLength;for(;t>=i;)i*=2;e=s.allocUnsafe(i)}this.buffer.copy(e,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=e,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,i,r,n){switch(i){case 50:return t.bindComplete;case 49:return t.parseComplete;case 51:return t.closeComplete;case 110:return t.noData;case 115:return t.portalSuspended;case 99:return t.copyDone;case 87:return t.replicationStart;case 73:return t.emptyQuery;case 68:return this.parseDataRowMessage(e,r,n);case 67:return this.parseCommandCompleteMessage(e,r,n);case 90:return this.parseReadyForQueryMessage(e,r,n);case 65:return this.parseNotificationMessage(e,r,n);case 82:return this.parseAuthenticationResponse(e,r,n);case 83:return this.parseParameterStatusMessage(e,r,n);case 75:return this.parseBackendKeyData(e,r,n);case 69:return this.parseErrorMessage(e,r,n,"error");case 78:return this.parseErrorMessage(e,r,n,"notice");case 84:return this.parseRowDescriptionMessage(e,r,n);case 116:return this.parseParameterDescriptionMessage(e,r,n);case 71:return this.parseCopyInMessage(e,r,n);case 72:return this.parseCopyOutMessage(e,r,n);case 100:return this.parseCopyData(e,r,n);default:return new t.DatabaseError("received invalid response: "+i.toString(16),r,"error")}}parseReadyForQueryMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.string(1);return new t.ReadyForQueryMessage(i,n)}parseCommandCompleteMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.cstring();return new t.CommandCompleteMessage(i,n)}parseCopyData(e,i,r){let n=r.slice(e,e+(i-4));return new t.CopyDataMessage(i,n)}parseCopyInMessage(e,t,i){return this.parseCopyMessage(e,t,i,"copyInResponse")}parseCopyOutMessage(e,t,i){return this.parseCopyMessage(e,t,i,"copyOutResponse")}parseCopyMessage(e,i,r,n){this.reader.setBuffer(e,r);let s=0!==this.reader.byte(),o=this.reader.int16(),a=new t.CopyResponse(i,n,s,o);for(let e=0;e<o;e++)a.columnTypes[e]=this.reader.int16();return a}parseNotificationMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int32(),s=this.reader.cstring(),o=this.reader.cstring();return new t.NotificationResponseMessage(i,n,s,o)}parseRowDescriptionMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int16(),s=new t.RowDescriptionMessage(i,n);for(let e=0;e<n;e++)s.fields[e]=this.parseField();return s}parseField(){let e=this.reader.cstring(),i=this.reader.uint32(),r=this.reader.int16(),n=this.reader.uint32(),s=this.reader.int16(),o=this.reader.int32(),a=0===this.reader.int16()?"text":"binary";return new t.Field(e,i,r,n,s,o,a)}parseParameterDescriptionMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int16(),s=new t.ParameterDescriptionMessage(i,n);for(let e=0;e<n;e++)s.dataTypeIDs[e]=this.reader.int32();return s}parseDataRowMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int16(),s=Array(n);for(let e=0;e<n;e++){let t=this.reader.int32();s[e]=-1===t?null:this.reader.string(t)}return new t.DataRowMessage(i,s)}parseParameterStatusMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.cstring(),s=this.reader.cstring();return new t.ParameterStatusMessage(i,n,s)}parseBackendKeyData(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int32(),s=this.reader.int32();return new t.BackendKeyDataMessage(i,n,s)}parseAuthenticationResponse(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int32(),s={name:"authenticationOk",length:i};switch(n){case 0:break;case 3:8===s.length&&(s.name="authenticationCleartextPassword");break;case 5:if(12===s.length){s.name="authenticationMD5Password";let e=this.reader.bytes(4);return new t.AuthenticationMD5Password(i,e)}break;case 10:{let e;s.name="authenticationSASL",s.mechanisms=[];do(e=this.reader.cstring())&&s.mechanisms.push(e);while(e)}break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(i-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(i-8);break;default:throw Error("Unknown authenticationOk message type "+n)}return s}parseErrorMessage(e,i,r,n){this.reader.setBuffer(e,r);let s={},o=this.reader.string(1);for(;"\0"!==o;)s[o]=this.reader.cstring(),o=this.reader.string(1);let a=s.M,l="notice"===n?new t.NoticeMessage(i,a):new t.DatabaseError(a,i,n);return l.severity=s.S,l.code=s.C,l.detail=s.D,l.hint=s.H,l.position=s.P,l.internalPosition=s.p,l.internalQuery=s.q,l.where=s.W,l.schema=s.s,l.table=s.t,l.column=s.c,l.dataType=s.d,l.constraint=s.n,l.file=s.F,l.line=s.L,l.routine=s.R,l}};d(n,"Parser"),e.Parser=n}),eR=g(e=>{P(),Object.defineProperty(e,"__esModule",{value:!0}),e.DatabaseError=e.serialize=e.parse=void 0;var t=eI();Object.defineProperty(e,"DatabaseError",{enumerable:!0,get:d(function(){return t.DatabaseError},"get")});var i=ek();Object.defineProperty(e,"serialize",{enumerable:!0,get:d(function(){return i.serialize},"get")});var r=eM();function n(e,t){let i=new r.Parser;return e.on("data",e=>i.parse(e,t)),new Promise(t=>e.on("end",()=>t()))}d(n,"parse"),e.parse=n}),eQ={};function e$({socket:e,servername:t}){return e.startTls(t),e}m(eQ,{connect:()=>e$});var eF=p(()=>{P(),d(e$,"connect")}),eU=g((e,t)=>{P();var i=(B(),w(E)),r=T().EventEmitter,{parse:n,serialize:s}=eR(),o=s.flush(),a=s.sync(),l=s.end(),u=class extends r{constructor(e){super(),e=e||{},this.stream=e.stream||new i.Socket,this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var t=this;this.on("newListener",function(e){"message"===e&&(t._emitMessage=!0)})}connect(e,t){var r=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){r._keepAlive&&r.stream.setKeepAlive(!0,r._keepAliveInitialDelayMillis),r.emit("connect")});let n=d(function(e){r._ending&&("ECONNRESET"===e.code||"EPIPE"===e.code)||r.emit("error",e)},"reportStreamError");if(this.stream.on("error",n),this.stream.on("close",function(){r.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(e){switch(e.toString("utf8")){case"S":break;case"N":return r.stream.end(),r.emit("error",Error("The server does not support SSL connections"));default:return r.stream.end(),r.emit("error",Error("There was an error establishing an SSL connection"))}var s=(eF(),w(eQ));let o={socket:r.stream};!0!==r.ssl&&(Object.assign(o,r.ssl),"key"in r.ssl&&(o.key=r.ssl.key)),0===i.isIP(t)&&(o.servername=t);try{r.stream=s.connect(o)}catch(e){return r.emit("error",e)}r.attachListeners(r.stream),r.stream.on("error",n),r.emit("sslconnect")})}attachListeners(e){e.on("end",()=>{this.emit("end")}),n(e,e=>{var t="error"===e.name?"errorMessage":e.name;this._emitMessage&&this.emit("message",e),this.emit(t,e)})}requestSsl(){this.stream.write(s.requestSsl())}startup(e){this.stream.write(s.startup(e))}cancel(e,t){this._send(s.cancel(e,t))}password(e){this._send(s.password(e))}sendSASLInitialResponseMessage(e,t){this._send(s.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(s.sendSCRAMClientFinalMessage(e))}_send(e){return!!this.stream.writable&&this.stream.write(e)}query(e){this._send(s.query(e))}parse(e){this._send(s.parse(e))}bind(e){this._send(s.bind(e))}execute(e){this._send(s.execute(e))}flush(){this.stream.writable&&this.stream.write(o)}sync(){this._ending=!0,this._send(o),this._send(a)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){return(this._ending=!0,this._connecting&&this.stream.writable)?this.stream.write(l,()=>{this.stream.end()}):void this.stream.end()}close(e){this._send(s.close(e))}describe(e){this._send(s.describe(e))}sendCopyFromChunk(e){this._send(s.copyData(e))}endCopyFrom(){this._send(s.copyDone())}sendCopyFail(e){this._send(s.copyFail(e))}};d(u,"Connection"),t.exports=u}),ej=g((e,t)=>{P();var i=T().EventEmitter,n=(el(),w(eo),es()),s=eu(),a=eT(),l=W(),u=eq(),c=eB(),h=en(),f=eU(),p=class extends i{constructor(e){super(),this.connectionParameters=new u(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var t=e||{};this._Promise=t.Promise||r.Promise,this._types=new l(t.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=t.connection||new f({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||h.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=d(t=>{o.nextTick(()=>{t.handleError(e,this.connection)})},"enqueueError");this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){var t=this,i=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let t=Error("Client has already been connected. You cannot reuse a client.");o.nextTick(()=>{e(t)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{i._ending=!0,i.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?i.connect(this.host+"/.s.PGSQL."+this.port):i.connect(this.port,this.host),i.on("connect",function(){t.ssl?i.requestSsl():i.startup(t.getStartupConf())}),i.on("sslconnect",function(){i.startup(t.getStartupConf())}),this._attachListeners(i),i.once("end",()=>{let e=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(e),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(e):this._handleErrorEvent(e):this._connectionError||this._handleErrorEvent(e)),o.nextTick(()=>{this.emit("end")})})}connect(e){return e?void this._connect(e):new this._Promise((e,t)=>{this._connect(i=>{i?t(i):e()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;"function"==typeof this.password?this._Promise.resolve().then(()=>this.password()).then(i=>{if(void 0!==i){if("string"!=typeof i)return void t.emit("error",TypeError("Password must be a string"));this.connectionParameters.password=this.password=i}else this.connectionParameters.password=this.password=null;e()}).catch(e=>{t.emit("error",e)}):null!==this.password?e():a(this.connectionParameters,t=>{void 0!==t&&(this.connectionParameters.password=this.password=t),e()})}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(()=>{let t=n.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)})}_handleAuthSASL(e){this._checkPgPass(()=>{this.saslSession=s.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(e){s.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(e){s.finalizeSession(this.saslSession,e.data),this.saslSession=null}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;t?(this.activeQuery=null,t.handleError(e,this.connection)):this._handleErrorEvent(e)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,t={user:e.user,database:e.database},i=e.application_name||e.fallback_application_name;return i&&(t.application_name=i),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){var i=this.connection;this.host&&0===this.host.indexOf("/")?i.connect(this.host+"/.s.PGSQL."+this.port):i.connect(this.port,this.host),i.on("connect",function(){i.cancel(e.processID,e.secretKey)})}else -1!==e.queryQueue.indexOf(t)&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,i){return this._types.setTypeParser(e,t,i)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return'"'+e.replace(/"/g,'""')+'"'}escapeLiteral(e){for(var t=!1,i="'",r=0;r<e.length;r++){var n=e[r];"'"===n?i+=n+n:"\\"===n?(i+=n+n,t=!0):i+=n}return i+="'",!0===t&&(i=" E"+i),i}_pulseQueryQueue(){if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&o.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,i){var r,n,s,a,l;if(null==e)throw TypeError("Client was passed a null or undefined query");return"function"==typeof e.submit?(s=e.query_timeout||this.connectionParameters.query_timeout,n=r=e,"function"==typeof t&&(r.callback=r.callback||t)):(s=this.connectionParameters.query_timeout,(r=new c(e,t,i)).callback||(n=new this._Promise((e,t)=>{r.callback=(i,r)=>i?t(i):e(r)}))),s&&(l=r.callback,a=setTimeout(()=>{var e=Error("Query read timeout");o.nextTick(()=>{r.handleError(e,this.connection)}),l(e),r.callback=()=>{};var t=this.queryQueue.indexOf(r);t>-1&&this.queryQueue.splice(t,1),this._pulseQueryQueue()},s),r.callback=(e,t)=>{clearTimeout(a),l(e,t)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?o.nextTick(()=>{r.handleError(Error("Client was closed and is not queryable"),this.connection)}):(this.queryQueue.push(r),this._pulseQueryQueue()):o.nextTick(()=>{r.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),n}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting)if(!e)return this._Promise.resolve();else e();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!e)return new this._Promise(e=>{this.connection.once("end",e)});this.connection.once("end",e)}};d(p,"Client"),p.Query=c,t.exports=p}),eK=g((e,t)=>{P();var i=T().EventEmitter,s=d(function(){},"NOOP"),a=d((e,t)=>{let i=e.findIndex(t);return -1===i?void 0:e.splice(i,1)[0]},"removeWhere"),l=class{constructor(e,t,i){this.client=e,this.idleListener=t,this.timeoutId=i}};d(l,"IdleItem");var u=class{constructor(e){this.callback=e}};function c(){throw Error("Release called on client which has already been released to the pool.")}function h(e,t){let i,r;return t?{callback:t,result:void 0}:{callback:d(function(e,t){e?i(e):r(t)},"cb"),result:new e(function(e,t){r=e,i=t}).catch(e=>{throw Error.captureStackTrace(e),e})}}function f(e,t){return d(function i(r){r.client=t,t.removeListener("error",i),t.on("error",()=>{e.log("additional client error after disconnection due to error",r)}),e._remove(t),e.emit("error",r,t)},"idleListener")}d(u,"PendingItem"),d(c,"throwOnDoubleRelease"),d(h,"promisify"),d(f,"makeIdleListener");var p=class extends i{constructor(e,t){super(),this.options=Object.assign({},e),null!=e&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),null!=e&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||eZ().Client,this.Promise=this.options.Promise||r.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended)return void this.log("pulse queue ended");if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(e=>{this._remove(e.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length)return void this.log("no queued requests");if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let i=t.client;i.ref&&i.ref();let r=t.idleListener;return this._acquireClient(i,e,r,!1)}if(!this._isFull())return this.newClient(e);throw Error("unexpected condition")}_remove(e){let t=a(this._idle,t=>t.client===e);void 0!==t&&clearTimeout(t.timeoutId),this._clients=this._clients.filter(t=>t!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let t=Error("Cannot use a pool after calling end on the pool");return e?e(t):this.Promise.reject(t)}let t=h(this.Promise,e),i=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&o.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new u(t.callback)),i;let e=d((e,i,r)=>{clearTimeout(n),t.callback(e,i,r)},"queueCallback"),r=new u(e),n=setTimeout(()=>{a(this._pendingQueue,t=>t.callback===e),r.timedOut=!0,t.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return n.unref&&n.unref(),this._pendingQueue.push(r),i}return this.newClient(new u(t.callback)),i}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let i=f(this,t);this.log("checking client timeout");let r,n=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),n=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(o=>{if(r&&clearTimeout(r),t.on("error",i),o)this.log("client failed to connect",o),this._clients=this._clients.filter(e=>e!==t),n&&(o=Error("Connection terminated due to connection timeout",{cause:o})),this._pulseQueue(),e.timedOut||e.callback(o,void 0,s);else{if(this.log("new client connected"),0!==this.options.maxLifetimeSeconds){let e=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),-1!==this._idle.findIndex(e=>e.client===t)&&this._acquireClient(t,new u((e,t,i)=>i()),i,!1)},1e3*this.options.maxLifetimeSeconds);e.unref(),t.once("end",()=>clearTimeout(e))}return this._acquireClient(t,e,i,!0)}})}_acquireClient(e,t,i,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,i),e.removeListener("error",i),t.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),t.callback(i,void 0,s);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let i=!1;return r=>{i&&c(),i=!0,this._release(e,t,r)}}_release(e,t,i){let r;if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",i,e),i||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}this.options.idleTimeoutMillis&&this._isAboveMin()&&(r=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&r.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new l(e,t,r)),this._pulseQueue()}query(e,t,i){if("function"==typeof e){let t=h(this.Promise,e);return n(function(){return t.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),t.result}"function"==typeof t&&(i=t,t=void 0);let r=h(this.Promise,i);return i=r.callback,this.connect((r,n)=>{if(r)return i(r);let s=!1,o=d(e=>{s||(s=!0,n.release(e),i(e))},"onError");n.once("error",o),this.log("dispatching query");try{n.query(e,t,(e,t)=>{if(this.log("query dispatched"),n.removeListener("error",o),!s)return s=!0,n.release(e),e?i(e):i(void 0,t)})}catch(e){return n.release(e),i(e)}}),r.result}end(e){if(this.log("ending"),this.ending){let t=Error("Called end on pool more than once");return e?e(t):this.Promise.reject(t)}this.ending=!0;let t=h(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+ +!!this._expired.has(t),0)}get totalCount(){return this._clients.length}};d(p,"Pool"),t.exports=p}),ez={};m(ez,{default:()=>eV});var eV,eW=p(()=>{P(),eV={}}),eH=g((e,t)=>{t.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),eG=g((e,t)=>{P();var i=T().EventEmitter,r=(el(),w(eo)),s=es(),a=t.exports=function(e,t,r){i.call(this),e=s.normalizeQueryConfig(e,t,r),this.text=e.text,this.values=e.values,this.name=e.name,this.callback=e.callback,this.state="new",this._arrayMode="array"===e.rowMode,this._emitRowEvents=!1,this.on("newListener",(function(e){"row"===e&&(this._emitRowEvents=!0)}).bind(this))};r.inherits(a,i);var l={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};a.prototype.handleError=function(e){var t=this.native.pq.resultErrorFields();if(t)for(var i in t)e[l[i]||i]=t[i];this.callback?this.callback(e):this.emit("error",e),this.state="error"},a.prototype.then=function(e,t){return this._getPromise().then(e,t)},a.prototype.catch=function(e){return this._getPromise().catch(e)},a.prototype._getPromise=function(){return this._promise||(this._promise=new Promise((function(e,t){this._once("end",e),this._once("error",t)}).bind(this))),this._promise},a.prototype.submit=function(e){this.state="running";var t=this;this.native=e.native,e.native.arrayMode=this._arrayMode;var i=d(function(i,r,s){if(e.native.arrayMode=!1,n(function(){t.emit("_done")}),i)return t.handleError(i);t._emitRowEvents&&(s.length>1?r.forEach((e,i)=>{e.forEach(e=>{t.emit("row",e,s[i])})}):r.forEach(function(e){t.emit("row",e,s)})),t.state="end",t.emit("end",s),t.callback&&t.callback(null,s)},"after");if(o.domain&&(i=o.domain.bind(i)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var r=(this.values||[]).map(s.prepareValue);if(e.namedQueries[this.name]){if(this.text&&e.namedQueries[this.name]!==this.text){let e=Error(`Prepa\
red statements must be unique - '${this.name}' was used for a different statement`);return i(e)}return e.native.execute(this.name,r,i)}return e.native.prepare(this.name,this.text,r.length,function(n){return n?i(n):(e.namedQueries[t.name]=t.text,t.native.execute(t.name,r,i))})}if(this.values){if(!Array.isArray(this.values)){let e=Error("Query values must be an array");return i(e)}var a=this.values.map(s.prepareValue);e.native.query(this.text,a,i)}else e.native.query(this.text,i)}}),eJ=g((e,t)=>{P();var i=(eW(),w(ez)),n=W(),s=(eH(),T().EventEmitter),a=(el(),w(eo)),l=eq(),u=eG(),c=t.exports=function(e){s.call(this),e=e||{},this._Promise=e.Promise||r.Promise,this._types=new n(e.types),this.native=new i({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var t=this.connectionParameters=new l(e);this.user=t.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:t.password}),this.database=t.database,this.host=t.host,this.port=t.port,this.namedQueries={}};c.Query=u,a.inherits(c,s),c.prototype._errorAllQueries=function(e){let t=d(t=>{o.nextTick(()=>{t.native=this.native,t.handleError(e)})},"enqueueError");this._hasActiveQuery()&&(t(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(t),this._queryQueue.length=0},c.prototype._connect=function(e){var t=this;this._connecting?o.nextTick(()=>e(Error("Client has already been connected. You cannot reuse a client."))):(this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(i,r){if(i)return e(i);t.native.connect(r,function(i){if(i)return t.native.end(),e(i);t._connected=!0,t.native.on("error",function(e){t._queryable=!1,t._errorAllQueries(e),t.emit("error",e)}),t.native.on("notification",function(e){t.emit("notification",{channel:e.relname,payload:e.extra})}),t.emit("connect"),t._pulseQueryQueue(!0),e()})}))},c.prototype.connect=function(e){return e?void this._connect(e):new this._Promise((e,t)=>{this._connect(i=>{i?t(i):e()})})},c.prototype.query=function(e,t,i){var r,n,s,a,l;if(null==e)throw TypeError("Client was passed a null or undefined query");if("function"==typeof e.submit)s=e.query_timeout||this.connectionParameters.query_timeout,n=r=e,"function"==typeof t&&(e.callback=t);else if(s=this.connectionParameters.query_timeout,!(r=new u(e,t,i)).callback){let e,t;n=new this._Promise((i,r)=>{e=i,t=r}),r.callback=(i,r)=>i?t(i):e(r)}return s&&(l=r.callback,a=setTimeout(()=>{var e=Error("Query read timeout");o.nextTick(()=>{r.handleError(e,this.connection)}),l(e),r.callback=()=>{};var t=this._queryQueue.indexOf(r);t>-1&&this._queryQueue.splice(t,1),this._pulseQueryQueue()},s),r.callback=(e,t)=>{clearTimeout(a),l(e,t)}),this._queryable?this._ending?(r.native=this.native,o.nextTick(()=>{r.handleError(Error("Client was closed and is not queryable"))})):(this._queryQueue.push(r),this._pulseQueryQueue()):(r.native=this.native,o.nextTick(()=>{r.handleError(Error("Client has encountered a connection error and is not queryable"))})),n},c.prototype.end=function(e){var t,i=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,e)),e||(t=new this._Promise(function(t,i){e=d(e=>e?i(e):t(),"cb")})),this.native.end(function(){i._errorAllQueries(Error("Connection terminated")),o.nextTick(()=>{i.emit("end"),e&&e()})}),t},c.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},c.prototype._pulseQueryQueue=function(e){if(this._connected&&!this._hasActiveQuery()){var t=this._queryQueue.shift();if(!t){e||this.emit("drain");return}this._activeQuery=t,t.submit(this);var i=this;t.once("_done",function(){i._pulseQueryQueue()})}},c.prototype.cancel=function(e){this._activeQuery===e?this.native.cancel(function(){}):-1!==this._queryQueue.indexOf(e)&&this._queryQueue.splice(this._queryQueue.indexOf(e),1)},c.prototype.ref=function(){},c.prototype.unref=function(){},c.prototype.setTypeParser=function(e,t,i){return this._types.setTypeParser(e,t,i)},c.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)}}),eY=g((e,t)=>{P(),t.exports=eJ()}),eZ=g((e,t)=>{P();var i=ej(),r=en(),n=eU(),s=eK(),{DatabaseError:a}=eR(),l=d(e=>{var t;return d(t=class extends s{constructor(t){super(t,e)}},"BoundPool"),t},"poolFactory"),u=d(function(e){this.defaults=r,this.Client=e,this.Query=this.Client.Query,this.Pool=l(this.Client),this._pools=[],this.Connection=n,this.types=V(),this.DatabaseError=a},"PG");"u">typeof o.env.NODE_PG_FORCE_NATIVE?t.exports=new u(eY()):(t.exports=new u(i),Object.defineProperty(t.exports,"native",{configurable:!0,enumerable:!1,get(){var e=null;try{e=new u(eY())}catch(e){if("MODULE_NOT_FOUND"!==e.code)throw e}return Object.defineProperty(t.exports,"native",{value:e}),e}}))});P(),P(),B(),k(),P();var eX=Object.defineProperty,e0=Object.defineProperties,e1=Object.getOwnPropertyDescriptors,e2=Object.getOwnPropertySymbols,e6=Object.prototype.hasOwnProperty,e8=Object.prototype.propertyIsEnumerable,e5=d((e,t,i)=>t in e?eX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,"__defNormalProp"),e4=d((e,t)=>{for(var i in t||(t={}))e6.call(t,i)&&e5(e,i,t[i]);if(e2)for(var i of e2(t))e8.call(t,i)&&e5(e,i,t[i]);return e},"__spreadValues"),e3=d((e,t)=>e0(e,e1(t)),"__spreadProps"),e9=2===new Uint8Array(new Uint16Array([258]).buffer)[0],e7=new TextDecoder,te=new TextEncoder,tt=te.encode("0123456789abcdef"),ti=te.encode("0123456789ABCDEF"),tr=te.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").slice();function tn(e,{alphabet:r,scratchArr:n}={}){if(!t)if(t=new Uint16Array(256),i=new Uint16Array(256),e9)for(let e=0;e<256;e++)t[e]=tt[15&e]<<8|tt[e>>>4],i[e]=ti[15&e]<<8|ti[e>>>4];else for(let e=0;e<256;e++)t[e]=tt[15&e]|tt[e>>>4]<<8,i[e]=ti[15&e]|ti[e>>>4]<<8;e.byteOffset%4!=0&&(e=new Uint8Array(e));let s=e.length,o=s>>>2,a=n||new Uint16Array(s),l=new Uint32Array(e.buffer,e.byteOffset,o),u=new Uint32Array(a.buffer,a.byteOffset,s>>>1),c="upper"===r?i:t,h=0,f=0,d;if(e9)for(;h<o;)d=l[h++],u[f++]=c[d>>>8&255]<<16|c[255&d],u[f++]=c[d>>>24]<<16|c[d>>>16&255];else for(;h<o;)d=l[h++],u[f++]=c[d>>>24]<<16|c[d>>>16&255],u[f++]=c[d>>>8&255]<<16|c[255&d];for(h<<=2;h<s;)a[h]=c[e[h++]];return e7.decode(a.subarray(0,s))}function ts(e,t={}){let i="",r=e.length,n=Math.ceil(r/504e3),s=new Uint16Array(n>1?504e3:r);for(let r=0;r<n;r++){let n=504e3*r,o=n+504e3;i+=tn(e.subarray(n,o),e3(e4({},t),{scratchArr:s}))}return i}function to(e,t={}){return"upper"!==t.alphabet&&"function"==typeof e.toHex?e.toHex():ts(e,t)}tr[62]=45,tr[63]=95,d(tn,"_toHex"),d(ts,"_toHexChunked"),d(to,"toHex"),P();var ta=class e{constructor(e,t){this.strings=e,this.values=t}toParameterizedQuery(t={query:"",params:[]}){let{strings:i,values:r}=this;for(let n=0,o=i.length;n<o;n++)if(t.query+=i[n],n<r.length){let i=r[n];if(i instanceof tu)t.query+=i.sql;else if(i instanceof tv)if(i.queryData instanceof e)i.queryData.toParameterizedQuery(t);else{if(i.queryData.params?.length)throw Error("This query is not composable");t.query+=i.queryData.query}else{let{params:e}=t;e.push(i),t.query+="$"+e.length,(i instanceof s||ArrayBuffer.isView(i))&&(t.query+="::bytea")}}return t}};d(ta,"SqlTemplate");var tl=class{constructor(e){this.sql=e}};d(tl,"UnsafeRawSql");var tu=tl;function tc(){}P(),d(tc,"warnIfBrowser"),B();var th=b(W()),tf=b(es()),td=class e extends Error{constructor(t){super(t),v(this,"name","NeonDbError"),v(this,"severity"),v(this,"code"),v(this,"detail"),v(this,"hint"),v(this,"position"),v(this,"internalPosition"),v(this,"internalQuery"),v(this,"where"),v(this,"schema"),v(this,"table"),v(this,"column"),v(this,"dataType"),v(this,"constraint"),v(this,"file"),v(this,"line"),v(this,"routine"),v(this,"sourceError"),"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}};d(td,"NeonDbError");var tp="transaction() expects an array of queries, or a function returning an array of queries",tg=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function tm(e){return e instanceof s?"\\x"+to(e):e}function ty(e){let{query:t,params:i}=e instanceof ta?e.toParameterizedQuery():e;return{query:t,params:i.map(e=>tm((0,tf.prepareValue)(e)))}}function tb(e,{arrayMode:t,fullResults:i,fetchOptions:r,isolationLevel:n,readOnly:s,deferrable:o,authToken:a,disableWarningInBrowsers:l}={}){let u;if(!e)throw Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");try{u=O(e)}catch{throw Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(e))}let{protocol:c,username:h,hostname:f,port:p,pathname:g}=u;if("postgres:"!==c&&"postgresql:"!==c||!h||!f||!g)throw Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function m(e,...t){if(!(Array.isArray(e)&&Array.isArray(e.raw)&&Array.isArray(t)))throw Error('This function can now be called only as a tagged-template function: sql`SELECT ${value}`, not sql("SELECT $1", [value], options). For a conventional function call with value placeholders ($1, $2, etc.), use sql.query("SELECT $1", [value], options).');return new tv(y,new ta(e,t))}async function y(u,c,h){let d,{fetchEndpoint:g,fetchFunction:m}=L,y=Array.isArray(u)?{queries:u.map(e=>ty(e))}:ty(u),b=r??{},w=t??!1,v=i??!1,S=n,x=s,C=o;void 0!==h&&(void 0!==h.fetchOptions&&(b={...b,...h.fetchOptions}),void 0!==h.arrayMode&&(w=h.arrayMode),void 0!==h.fullResults&&(v=h.fullResults),void 0!==h.isolationLevel&&(S=h.isolationLevel),void 0!==h.readOnly&&(x=h.readOnly),void 0!==h.deferrable&&(C=h.deferrable)),void 0===c||Array.isArray(c)||void 0===c.fetchOptions||(b={...b,...c.fetchOptions});let P=a;Array.isArray(c)||c?.authToken===void 0||(P=c.authToken);let T="function"==typeof g?g(f,p,{jwtAuth:void 0!==P}):g,E={"Neon-Connection-String":e,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},_=await tx(P);_&&(E.Authorization=`Bearer ${_}`),Array.isArray(u)&&(void 0!==S&&(E["Neon-Batch-Isolation-Level"]=S),void 0!==x&&(E["Neon-Batch-Read-Only"]=String(x)),void 0!==C&&(E["Neon-Batch-Deferrable"]=String(C))),l||L.disableWarningInBrowsers||tc();try{d=await (m??fetch)(T,{method:"POST",body:JSON.stringify(y),headers:E,...b})}catch(t){let e=new td(`Error connecting to database: ${t}`);throw e.sourceError=t,e}if(d.ok){let e=await d.json();if(Array.isArray(u)){let t=e.results;if(!Array.isArray(t))throw new td("Neon internal error: unexpected result format");return t.map((e,t)=>{let i=c[t]??{};return tS(e,{arrayMode:i.arrayMode??w,fullResults:i.fullResults??v,types:i.types})})}{let t=c??{};return tS(e,{arrayMode:t.arrayMode??w,fullResults:t.fullResults??v,types:t.types})}}{let{status:e}=d;if(400===e){let e=await d.json(),t=new td(e.message);for(let i of tg)t[i]=e[i]??void 0;throw t}{let t=await d.text();throw new td(`Server error (HTTP status ${e}): ${t}`)}}}return d(m,"templateFn"),m.query=(e,t,i)=>new tv(y,{query:e,params:t??[]},i),m.unsafe=e=>new tu(e),m.transaction=async(e,t)=>{if("function"==typeof e&&(e=e(m)),!Array.isArray(e))throw Error(tp);return e.forEach(e=>{if(!(e instanceof tv))throw Error(tp)}),y(e.map(e=>e.queryData),e.map(e=>e.opts??{}),t)},d(y,"execute"),m}d(tm,"encodeBuffersAsBytea"),d(ty,"prepareQuery"),d(tb,"neon");var tw=class{constructor(e,t,i){this.execute=e,this.queryData=t,this.opts=i}then(e,t){return this.execute(this.queryData,this.opts).then(e,t)}catch(e){return this.execute(this.queryData,this.opts).catch(e)}finally(e){return this.execute(this.queryData,this.opts).finally(e)}};d(tw,"NeonQueryPromise");var tv=tw;function tS(e,{arrayMode:t,fullResults:i,types:r}){let n=new th.default(r),s=e.fields.map(e=>e.name),o=e.fields.map(e=>n.getTypeParser(e.dataTypeID)),a=!0===t?e.rows.map(e=>e.map((e,t)=>null===e?null:o[t](e))):e.rows.map(e=>Object.fromEntries(e.map((e,t)=>[s[t],null===e?null:o[t](e)])));return i?(e.viaNeonFetch=!0,e.rowAsArray=t,e.rows=a,e._parsers=o,e._types=n,e):a}async function tx(e){if("string"==typeof e)return e;if("function"==typeof e)try{return await Promise.resolve(e())}catch(t){let e=new td("Error getting auth token.");throw t instanceof Error&&(e=new td(`Error getting auth token: ${t.message}`)),e}}d(tS,"processQueryResult"),d(tx,"getAuthToken"),P();var tC=b(eZ());P();var tP=b(eZ()),tT=class extends tP.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let i="string"!=typeof this.config&&this.config?.host!==void 0||"string"!=typeof this.config&&this.config?.connectionString!==void 0||void 0!==o.env.PGHOST,r=o.env.USER??o.env.USERNAME;if(!i&&"localhost"===this.host&&this.user===r&&this.database===r&&null===this.password)throw Error(`No database host or connection string wa\
s set, and key parameters have default values (host: localhost, user: ${r}, db: ${r}, password: null\
). Is an environment variable missing? Alternatively, if you intended to connect with these paramete\
rs, please set the host to 'localhost' explicitly.`);let n=super.connect(e),s=t.pipelineTLS&&this.ssl,a="password"===t.pipelineConnect;if(!s&&!t.pipelineConnect)return n;let l=this.connection;if(s&&l.on("connect",()=>l.stream.emit("data","S")),a){l.removeAllListeners("authenticationCleartextPassword"),l.removeAllListeners("readyForQuery"),l.once("readyForQuery",()=>l.on("readyForQuery",this._handleReadyForQuery.bind(this)));let e=this.ssl?"sslconnect":"connect";l.on(e,()=>{this.neonConfig.disableWarningInBrowsers||tc(),this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return n}async _handleAuthSASLContinue(e){if(typeof crypto>"u"||void 0===crypto.subtle||void 0===crypto.subtle.importKey)throw Error("Cannot use SASL auth when `crypto.subtle` is not defined");let t=crypto.subtle,i=this.saslSession,r=this.password,n=e.data;if("SASLInitialResponse"!==i.message||"string"!=typeof r||"string"!=typeof n)throw Error("SASL: protocol error");let o=Object.fromEntries(n.split(",").map(e=>{if(!/^.=/.test(e))throw Error("SASL: Invalid attribute pair entry");return[e[0],e.substring(2)]})),a=o.r,l=o.s,u=o.i;if(!a||!/^[!-+--~]+$/.test(a))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!l||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(l))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!u||!/^[1-9][0-9]*$/.test(u))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(i.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===i.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let c=parseInt(u,10),h=s.from(l,"base64"),f=new TextEncoder,d=f.encode(r),p=await t.importKey("raw",d,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),g=new Uint8Array(await t.sign("HMAC",p,s.concat([h,s.from([0,0,0,1])]))),m=g;for(var y=0;y<c-1;y++)g=new Uint8Array(await t.sign("HMAC",p,g)),m=s.from(m.map((e,t)=>m[t]^g[t]));let b=m,w=await t.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),v=new Uint8Array(await t.sign("HMAC",w,f.encode("Client Key"))),S=await t.digest("SHA-256",v),x="n=*,r="+i.clientNonce,C="r="+a+",s="+l+",i="+c,P="c=biws,r="+a,T=x+","+C+","+P,E=await t.importKey("raw",S,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var _=new Uint8Array(await t.sign("HMAC",E,f.encode(T))),A=s.from(v.map((e,t)=>v[t]^_[t])).toString("base64");let N=await t.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),q=await t.sign("HMAC",N,f.encode("Server Key")),L=await t.importKey("raw",q,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var B=s.from(await t.sign("HMAC",L,f.encode(T)));i.message="SASLResponse",i.serverSignature=B.toString("base64"),i.response=P+",p="+A,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};d(tT,"NeonClient"),B();var tE=b(eq());function t_(e,t){let i,r;return t?{callback:t,result:void 0}:{callback:d(function(e,t){e?i(e):r(t)},"cb"),result:new e(function(e,t){r=e,i=t})}}d(t_,"promisify"),d(class extends tC.Pool{constructor(){super(...arguments),v(this,"Client",tT),v(this,"hasFetchUnsupportedListeners",!1),v(this,"addListener",this.on)}on(e,t){return"error"!==e&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,i){if(!L.poolQueryViaFetch||this.hasFetchUnsupportedListeners||"function"==typeof e)return super.query(e,t,i);"function"==typeof t&&(i=t,t=void 0);let r=t_(this.Promise,i);i=r.callback;try{let r=new tE.default(this.options),n=encodeURIComponent,s=encodeURI,o=`postgresql://${n(r.user)}:${n(r.password)}@${n(r.host)}\
/${s(r.database)}`,a="string"==typeof e?e:e.text,l=t??e.values??[];tb(o,{fullResults:!0,arrayMode:"array"===e.rowMode}).query(a,l,{types:e.types??this.options?.types}).then(e=>i(void 0,e)).catch(e=>i(e))}catch(e){i(e)}return r.result}},"NeonPool"),B();var tA=b(eZ());tA.DatabaseError,tA.defaults,tA.escapeIdentifier,tA.escapeLiteral;var tN=tA.types;e.s(["neon",()=>tb,"types",()=>tN])},44988,e=>{"use strict";let t=Symbol.for("drizzle:entityKind");function i(e,i){if(!e||"object"!=typeof e)return!1;if(e instanceof i)return!0;if(!Object.prototype.hasOwnProperty.call(i,t))throw Error(`Class "${i.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(e).constructor;if(r)for(;r;){if(t in r&&r[t]===i[t])return!0;r=Object.getPrototypeOf(r)}return!1}Symbol.for("drizzle:hasOwnEntityKind"),e.s(["entityKind",()=>t,"is",()=>i])},7932,e=>{"use strict";var t=e.i(44988);class i{static [t.entityKind]="ConsoleLogWriter";write(e){console.log(e)}}class r{static [t.entityKind]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new i}logQuery(e,t){let i=t.map(e=>{try{return JSON.stringify(e)}catch{return String(e)}}),r=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${e}${r}`)}}class n{static [t.entityKind]="NoopLogger";logQuery(){}}e.s(["DefaultLogger",()=>r,"NoopLogger",()=>n])},98020,e=>{"use strict";var t=e.i(44988);class i{static [t.entityKind]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}e.s(["QueryPromise",()=>i])},47211,56325,43179,833,63411,43233,4775,92352,22360,88274,69e3,18899,5672,e=>{"use strict";let t,i;var r,n=e.i(44988);class s{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static [n.entityKind]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}e.s(["Column",()=>s],56325);class o{static [n.entityKind]="ColumnBuilder";config;constructor(e,t,i){this.config={name:e,keyAsName:""===e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){""===this.config.name&&(this.config.name=e)}}e.s(["ColumnBuilder",()=>o],43179);let a=Symbol.for("drizzle:Name");e.s(["TableName",()=>a],833);class l{static [n.entityKind]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:t,columns:i,foreignColumns:r}=e();return{name:t,columns:i,foreignTable:r[0].table,foreignColumns:r}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new u(e,this)}}class u{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [n.entityKind]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:i}=this.reference(),r=t.map(e=>e.name),n=i.map(e=>e.name),s=[this.table[a],...r,i[0].table[a],...n];return e??`${s.join("_")}_fk`}}function c(e,...t){return e(...t)}function h(e,t){return`${e[a]}_${t.join("_")}_unique`}e.s(["ForeignKeyBuilder",()=>l],63411);class f{constructor(e,t){this.name=t,this.columns=e}static [n.entityKind]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new p(e,this.columns,this.nullsNotDistinctConfig,this.name)}}class d{static [n.entityKind]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new f(e,this.name)}}class p{constructor(e,t,i,r){this.table=e,this.columns=t,this.name=r??h(this.table,this.columns.map(e=>e.name)),this.nullsNotDistinct=i}static [n.entityKind]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}function g(e,t,i){for(let r=t;r<e.length;r++){let n=e[r];if("\\"===n){r++;continue}if('"'===n)return[e.slice(t,r).replace(/\\/g,""),r+1];if(!i&&(","===n||"}"===n))return[e.slice(t,r).replace(/\\/g,""),r]}return[e.slice(t).replace(/\\/g,""),e.length]}e.s(["UniqueConstraintBuilder",()=>f,"uniqueKeyName",()=>h],43233);class m extends o{foreignKeyConfigs=[];static [n.entityKind]="PgColumnBuilder";array(e){return new v(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:i,actions:r})=>c((i,r)=>{let n=new l(()=>({columns:[e],foreignColumns:[i()]}));return r.onUpdate&&n.onUpdate(r.onUpdate),r.onDelete&&n.onDelete(r.onDelete),n.build(t)},i,r))}buildExtraConfigColumn(e){return new b(e,this.config)}}class y extends s{constructor(e,t){t.uniqueName||(t.uniqueName=h(e,[t.name])),super(e,t),this.table=e}static [n.entityKind]="PgColumn"}class b extends y{static [n.entityKind]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class w{static [n.entityKind]="IndexedColumn";constructor(e,t,i,r){this.name=e,this.keyAsName=t,this.type=i,this.indexConfig=r}name;keyAsName;type;indexConfig}class v extends m{static [n.entityKind]="PgArrayBuilder";constructor(e,t,i){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=i}build(e){let t=this.config.baseBuilder.build(e);return new S(e,this.config,t)}}class S extends y{constructor(e,t,i,r){super(e,t),this.baseColumn=i,this.range=r,this.size=t.size}size;static [n.entityKind]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=function(e){let[t]=function e(t,i=0){let r=[],n=i,s=!1;for(;n<t.length;){let o=t[n];if(","===o){(s||n===i)&&r.push(""),s=!0,n++;continue}if(s=!1,"\\"===o){n+=2;continue}if('"'===o){let[e,i]=g(t,n+1,!0);r.push(e),n=i;continue}if("}"===o)return[r,n+1];if("{"===o){let[i,s]=e(t,n+1);r.push(i),n=s;continue}let[a,l]=g(t,n,!1);r.push(a),n=l}return[r,n]}(e,1);return t}(e)),e.map(e=>this.baseColumn.mapFromDriverValue(e))}mapToDriverValue(e,t=!1){let i=e.map(e=>null===e?null:(0,n.is)(this.baseColumn,S)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e));return t?i:function e(t){return`{${t.map(t=>Array.isArray(t)?e(t):"string"==typeof t?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}(i)}}e.s(["IndexedColumn",()=>w,"PgColumn",()=>y,"PgColumnBuilder",()=>m],4775);class x extends m{static [n.entityKind]="PgEnumObjectColumnBuilder";constructor(e,t){super(e,"string","PgEnumObjectColumn"),this.config.enum=t}build(e){return new C(e,this.config)}}class C extends y{static [n.entityKind]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}let P=Symbol.for("drizzle:isPgEnum");class T extends m{static [n.entityKind]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new E(e,this.config)}}class E extends y{static [n.entityKind]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}class _{static [n.entityKind]="Subquery";constructor(e,t,i,r=!1,n=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:i,isWith:r,usedTables:n}}}class A extends _{static [n.entityKind]="WithSubquery"}e.s(["Subquery",()=>_,"WithSubquery",()=>A],92352);let N={startActiveSpan:(e,r)=>t?(i||(i=t.trace.getTracer("drizzle-orm","0.45.1")),c((t,i)=>i.startActiveSpan(e,e=>{try{return r(e)}catch(i){throw e.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{e.end()}}),t,i)):r()};e.s(["tracer",()=>N],22360);let q=Symbol.for("drizzle:ViewBaseConfig");e.s(["ViewBaseConfig",()=>q],88274);let L=Symbol.for("drizzle:Schema"),B=Symbol.for("drizzle:Columns"),I=Symbol.for("drizzle:ExtraConfigColumns"),O=Symbol.for("drizzle:OriginalName"),k=Symbol.for("drizzle:BaseName"),D=Symbol.for("drizzle:IsAlias"),M=Symbol.for("drizzle:ExtraConfigBuilder"),R=Symbol.for("drizzle:IsDrizzleTable");class Q{static [n.entityKind]="Table";static Symbol={Name:a,Schema:L,OriginalName:O,Columns:B,ExtraConfigColumns:I,BaseName:k,IsAlias:D,ExtraConfigBuilder:M};[a];[O];[L];[B];[I];[k];[D]=!1;[R]=!0;[M]=void 0;constructor(e,t,i){this[a]=this[O]=e,this[L]=t,this[k]=i}}function $(e){return"object"==typeof e&&null!==e&&R in e}function F(e){return e[a]}function U(e){return`${e[L]??"public"}.${e[a]}`}e.s(["Columns",()=>B,"IsAlias",()=>D,"Schema",()=>L,"Table",()=>Q,"getTableName",()=>F,"getTableUniqueName",()=>U,"isTable",()=>$],69e3);class j{static [n.entityKind]="FakePrimitiveParam"}function K(e){return null!=e&&"function"==typeof e.getSQL}class z{static [n.entityKind]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new V([this])}}class V{constructor(e){for(const t of(this.queryChunks=e,e))if((0,n.is)(t,Q)){const e=t[Q.Symbol.Schema];this.usedTables.push(void 0===e?t[Q.Symbol.Name]:e+"."+t[Q.Symbol.Name])}}static [n.entityKind]="SQL";decoder=G;shouldInlineParams=!1;usedTables=[];append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return N.startActiveSpan("drizzle.buildSQL",t=>{let i=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(e,t){let i=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:r,escapeName:o,escapeParam:a,prepareTyping:l,inlineParams:u,paramStartIndex:c}=i;var h=e.map(e=>{if((0,n.is)(e,z))return{sql:e.value.join(""),params:[]};if((0,n.is)(e,W))return{sql:o(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){let t=[new z("(")];for(let[i,r]of e.entries())t.push(r),i<e.length-1&&t.push(new z(", "));return t.push(new z(")")),this.buildQueryFromSourceParams(t,i)}if((0,n.is)(e,V))return this.buildQueryFromSourceParams(e.queryChunks,{...i,inlineParams:u||e.shouldInlineParams});if((0,n.is)(e,Q)){let t=e[Q.Symbol.Schema],i=e[Q.Symbol.Name];return{sql:void 0===t||e[D]?o(i):o(t)+"."+o(i),params:[]}}if((0,n.is)(e,s)){let i=r.getColumnCasing(e);if("indexes"===t.invokeSource)return{sql:o(i),params:[]};let n=e.table[Q.Symbol.Schema];return{sql:e.table[D]||void 0===n?o(e.table[Q.Symbol.Name])+"."+o(i):o(n)+"."+o(e.table[Q.Symbol.Name])+"."+o(i),params:[]}}if((0,n.is)(e,en)){let t=e[q].schema,i=e[q].name;return{sql:void 0===t||e[q].isAlias?o(i):o(t)+"."+o(i),params:[]}}if((0,n.is)(e,Y)){if((0,n.is)(e.value,et))return{sql:a(c.value++,e),params:[e],typings:["none"]};let t=null===e.value?null:e.encoder.mapToDriverValue(e.value);if((0,n.is)(t,V))return this.buildQueryFromSourceParams([t],i);if(u)return{sql:this.mapInlineParam(t,i),params:[]};let r=["none"];return l&&(r=[l(e.encoder)]),{sql:a(c.value++,t),params:[t],typings:r}}return(0,n.is)(e,et)?{sql:a(c.value++,e),params:[e],typings:["none"]}:(0,n.is)(e,V.Aliased)&&void 0!==e.fieldAlias?{sql:o(e.fieldAlias),params:[]}:(0,n.is)(e,_)?e._.isWith?{sql:o(e._.alias),params:[]}:this.buildQueryFromSourceParams([new z("("),e._.sql,new z(") "),new W(e._.alias)],i):e&&"function"==typeof e&&P in e&&!0===e[P]?e.schema?{sql:o(e.schema)+"."+o(e.enumName),params:[]}:{sql:o(e.enumName),params:[]}:K(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],i):this.buildQueryFromSourceParams([new z("("),e.getSQL(),new z(")")],i):u?{sql:this.mapInlineParam(e,i),params:[]}:{sql:a(c.value++,e),params:[e],typings:["none"]}});let f={sql:"",params:[]};for(let e of h)f.sql+=e.sql,f.params.push(...e.params),e.typings?.length&&(f.typings||(f.typings=[]),f.typings.push(...e.typings));return f}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){let i=e.toString();return"[object Object]"===i?t(JSON.stringify(e)):t(i)}throw Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new V.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class W{constructor(e){this.value=e}static [n.entityKind]="Name";brand;getSQL(){return new V([this])}}function H(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}let G={mapFromDriverValue:e=>e},J={mapToDriverValue:e=>e};({...G,...J});class Y{constructor(e,t=J){this.value=e,this.encoder=t}static [n.entityKind]="Param";brand;getSQL(){return new V([this])}}function Z(e,...t){let i=[];for(let[r,n]of((t.length>0||e.length>0&&""!==e[0])&&i.push(new z(e[0])),t.entries()))i.push(n,new z(e[r+1]));return new V(i)}(r=Z||(Z={})).empty=function(){return new V([])},r.fromList=function(e){return new V(e)},r.raw=function(e){return new V([new z(e)])},r.join=function(e,t){let i=[];for(let[r,n]of e.entries())r>0&&void 0!==t&&i.push(t),i.push(n);return new V(i)},r.identifier=function(e){return new W(e)},r.placeholder=function(e){return new et(e)},r.param=function(e,t){return new Y(e,t)};var X=V||(V={});class ee{constructor(e,t){this.sql=e,this.fieldAlias=t}static [n.entityKind]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new ee(this.sql,this.fieldAlias)}}X.Aliased=ee;class et{constructor(e){this.name=e}static [n.entityKind]="Placeholder";getSQL(){return new V([this])}}function ei(e,t){return e.map(e=>{if((0,n.is)(e,et)){if(!(e.name in t))throw Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}if((0,n.is)(e,Y)&&(0,n.is)(e.value,et)){if(!(e.value.name in t))throw Error(`No value for placeholder "${e.value.name}" was provided`);return e.encoder.mapToDriverValue(t[e.value.name])}return e})}let er=Symbol.for("drizzle:IsDrizzleView");class en{static [n.entityKind]="View";[q];[er]=!0;constructor({name:e,schema:t,selectedFields:i,query:r}){this[q]={name:e,originalName:e,schema:t,selectedFields:i,query:r,isExisting:!r,isAlias:!1}}getSQL(){return new V([this])}}function es(e){return"object"==typeof e&&null!==e&&er in e}s.prototype.getSQL=function(){return new V([this])},Q.prototype.getSQL=function(){return new V([this])},_.prototype.getSQL=function(){return new V([this])},e.s(["Param",()=>Y,"Placeholder",()=>et,"SQL",()=>V,"StringChunk",()=>z,"View",()=>en,"fillPlaceholders",()=>ei,"isDriverValueEncoder",()=>H,"isSQLWrapper",()=>K,"isView",()=>es,"sql",()=>Z],18899);class eo{constructor(e){this.table=e}static [n.entityKind]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class ea{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static [n.entityKind]="TableAliasProxyHandler";get(e,t){if(t===Q.Symbol.IsAlias)return!0;if(t===Q.Symbol.Name||this.replaceOriginalName&&t===Q.Symbol.OriginalName)return this.alias;if(t===q)return{...e[q],name:this.alias,isAlias:!0};if(t===Q.Symbol.Columns){let t=e[Q.Symbol.Columns];if(!t)return t;let i={};return Object.keys(t).map(r=>{i[r]=new Proxy(t[r],new eo(new Proxy(e,this)))}),i}let i=e[t];return(0,n.is)(i,s)?new Proxy(i,new eo(new Proxy(e,this))):i}}class el{constructor(e){this.alias=e}static [n.entityKind]="RelationTableAliasProxyHandler";get(e,t){return"sourceTable"===t?eu(e.sourceTable,this.alias):e[t]}}function eu(e,t){return new Proxy(e,new ea(t,!1))}function ec(e,t){return new Proxy(e,new eo(new Proxy(e.table,new ea(t,!1))))}function eh(e,t){return new V.Aliased(ef(e.sql,t),e.fieldAlias)}function ef(e,t){return Z.join(e.queryChunks.map(e=>(0,n.is)(e,s)?ec(e,t):(0,n.is)(e,V)?ef(e,t):(0,n.is)(e,V.Aliased)?eh(e,t):e))}e.s(["ColumnAliasProxyHandler",()=>eo,"TableAliasProxyHandler",()=>ea,"aliasedTable",()=>eu,"aliasedTableColumn",()=>ec,"mapColumnsInAliasedSQLToAlias",()=>eh,"mapColumnsInSQLToAlias",()=>ef],5672);class ed{static [n.entityKind]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if("_"===t)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===q)return{...e[q],selectedFields:new Proxy(e[q].selectedFields,this)};if("symbol"==typeof t)return e[t];let i=((0,n.is)(e,_)?e._.selectedFields:(0,n.is)(e,en)?e[q].selectedFields:e)[t];if((0,n.is)(i,V.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!i.isSelectionField)return i.sql;let e=i.clone();return e.isSelectionField=!0,e}if((0,n.is)(i,V)){if("sql"===this.config.sqlBehavior)return i;throw Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,n.is)(i,s)?this.config.alias?new Proxy(i,new eo(new Proxy(i.table,new ea(this.config.alias,this.config.replaceOriginalName??!1)))):i:"object"!=typeof i||null===i?i:new Proxy(i,new ed(this.config))}}e.s(["SelectionProxyHandler",()=>ed],47211)},4313,e=>{"use strict";var t=e.i(56325),i=e.i(44988),r=e.i(18899),n=e.i(92352),s=e.i(69e3),o=e.i(88274);function a(e,o,a){let l={},u=e.reduce((e,{path:u,field:c},h)=>{let f;f=(0,i.is)(c,t.Column)?c:(0,i.is)(c,r.SQL)?c.decoder:(0,i.is)(c,n.Subquery)?c._.sql.decoder:c.sql.decoder;let d=e;for(let[e,r]of u.entries())if(e<u.length-1)r in d||(d[r]={}),d=d[r];else{let e=o[h],n=d[r]=null===e?null:f.mapFromDriverValue(e);if(a&&(0,i.is)(c,t.Column)&&2===u.length){let e=u[0];e in l?"string"==typeof l[e]&&l[e]!==(0,s.getTableName)(c.table)&&(l[e]=!1):l[e]=null===n&&(0,s.getTableName)(c.table)}}return e},{});if(a&&Object.keys(l).length>0)for(let[e,t]of Object.entries(l))"string"!=typeof t||a[t]||(u[e]=null);return u}function l(e,t){let i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(let[e,t]of i.entries())if(t!==r[e])return!1;return!0}function u(e,n){let o=Object.entries(n).filter(([,e])=>void 0!==e).map(([n,o])=>(0,i.is)(o,r.SQL)||(0,i.is)(o,t.Column)?[n,o]:[n,new r.Param(o,e[s.Table.Symbol.Columns][n])]);if(0===o.length)throw Error("No values to set");return Object.fromEntries(o)}function c(e,t){for(let i of t)for(let t of Object.getOwnPropertyNames(i.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(i.prototype,t)||Object.create(null))}function h(e){return e[s.Table.Symbol.Columns]}function f(e){return e[o.ViewBaseConfig].selectedFields}function d(e){return(0,i.is)(e,n.Subquery)?e._.alias:(0,i.is)(e,r.View)?e[o.ViewBaseConfig].name:(0,i.is)(e,r.SQL)?void 0:e[s.Table.Symbol.IsAlias]?e[s.Table.Symbol.Name]:e[s.Table.Symbol.BaseName]}function p(e,t){return{name:"string"==typeof e&&e.length>0?e:"",config:"object"==typeof e?e:t}}function g(e){if("object"!=typeof e||null===e||"Object"!==e.constructor.name)return!1;if("logger"in e){let t=typeof e.logger;return"boolean"===t||"object"===t&&"function"==typeof e.logger.logQuery||"undefined"===t}if("schema"in e){let t=typeof e.schema;return"object"===t||"undefined"===t}if("casing"in e){let t=typeof e.casing;return"string"===t||"undefined"===t}if("mode"in e)return"default"===e.mode&&"planetscale"===e.mode&&void 0===e.mode;if("connection"in e){let t=typeof e.connection;return"string"===t||"object"===t||"undefined"===t}if("client"in e){let t=typeof e.client;return"object"===t||"function"===t||"undefined"===t}return 0===Object.keys(e).length}let m="undefined"==typeof TextDecoder?null:new TextDecoder;e.s(["applyMixins",()=>c,"getColumnNameAndConfig",()=>p,"getTableColumns",()=>h,"getTableLikeName",()=>d,"getViewSelectedFields",()=>f,"haveSameKeys",()=>l,"isConfig",()=>g,"mapResultRow",()=>a,"mapUpdateSet",()=>u,"orderSelectedFields",()=>function e(o,a){return Object.entries(o).reduce((o,[l,u])=>{if("string"!=typeof l)return o;let c=a?[...a,l]:[l];return(0,i.is)(u,t.Column)||(0,i.is)(u,r.SQL)||(0,i.is)(u,r.SQL.Aliased)||(0,i.is)(u,n.Subquery)?o.push({path:c,field:u}):(0,i.is)(u,s.Table)?o.push(...e(u[s.Table.Symbol.Columns],c)):o.push(...e(u,c)),o},[])},"textDecoder",()=>m])},94093,2847,56923,70988,1727,38257,48209,84259,93486,3090,67751,e=>{"use strict";var t=e.i(44988),i=e.i(69e3),r=e.i(4313),n=e.i(4775),s=n;class o extends s.PgColumnBuilder{static [t.entityKind]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...i}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...i}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class a extends o{static [t.entityKind]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new l(e,this.config)}}class l extends n.PgColumn{static [t.entityKind]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class u extends o{static [t.entityKind]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new c(e,this.config)}}class c extends n.PgColumn{static [t.entityKind]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}function h(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return"number"===n.mode?new a(i):new u(i)}var f=n;class d extends f.PgColumnBuilder{static [t.entityKind]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new p(e,this.config)}}class p extends f.PgColumn{static [t.entityKind]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class g extends f.PgColumnBuilder{static [t.entityKind]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new m(e,this.config)}}class m extends f.PgColumn{static [t.entityKind]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}function y(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return"number"===n.mode?new d(i):new g(i)}var b=n;class w extends b.PgColumnBuilder{static [t.entityKind]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new v(e,this.config)}}class v extends b.PgColumn{static [t.entityKind]="PgBoolean";getSQLType(){return"boolean"}}function S(e){return new w(e??"")}e.s(["boolean",()=>S],2847);var x=n;class C extends x.PgColumnBuilder{static [t.entityKind]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new P(e,this.config)}}class P extends x.PgColumn{static [t.entityKind]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function T(e,t={}){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new C(i,n)}var E=n;class _ extends E.PgColumnBuilder{static [t.entityKind]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new A(e,this.config)}}class A extends E.PgColumn{static [t.entityKind]="PgCidr";getSQLType(){return"cidr"}}function N(e){return new _(e??"")}var q=n;class L extends q.PgColumnBuilder{static [t.entityKind]="PgCustomColumnBuilder";constructor(e,t,i){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=i}build(e){return new B(e,this.config)}}class B extends q.PgColumn{static [t.entityKind]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function I(e){return(t,i)=>{let{name:n,config:s}=(0,r.getColumnNameAndConfig)(t,i);return new L(n,s,e)}}var O=n,k=e.i(18899),D=n;class M extends D.PgColumnBuilder{static [t.entityKind]="PgDateColumnBaseBuilder";defaultNow(){return this.default(k.sql`now()`)}}class R extends M{static [t.entityKind]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Q(e,this.config)}}class Q extends O.PgColumn{static [t.entityKind]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return"string"==typeof e?new Date(e):e}mapToDriverValue(e){return e.toISOString()}}class $ extends M{static [t.entityKind]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new F(e,this.config)}}class F extends O.PgColumn{static [t.entityKind]="PgDateString";getSQLType(){return"date"}mapFromDriverValue(e){return"string"==typeof e?e:e.toISOString().slice(0,-14)}}function U(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return n?.mode==="date"?new R(i):new $(i)}e.s(["PgDate",()=>Q,"PgDateString",()=>F,"date",()=>U],56923);var j=n;class K extends j.PgColumnBuilder{static [t.entityKind]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new z(e,this.config)}}class z extends j.PgColumn{static [t.entityKind]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return"string"==typeof e?Number.parseFloat(e):e}}function V(e){return new K(e??"")}var W=n;class H extends W.PgColumnBuilder{static [t.entityKind]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new G(e,this.config)}}class G extends W.PgColumn{static [t.entityKind]="PgInet";getSQLType(){return"inet"}}function J(e){return new H(e??"")}var Y=n;class Z extends o{static [t.entityKind]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new X(e,this.config)}}class X extends Y.PgColumn{static [t.entityKind]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return"string"==typeof e?Number.parseInt(e):e}}function ee(e){return new Z(e??"")}e.s(["integer",()=>ee],70988);var et=n;class ei extends et.PgColumnBuilder{static [t.entityKind]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new er(e,this.config)}}class er extends et.PgColumn{static [t.entityKind]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}function en(e,t={}){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new ei(i,n)}var es=n;class eo extends es.PgColumnBuilder{static [t.entityKind]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new ea(e,this.config)}}class ea extends es.PgColumn{static [t.entityKind]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function el(e){return new eo(e??"")}e.s(["PgJson",()=>ea,"json",()=>el],1727);var eu=n;class ec extends eu.PgColumnBuilder{static [t.entityKind]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new eh(e,this.config)}}class eh extends eu.PgColumn{static [t.entityKind]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function ef(e){return new ec(e??"")}e.s(["PgJsonb",()=>eh,"jsonb",()=>ef],38257);var ed=n;class ep extends ed.PgColumnBuilder{static [t.entityKind]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new eg(e,this.config)}}class eg extends ed.PgColumn{static [t.entityKind]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,i,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i),Number.parseFloat(r)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}class em extends ed.PgColumnBuilder{static [t.entityKind]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new ey(e,this.config)}}class ey extends ed.PgColumn{static [t.entityKind]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,i,r]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(i),c:Number.parseFloat(r)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}function eb(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return n?.mode&&"tuple"!==n.mode?new em(i):new ep(i)}var ew=n;class ev extends ew.PgColumnBuilder{static [t.entityKind]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new eS(e,this.config)}}class eS extends ew.PgColumn{static [t.entityKind]="PgMacaddr";getSQLType(){return"macaddr"}}function ex(e){return new ev(e??"")}var eC=n;class eP extends eC.PgColumnBuilder{static [t.entityKind]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new eT(e,this.config)}}class eT extends eC.PgColumn{static [t.entityKind]="PgMacaddr8";getSQLType(){return"macaddr8"}}function eE(e){return new eP(e??"")}var e_=n;class eA extends e_.PgColumnBuilder{static [t.entityKind]="PgNumericBuilder";constructor(e,t,i){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=i}build(e){return new eN(e,this.config)}}class eN extends e_.PgColumn{static [t.entityKind]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return"string"==typeof e?e:String(e)}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class eq extends e_.PgColumnBuilder{static [t.entityKind]="PgNumericNumberBuilder";constructor(e,t,i){super(e,"number","PgNumericNumber"),this.config.precision=t,this.config.scale=i}build(e){return new eL(e,this.config)}}class eL extends e_.PgColumn{static [t.entityKind]="PgNumericNumber";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class eB extends e_.PgColumnBuilder{static [t.entityKind]="PgNumericBigIntBuilder";constructor(e,t,i){super(e,"bigint","PgNumericBigInt"),this.config.precision=t,this.config.scale=i}build(e){return new eI(e,this.config)}}class eI extends e_.PgColumn{static [t.entityKind]="PgNumericBigInt";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function eO(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t),s=n?.mode;return"number"===s?new eq(i,n?.precision,n?.scale):"bigint"===s?new eB(i,n?.precision,n?.scale):new eA(i,n?.precision,n?.scale)}e.s(["PgNumeric",()=>eN,"decimal",()=>eO,"numeric",()=>eO],48209);var ek=n;class eD extends ek.PgColumnBuilder{static [t.entityKind]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new eM(e,this.config)}}class eM extends ek.PgColumn{static [t.entityKind]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}class eR extends ek.PgColumnBuilder{static [t.entityKind]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new eQ(e,this.config)}}class eQ extends ek.PgColumn{static [t.entityKind]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,i]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(i)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}function e$(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return n?.mode&&"tuple"!==n.mode?new eR(i):new eD(i)}var eF=n;function eU(e,t){let i=new DataView(new ArrayBuffer(8));for(let r=0;r<8;r++)i.setUint8(r,e[t+r]);return i.getFloat64(0,!0)}function ej(e){let t=function(e){let t=[];for(let i=0;i<e.length;i+=2)t.push(Number.parseInt(e.slice(i,i+2),16));return new Uint8Array(t)}(e),i=0,r=t[0];i+=1;let n=new DataView(t.buffer),s=n.getUint32(i,1===r);if(i+=4,0x20000000&s&&(n.getUint32(i,1===r),i+=4),(65535&s)==1){let e=eU(t,i),r=eU(t,i+=8);return i+=8,[e,r]}throw Error("Unsupported geometry type")}class eK extends eF.PgColumnBuilder{static [t.entityKind]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new ez(e,this.config)}}class ez extends eF.PgColumn{static [t.entityKind]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return ej(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}class eV extends eF.PgColumnBuilder{static [t.entityKind]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new eW(e,this.config)}}class eW extends eF.PgColumn{static [t.entityKind]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=ej(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}function eH(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return n?.mode&&"tuple"!==n.mode?new eV(i):new eK(i)}var eG=n;class eJ extends eG.PgColumnBuilder{static [t.entityKind]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new eY(e,this.config)}}class eY extends eG.PgColumn{static [t.entityKind]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>"string"==typeof e?Number.parseFloat(e):e}function eZ(e){return new eJ(e??"")}var eX=n;class e0 extends eX.PgColumnBuilder{static [t.entityKind]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new e1(e,this.config)}}class e1 extends eX.PgColumn{static [t.entityKind]="PgSerial";getSQLType(){return"serial"}}function e2(e){return new e0(e??"")}var e6=n;class e8 extends o{static [t.entityKind]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new e5(e,this.config)}}class e5 extends e6.PgColumn{static [t.entityKind]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>"string"==typeof e?Number(e):e}function e4(e){return new e8(e??"")}var e3=n;class e9 extends e3.PgColumnBuilder{static [t.entityKind]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new e7(e,this.config)}}class e7 extends e3.PgColumn{static [t.entityKind]="PgSmallSerial";getSQLType(){return"smallserial"}}function te(e){return new e9(e??"")}var tt=n;class ti extends tt.PgColumnBuilder{static [t.entityKind]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new tr(e,this.config)}}class tr extends tt.PgColumn{static [t.entityKind]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function tn(e,t={}){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new ti(i,n)}e.s(["text",()=>tn],84259);var ts=n;class to extends M{constructor(e,t,i){super(e,"string","PgTime"),this.withTimezone=t,this.precision=i,this.config.withTimezone=t,this.config.precision=i}static [t.entityKind]="PgTimeBuilder";build(e){return new ta(e,this.config)}}class ta extends ts.PgColumn{static [t.entityKind]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`time${e}${this.withTimezone?" with time zone":""}`}}function tl(e,t={}){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new to(i,n.withTimezone??!1,n.precision)}e.s(["PgTime",()=>ta,"time",()=>tl],93486);var tu=n;class tc extends M{static [t.entityKind]="PgTimestampBuilder";constructor(e,t,i){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=i}build(e){return new th(e,this.config)}}class th extends tu.PgColumn{static [t.entityKind]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":` (${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(e){return"string"==typeof e?new Date(this.withTimezone?e:e+"+0000"):e}mapToDriverValue=e=>e.toISOString()}class tf extends M{static [t.entityKind]="PgTimestampStringBuilder";constructor(e,t,i){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=i}build(e){return new td(e,this.config)}}class td extends tu.PgColumn{static [t.entityKind]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(e){if("string"==typeof e)return e;let t=e.toISOString().slice(0,-1).replace("T"," ");if(this.withTimezone){let i=e.getTimezoneOffset();return`${t}${i<=0?"+":"-"}${Math.floor(Math.abs(i)/60).toString().padStart(2,"0")}`}return t}}function tp(e,t={}){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return n?.mode==="string"?new tf(i,n.withTimezone??!1,n.precision):new tc(i,n?.withTimezone??!1,n?.precision)}e.s(["PgTimestamp",()=>th,"PgTimestampString",()=>td,"timestamp",()=>tp],3090);var tg=n;class tm extends tg.PgColumnBuilder{static [t.entityKind]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(k.sql`gen_random_uuid()`)}build(e){return new ty(e,this.config)}}class ty extends tg.PgColumn{static [t.entityKind]="PgUUID";getSQLType(){return"uuid"}}function tb(e){return new tm(e??"")}e.s(["PgUUID",()=>ty,"uuid",()=>tb],67751);var tw=n;class tv extends tw.PgColumnBuilder{static [t.entityKind]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new tS(e,this.config)}}class tS extends tw.PgColumn{static [t.entityKind]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function tx(e,t={}){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new tv(i,n)}var tC=n;class tP extends tC.PgColumnBuilder{static [t.entityKind]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new tT(e,this.config)}}class tT extends tC.PgColumn{static [t.entityKind]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function tE(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new tP(i,n)}var t_=n;class tA extends t_.PgColumnBuilder{static [t.entityKind]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new tN(e,this.config)}}class tN extends t_.PgColumn{static [t.entityKind]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function tq(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new tA(i,n)}var tL=n;class tB extends tL.PgColumnBuilder{static [t.entityKind]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new tI(e,this.config)}}class tI extends tL.PgColumn{static [t.entityKind]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function tO(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new tB(i,n)}var tk=n;class tD extends tk.PgColumnBuilder{static [t.entityKind]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new tM(e,this.config)}}class tM extends tk.PgColumn{static [t.entityKind]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function tR(e,t){let{name:i,config:n}=(0,r.getColumnNameAndConfig)(e,t);return new tD(i,n)}let tQ=Symbol.for("drizzle:PgInlineForeignKeys"),t$=Symbol.for("drizzle:EnableRLS");class tF extends i.Table{static [t.entityKind]="PgTable";static Symbol=Object.assign({},i.Table.Symbol,{InlineForeignKeys:tQ,EnableRLS:t$});[tQ]=[];[t$]=!1;[i.Table.Symbol.ExtraConfigBuilder]=void 0;[i.Table.Symbol.ExtraConfigColumns]={}}let tU=(e,t,r)=>(function(e,t,r,n,s=e){let o=new tF(e,n,s),a="function"==typeof t?t({bigint:h,bigserial:y,boolean:S,char:T,cidr:N,customType:I,date:U,doublePrecision:V,inet:J,integer:ee,interval:en,json:el,jsonb:ef,line:eb,macaddr:ex,macaddr8:eE,numeric:eO,point:e$,geometry:eH,real:eZ,serial:e2,smallint:e4,smallserial:te,text:tn,time:tl,timestamp:tp,uuid:tb,varchar:tx,bit:tE,halfvec:tq,sparsevec:tO,vector:tR}):t,l=Object.fromEntries(Object.entries(a).map(([e,t])=>{t.setName(e);let i=t.build(o);return o[tQ].push(...t.buildForeignKeys(i,o)),[e,i]})),u=Object.fromEntries(Object.entries(a).map(([e,t])=>(t.setName(e),[e,t.buildExtraConfigColumn(o)]))),c=Object.assign(o,l);return c[i.Table.Symbol.Columns]=l,c[i.Table.Symbol.ExtraConfigColumns]=u,r&&(c[tF.Symbol.ExtraConfigBuilder]=r),Object.assign(c,{enableRLS:()=>(c[tF.Symbol.EnableRLS]=!0,c)})})(e,t,r,void 0);e.s(["PgTable",()=>tF,"pgTable",()=>tU],94093)},58081,20776,48211,e=>{"use strict";var t=e.i(44988);class i{constructor(e,t){this.name=e,this.value=t}static [t.entityKind]="PgCheckBuilder";brand;build(e){return new r(e,this)}}class r{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}static [t.entityKind]="PgCheck";name;value}e.s(["CheckBuilder",()=>i],58081);var n=e.i(18899),s=e.i(4775);class o{constructor(e,t){this.unique=e,this.name=t}static [t.entityKind]="PgIndexBuilderOn";on(...e){return new a(e.map(e=>{if((0,t.is)(e,n.SQL))return e;let i=new s.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),i}),this.unique,!1,this.name)}onOnly(...e){return new a(e.map(e=>{if((0,t.is)(e,n.SQL))return e;let i=new s.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=e.defaultConfig,i}),this.unique,!0,this.name)}using(e,...i){return new a(i.map(e=>{if((0,t.is)(e,n.SQL))return e;let i=new s.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),i}),this.unique,!0,this.name,e)}}class a{static [t.entityKind]="PgIndexBuilder";config;constructor(e,t,i,r,n="btree"){this.config={name:r,columns:e,unique:t,only:i,method:n}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new l(this.config,e)}}class l{static [t.entityKind]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}}e.s(["IndexBuilder",()=>a],20776);class u{constructor(e,t){this.name=e,t&&(this.as=t.as,this.for=t.for,this.to=t.to,this.using=t.using,this.withCheck=t.withCheck)}static [t.entityKind]="PgPolicy";as;for;to;using;withCheck;_linkedTable;link(e){return this._linkedTable=e,this}}e.s(["PgPolicy",()=>u],48211)},44902,e=>{"use strict";var t=e.i(44988),i=e.i(94093);function r(...e){return e[0].columns?new n(e[0].columns,e[0].name):new n(e)}class n{static [t.entityKind]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new s(e,this.columns,this.name)}}class s{constructor(e,t,i){this.table=e,this.columns=t,this.name=i}static [t.entityKind]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[i.PgTable.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}e.s(["PrimaryKeyBuilder",()=>n,"primaryKey",()=>r])},71896,e=>{"use strict";let t=Symbol.for("drizzle:PgViewConfig");e.s(["PgViewConfig",()=>t])},22689,71783,e=>{"use strict";var t=e.i(44988),i=e.i(69e3);function r(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(e=>e.toLowerCase()).join("_")}function n(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((e,t,i)=>e+(0===i?t.toLowerCase():`${t[0].toUpperCase()}${t.slice(1)}`),"")}function s(e){return e}class o{static [t.entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert="snake_case"===e?r:"camelCase"===e?n:s}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[i.Table.Symbol.Schema]??"public",r=e.table[i.Table.Symbol.OriginalName],n=`${t}.${r}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[i.Table.Symbol.Schema]??"public",r=e[i.Table.Symbol.OriginalName],n=`${t}.${r}`;if(!this.cachedTables[n]){for(let t of Object.values(e[i.Table.Symbol.Columns])){let e=`${n}.${t.name}`;this.cache[e]=this.convert(t.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}}e.s(["CasingCache",()=>o],22689);class a extends Error{static [t.entityKind]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class l extends Error{constructor(e,t,i){super(`Failed query: ${e}
params: ${t}`),this.query=e,this.params=t,this.cause=i,Error.captureStackTrace(this,l),i&&(this.cause=i)}}class u extends a{static [t.entityKind]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}e.s(["DrizzleError",()=>a,"DrizzleQueryError",()=>l,"TransactionRollbackError",()=>u],71783)},79822,75225,49129,e=>{"use strict";var t=e.i(69e3),i=e.i(56325),r=e.i(44988),n=e.i(44902),s=e.i(18899);function o(e,n){return!(0,s.isDriverValueEncoder)(n)||(0,s.isSQLWrapper)(e)||(0,r.is)(e,s.Param)||(0,r.is)(e,s.Placeholder)||(0,r.is)(e,i.Column)||(0,r.is)(e,t.Table)||(0,r.is)(e,s.View)?e:new s.Param(e,n)}let a=(e,t)=>s.sql`${e} = ${o(t,e)}`,l=(e,t)=>s.sql`${e} <> ${o(t,e)}`;function u(...e){let t=e.filter(e=>void 0!==e);if(0!==t.length)return new s.SQL(1===t.length?t:[new s.StringChunk("("),s.sql.join(t,new s.StringChunk(" and ")),new s.StringChunk(")")])}function c(...e){let t=e.filter(e=>void 0!==e);if(0!==t.length)return new s.SQL(1===t.length?t:[new s.StringChunk("("),s.sql.join(t,new s.StringChunk(" or ")),new s.StringChunk(")")])}function h(e){return s.sql`not ${e}`}let f=(e,t)=>s.sql`${e} > ${o(t,e)}`,d=(e,t)=>s.sql`${e} >= ${o(t,e)}`,p=(e,t)=>s.sql`${e} < ${o(t,e)}`,g=(e,t)=>s.sql`${e} <= ${o(t,e)}`;function m(e,t){return Array.isArray(t)?0===t.length?s.sql`false`:s.sql`${e} in ${t.map(t=>o(t,e))}`:s.sql`${e} in ${o(t,e)}`}function y(e,t){return Array.isArray(t)?0===t.length?s.sql`true`:s.sql`${e} not in ${t.map(t=>o(t,e))}`:s.sql`${e} not in ${o(t,e)}`}function b(e){return s.sql`${e} is null`}function w(e){return s.sql`${e} is not null`}function v(e){return s.sql`exists ${e}`}function S(e){return s.sql`not exists ${e}`}function x(e,t,i){return s.sql`${e} between ${o(t,e)} and ${o(i,e)}`}function C(e,t,i){return s.sql`${e} not between ${o(t,e)} and ${o(i,e)}`}function P(e,t){return s.sql`${e} like ${t}`}function T(e,t){return s.sql`${e} not like ${t}`}function E(e,t){return s.sql`${e} ilike ${t}`}function _(e,t){return s.sql`${e} not ilike ${t}`}function A(e){return s.sql`${e} asc`}function N(e){return s.sql`${e} desc`}e.s(["and",()=>u,"between",()=>x,"eq",()=>a,"exists",()=>v,"gt",()=>f,"gte",()=>d,"ilike",()=>E,"inArray",()=>m,"isNotNull",()=>w,"isNull",()=>b,"like",()=>P,"lt",()=>p,"lte",()=>g,"ne",()=>l,"not",()=>h,"notBetween",()=>C,"notExists",()=>S,"notIlike",()=>_,"notInArray",()=>y,"notLike",()=>T,"or",()=>c],75225),e.s(["asc",()=>A,"desc",()=>N],49129);class q{constructor(e,i,r){this.sourceTable=e,this.referencedTable=i,this.relationName=r,this.referencedTableName=i[t.Table.Symbol.Name]}static [r.entityKind]="Relation";referencedTableName;fieldName}class L{constructor(e,t){this.table=e,this.config=t}static [r.entityKind]="Relations"}class B extends q{constructor(e,t,i,r){super(e,t,i?.relationName),this.config=i,this.isNullable=r}static [r.entityKind]="One";withFieldName(e){let t=new B(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class I extends q{constructor(e,t,i){super(e,t,i?.relationName),this.config=i}static [r.entityKind]="Many";withFieldName(e){let t=new I(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function O(){return{and:u,between:x,eq:a,exists:v,gt:f,gte:d,ilike:E,inArray:m,isNull:b,isNotNull:w,like:P,lt:p,lte:g,ne:l,not:h,notBetween:C,notExists:S,notLike:T,notIlike:_,notInArray:y,or:c,sql:s.sql}}function k(){return{sql:s.sql,asc:A,desc:N}}function D(e,i){1===Object.keys(e).length&&"default"in e&&!(0,r.is)(e.default,t.Table)&&(e=e.default);let s={},o={},a={};for(let[l,u]of Object.entries(e))if((0,r.is)(u,t.Table)){let e=(0,t.getTableUniqueName)(u),i=o[e];for(let r of(s[e]=l,a[l]={tsName:l,dbName:u[t.Table.Symbol.Name],schema:u[t.Table.Symbol.Schema],columns:u[t.Table.Symbol.Columns],relations:i?.relations??{},primaryKey:i?.primaryKey??[]},Object.values(u[t.Table.Symbol.Columns])))r.primary&&a[l].primaryKey.push(r);let c=u[t.Table.Symbol.ExtraConfigBuilder]?.(u[t.Table.Symbol.ExtraConfigColumns]);if(c)for(let e of Object.values(c))(0,r.is)(e,n.PrimaryKeyBuilder)&&a[l].primaryKey.push(...e.columns)}else if((0,r.is)(u,L)){let e,r=(0,t.getTableUniqueName)(u.table),n=s[r];for(let[t,s]of Object.entries(u.config(i(u.table))))if(n){let i=a[n];i.relations[t]=s,e&&i.primaryKey.push(...e)}else r in o||(o[r]={relations:{},primaryKey:e}),o[r].relations[t]=s}return{tables:a,tableNamesMap:s}}function M(e,t){return new L(e,e=>Object.fromEntries(Object.entries(t(e)).map(([e,t])=>[e,t.withFieldName(e)])))}function R(e,i,n){if((0,r.is)(n,B)&&n.config)return{fields:n.config.fields,references:n.config.references};let s=i[(0,t.getTableUniqueName)(n.referencedTable)];if(!s)throw Error(`Table "${n.referencedTable[t.Table.Symbol.Name]}" not found in schema`);let o=e[s];if(!o)throw Error(`Table "${s}" not found in schema`);let a=n.sourceTable,l=i[(0,t.getTableUniqueName)(a)];if(!l)throw Error(`Table "${a[t.Table.Symbol.Name]}" not found in schema`);let u=[];for(let e of Object.values(o.relations))(n.relationName&&n!==e&&e.relationName===n.relationName||!n.relationName&&e.referencedTable===n.sourceTable)&&u.push(e);if(u.length>1)throw n.relationName?Error(`There are multiple relations with name "${n.relationName}" in table "${s}"`):Error(`There are multiple relations between "${s}" and "${n.sourceTable[t.Table.Symbol.Name]}". Please specify relation name`);if(u[0]&&(0,r.is)(u[0],B)&&u[0].config)return{fields:u[0].config.references,references:u[0].config.fields};throw Error(`There is not enough information to infer relation "${l}.${n.fieldName}"`)}function Q(e){return{one:function(t,i){return new B(e,t,i,i?.fields.reduce((e,t)=>e&&t.notNull,!0)??!1)},many:function(t,i){return new I(e,t,i)}}}e.s(["Many",()=>I,"One",()=>B,"createTableRelationsHelpers",()=>Q,"extractTablesRelationalConfig",()=>D,"getOperators",()=>O,"getOrderByOperators",()=>k,"mapRelationalRow",()=>function e(t,n,o,a,l=e=>e){let u={};for(let[c,h]of a.entries())if(h.isJson){let i=n.relations[h.tsKey],s=o[c],a="string"==typeof s?JSON.parse(s):s;u[h.tsKey]=(0,r.is)(i,B)?a&&e(t,t[h.relationTableTsKey],a,h.selection,l):a.map(i=>e(t,t[h.relationTableTsKey],i,h.selection,l))}else{let e,t=l(o[c]),n=h.field;e=(0,r.is)(n,i.Column)?n:(0,r.is)(n,s.SQL)?n.decoder:n.sql.decoder,u[h.tsKey]=null===t?null:e.mapFromDriverValue(t)}return u},"normalizeRelation",()=>R,"relations",()=>M],79822)},15428,11909,e=>{"use strict";var t=e.i(5672),i=e.i(22689),r=e.i(56325),n=e.i(44988),s=e.i(71783),o=e.i(4775),a=e.i(56923),l=e.i(1727),u=e.i(38257),c=e.i(48209),h=e.i(93486),f=e.i(3090),d=e.i(67751),p=e.i(94093),g=e.i(79822),m=e.i(75225),y=e.i(18899),b=e.i(92352),w=e.i(69e3),v=e.i(4313),S=e.i(88274),x=y;class C extends x.View{static [n.entityKind]="PgViewBase"}e.s(["PgViewBase",()=>C],11909);class P{static [n.entityKind]="PgDialect";casing;constructor(e){this.casing=new i.CasingCache(e?.casing)}async migrate(e,t,i){let r="string"==typeof i?"__drizzle_migrations":i.migrationsTable??"__drizzle_migrations",n="string"==typeof i?"drizzle":i.migrationsSchema??"drizzle",s=y.sql`
			CREATE TABLE IF NOT EXISTS ${y.sql.identifier(n)}.${y.sql.identifier(r)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(y.sql`CREATE SCHEMA IF NOT EXISTS ${y.sql.identifier(n)}`),await t.execute(s);let o=(await t.all(y.sql`select id, hash, created_at from ${y.sql.identifier(n)}.${y.sql.identifier(r)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let i of e)if(!o||Number(o.created_at)<i.folderMillis){for(let e of i.sql)await t.execute(y.sql.raw(e));await t.execute(y.sql`insert into ${y.sql.identifier(n)}.${y.sql.identifier(r)} ("hash", "created_at") values(${i.hash}, ${i.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[y.sql`with `];for(let[i,r]of e.entries())t.push(y.sql`${y.sql.identifier(r._.alias)} as (${r._.sql})`),i<e.length-1&&t.push(y.sql`, `);return t.push(y.sql` `),y.sql.join(t)}buildDeleteQuery({table:e,where:t,returning:i,withList:r}){let n=this.buildWithCTE(r),s=i?y.sql` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,o=t?y.sql` where ${t}`:void 0;return y.sql`${n}delete from ${e}${o}${s}`}buildUpdateSet(e,t){let i=e[w.Table.Symbol.Columns],r=Object.keys(i).filter(e=>void 0!==t[e]||i[e]?.onUpdateFn!==void 0),s=r.length;return y.sql.join(r.flatMap((e,r)=>{let o=i[e],a=o.onUpdateFn?.(),l=t[e]??((0,n.is)(a,y.SQL)?a:y.sql.param(a,o)),u=y.sql`${y.sql.identifier(this.casing.getColumnCasing(o))} = ${l}`;return r<s-1?[u,y.sql.raw(", ")]:[u]}))}buildUpdateQuery({table:e,set:t,where:i,returning:r,withList:n,from:s,joins:o}){let a=this.buildWithCTE(n),l=e[p.PgTable.Symbol.Name],u=e[p.PgTable.Symbol.Schema],c=e[p.PgTable.Symbol.OriginalName],h=l===c?void 0:l,f=y.sql`${u?y.sql`${y.sql.identifier(u)}.`:void 0}${y.sql.identifier(c)}${h&&y.sql` ${y.sql.identifier(h)}`}`,d=this.buildUpdateSet(e,t),g=s&&y.sql.join([y.sql.raw(" from "),this.buildFromTable(s)]),m=this.buildJoins(o),b=r?y.sql` returning ${this.buildSelection(r,{isSingleTable:!s})}`:void 0,w=i?y.sql` where ${i}`:void 0;return y.sql`${a}update ${f} set ${d}${g}${m}${w}${b}`}buildSelection(e,{isSingleTable:t=!1}={}){let i=e.length,s=e.flatMap(({field:e},s)=>{let a=[];if((0,n.is)(e,y.SQL.Aliased)&&e.isSelectionField)a.push(y.sql.identifier(e.fieldAlias));else if((0,n.is)(e,y.SQL.Aliased)||(0,n.is)(e,y.SQL)){let i=(0,n.is)(e,y.SQL.Aliased)?e.sql:e;t?a.push(new y.SQL(i.queryChunks.map(e=>(0,n.is)(e,o.PgColumn)?y.sql.identifier(this.casing.getColumnCasing(e)):e))):a.push(i),(0,n.is)(e,y.SQL.Aliased)&&a.push(y.sql` as ${y.sql.identifier(e.fieldAlias)}`)}else if((0,n.is)(e,r.Column))t?a.push(y.sql.identifier(this.casing.getColumnCasing(e))):a.push(e);else if((0,n.is)(e,b.Subquery)){let t=Object.entries(e._.selectedFields);if(1===t.length){let i=t[0][1],s=(0,n.is)(i,y.SQL)?i.decoder:(0,n.is)(i,r.Column)?{mapFromDriverValue:e=>i.mapFromDriverValue(e)}:i.sql.decoder;s&&(e._.sql.decoder=s)}a.push(e)}return s<i-1&&a.push(y.sql`, `),a});return y.sql.join(s)}buildJoins(e){if(!e||0===e.length)return;let t=[];for(let[i,r]of e.entries()){0===i&&t.push(y.sql` `);let s=r.table,o=r.lateral?y.sql` lateral`:void 0,a=r.on?y.sql` on ${r.on}`:void 0;if((0,n.is)(s,p.PgTable)){let e=s[p.PgTable.Symbol.Name],i=s[p.PgTable.Symbol.Schema],n=s[p.PgTable.Symbol.OriginalName],l=e===n?void 0:r.alias;t.push(y.sql`${y.sql.raw(r.joinType)} join${o} ${i?y.sql`${y.sql.identifier(i)}.`:void 0}${y.sql.identifier(n)}${l&&y.sql` ${y.sql.identifier(l)}`}${a}`)}else if((0,n.is)(s,y.View)){let e=s[S.ViewBaseConfig].name,i=s[S.ViewBaseConfig].schema,n=s[S.ViewBaseConfig].originalName,l=e===n?void 0:r.alias;t.push(y.sql`${y.sql.raw(r.joinType)} join${o} ${i?y.sql`${y.sql.identifier(i)}.`:void 0}${y.sql.identifier(n)}${l&&y.sql` ${y.sql.identifier(l)}`}${a}`)}else t.push(y.sql`${y.sql.raw(r.joinType)} join${o} ${s}${a}`);i<e.length-1&&t.push(y.sql` `)}return y.sql.join(t)}buildFromTable(e){if((0,n.is)(e,w.Table)&&e[w.Table.Symbol.IsAlias]){let t=y.sql`${y.sql.identifier(e[w.Table.Symbol.OriginalName])}`;return e[w.Table.Symbol.Schema]&&(t=y.sql`${y.sql.identifier(e[w.Table.Symbol.Schema])}.${t}`),y.sql`${t} ${y.sql.identifier(e[w.Table.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:i,where:s,having:o,table:a,joins:l,orderBy:u,groupBy:c,limit:h,offset:f,lockingClause:d,distinct:p,setOperators:g}){let m,x,P,T=i??(0,v.orderSelectedFields)(t);for(let e of T){let t;if((0,n.is)(e.field,r.Column)&&(0,w.getTableName)(e.field.table)!==((0,n.is)(a,b.Subquery)?a._.alias:(0,n.is)(a,C)?a[S.ViewBaseConfig].name:(0,n.is)(a,y.SQL)?void 0:(0,w.getTableName)(a))&&(t=e.field.table,!l?.some(({alias:e})=>e===(t[w.Table.Symbol.IsAlias]?(0,w.getTableName)(t):t[w.Table.Symbol.BaseName])))){let t=(0,w.getTableName)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let E=!l||0===l.length,_=this.buildWithCTE(e);p&&(m=!0===p?y.sql` distinct`:y.sql` distinct on (${y.sql.join(p.on,y.sql`, `)})`);let A=this.buildSelection(T,{isSingleTable:E}),N=this.buildFromTable(a),q=this.buildJoins(l),L=s?y.sql` where ${s}`:void 0,B=o?y.sql` having ${o}`:void 0;u&&u.length>0&&(x=y.sql` order by ${y.sql.join(u,y.sql`, `)}`),c&&c.length>0&&(P=y.sql` group by ${y.sql.join(c,y.sql`, `)}`);let I="object"==typeof h||"number"==typeof h&&h>=0?y.sql` limit ${h}`:void 0,O=f?y.sql` offset ${f}`:void 0,k=y.sql.empty();if(d){let e=y.sql` for ${y.sql.raw(d.strength)}`;d.config.of&&e.append(y.sql` of ${y.sql.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],y.sql`, `)}`),d.config.noWait?e.append(y.sql` nowait`):d.config.skipLocked&&e.append(y.sql` skip locked`),k.append(e)}let D=y.sql`${_}select${m} ${A} from ${N}${q}${L}${P}${B}${x}${I}${O}${k}`;return g.length>0?this.buildSetOperations(D,g):D}buildSetOperations(e,t){let[i,...r]=t;if(!i)throw Error("Cannot pass undefined values to any set operator");return 0===r.length?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),r)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:i,rightSelect:r,limit:s,orderBy:a,offset:l}}){let u,c=y.sql`(${e.getSQL()}) `,h=y.sql`(${r.getSQL()})`;if(a&&a.length>0){let e=[];for(let t of a)if((0,n.is)(t,o.PgColumn))e.push(y.sql.identifier(t.name));else if((0,n.is)(t,y.SQL)){for(let e=0;e<t.queryChunks.length;e++){let i=t.queryChunks[e];(0,n.is)(i,o.PgColumn)&&(t.queryChunks[e]=y.sql.identifier(i.name))}e.push(y.sql`${t}`)}else e.push(y.sql`${t}`);u=y.sql` order by ${y.sql.join(e,y.sql`, `)} `}let f="object"==typeof s||"number"==typeof s&&s>=0?y.sql` limit ${s}`:void 0,d=y.sql.raw(`${t} ${i?"all ":""}`),p=l?y.sql` offset ${l}`:void 0;return y.sql`${c}${d}${h}${u}${f}${p}`}buildInsertQuery({table:e,values:t,onConflict:i,returning:r,withList:s,select:o,overridingSystemValue_:a}){let l=[],u=Object.entries(e[w.Table.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),c=u.map(([,e])=>y.sql.identifier(this.casing.getColumnCasing(e)));if(o)(0,n.is)(t,y.SQL)?l.push(t):l.push(t.getSQL());else for(let[e,i]of(l.push(y.sql.raw("values ")),t.entries())){let r=[];for(let[e,t]of u){let s=i[e];if(void 0===s||(0,n.is)(s,y.Param)&&void 0===s.value)if(void 0!==t.defaultFn){let e=t.defaultFn(),i=(0,n.is)(e,y.SQL)?e:y.sql.param(e,t);r.push(i)}else if(t.default||void 0===t.onUpdateFn)r.push(y.sql`default`);else{let e=t.onUpdateFn(),i=(0,n.is)(e,y.SQL)?e:y.sql.param(e,t);r.push(i)}else r.push(s)}l.push(r),e<t.length-1&&l.push(y.sql`, `)}let h=this.buildWithCTE(s),f=y.sql.join(l),d=r?y.sql` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,p=i?y.sql` on conflict ${i}`:void 0,g=!0===a?y.sql`overriding system value `:void 0;return y.sql`${h}insert into ${e} ${c} ${g}${f}${p}${d}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:i}){let r=t?y.sql` concurrently`:void 0,n=i?y.sql` with no data`:void 0;return y.sql`refresh materialized view${r} ${e}${n}`}prepareTyping(e){if((0,n.is)(e,u.PgJsonb)||(0,n.is)(e,l.PgJson))return"json";if((0,n.is)(e,c.PgNumeric))return"decimal";if((0,n.is)(e,h.PgTime))return"time";if((0,n.is)(e,f.PgTimestamp)||(0,n.is)(e,f.PgTimestampString))return"timestamp";if((0,n.is)(e,a.PgDate)||(0,n.is)(e,a.PgDateString))return"date";else if((0,n.is)(e,d.PgUUID))return"uuid";else return"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:i,tableNamesMap:o,table:a,tableConfig:l,queryConfig:u,tableAlias:c,nestedQueryRelation:h,joinOn:f}){let d,v=[],S,x,C=[],P,T=[];if(!0===u)v=Object.entries(l.columns).map(([e,i])=>({dbKey:i.name,tsKey:e,field:(0,t.aliasedTableColumn)(i,c),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let s=Object.fromEntries(Object.entries(l.columns).map(([e,i])=>[e,(0,t.aliasedTableColumn)(i,c)]));if(u.where){let e="function"==typeof u.where?u.where(s,(0,g.getOperators)()):u.where;P=e&&(0,t.mapColumnsInSQLToAlias)(e,c)}let a=[],h=[];if(u.columns){let e=!1;for(let[t,i]of Object.entries(u.columns))void 0!==i&&t in l.columns&&(e||!0!==i||(e=!0),h.push(t));h.length>0&&(h=e?h.filter(e=>u.columns?.[e]===!0):Object.keys(l.columns).filter(e=>!h.includes(e)))}else h=Object.keys(l.columns);for(let e of h){let t=l.columns[e];a.push({tsKey:e,value:t})}let f=[];if(u.with&&(f=Object.entries(u.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:l.relations[e]}))),u.extras)for(let[e,i]of Object.entries("function"==typeof u.extras?u.extras(s,{sql:y.sql}):u.extras))a.push({tsKey:e,value:(0,t.mapColumnsInAliasedSQLToAlias)(i,c)});for(let{tsKey:e,value:i}of a)v.push({dbKey:(0,n.is)(i,y.SQL.Aliased)?i.fieldAlias:l.columns[e].name,tsKey:e,field:(0,n.is)(i,r.Column)?(0,t.aliasedTableColumn)(i,c):i,relationTableTsKey:void 0,isJson:!1,selection:[]});let d="function"==typeof u.orderBy?u.orderBy(s,(0,g.getOrderByOperators)()):u.orderBy??[];for(let{tsKey:s,queryConfig:a,relation:l}of(Array.isArray(d)||(d=[d]),C=d.map(e=>(0,n.is)(e,r.Column)?(0,t.aliasedTableColumn)(e,c):(0,t.mapColumnsInSQLToAlias)(e,c)),S=u.limit,x=u.offset,f)){let r=(0,g.normalizeRelation)(i,o,l),u=o[(0,w.getTableUniqueName)(l.referencedTable)],h=`${c}_${s}`,f=(0,m.and)(...r.fields.map((e,i)=>(0,m.eq)((0,t.aliasedTableColumn)(r.references[i],h),(0,t.aliasedTableColumn)(e,c)))),d=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:i,tableNamesMap:o,table:e[u],tableConfig:i[u],queryConfig:(0,n.is)(l,g.One)?!0===a?{limit:1}:{...a,limit:1}:a,tableAlias:h,joinOn:f,nestedQueryRelation:l}),p=y.sql`${y.sql.identifier(h)}.${y.sql.identifier("data")}`.as(s);T.push({on:y.sql`true`,table:new b.Subquery(d.sql,{},h),alias:h,joinType:"left",lateral:!0}),v.push({dbKey:s,tsKey:s,field:p,relationTableTsKey:u,isJson:!0,selection:d.selection})}}if(0===v.length)throw new s.DrizzleError({message:`No fields selected for table "${l.tsName}" ("${c}")`});if(P=(0,m.and)(f,P),h){let e=y.sql`json_build_array(${y.sql.join(v.map(({field:e,tsKey:t,isJson:i})=>i?y.sql`${y.sql.identifier(`${c}_${t}`)}.${y.sql.identifier("data")}`:(0,n.is)(e,y.SQL.Aliased)?e.sql:e),y.sql`, `)})`;(0,n.is)(h,g.Many)&&(e=y.sql`coalesce(json_agg(${e}${C.length>0?y.sql` order by ${y.sql.join(C,y.sql`, `)}`:void 0}), '[]'::json)`);let i=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:l.tsName,selection:v}];void 0!==S||void 0!==x||C.length>0?(d=this.buildSelectQuery({table:(0,t.aliasedTable)(a,c),fields:{},fieldsFlat:[{path:[],field:y.sql.raw("*")}],where:P,limit:S,offset:x,orderBy:C,setOperators:[]}),P=void 0,S=void 0,x=void 0,C=[]):d=(0,t.aliasedTable)(a,c),d=this.buildSelectQuery({table:(0,n.is)(d,p.PgTable)?d:new b.Subquery(d,{},c),fields:{},fieldsFlat:i.map(({field:e})=>({path:[],field:(0,n.is)(e,r.Column)?(0,t.aliasedTableColumn)(e,c):e})),joins:T,where:P,limit:S,offset:x,orderBy:C,setOperators:[]})}else d=this.buildSelectQuery({table:(0,t.aliasedTable)(a,c),fields:{},fieldsFlat:v.map(({field:e})=>({path:[],field:(0,n.is)(e,r.Column)?(0,t.aliasedTableColumn)(e,c):e})),joins:T,where:P,limit:S,offset:x,orderBy:C,setOperators:[]});return{tableTsKey:l.tsName,sql:d,selection:v}}}e.s(["PgDialect",()=>P],15428)},57235,e=>{"use strict";var t=e.i(44988);class i{static [t.entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}e.s(["TypedQueryBuilder",()=>i])},44482,e=>{"use strict";var t=e.i(44988),i=e.i(98020),r=e.i(47211),n=e.i(69e3),s=e.i(22360),o=e.i(4313),a=e.i(94093),l=e.i(18899),u=e.i(92352),c=e.i(88274);e.i(58081),e.i(63411),e.i(20776),e.i(48211),e.i(44902),e.i(43233);var h=e.i(71896),f=e.i(15428),d=e.i(11909),p=e.i(57235);class g{static [t.entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let i,r=!!this.fields;return i=this.fields?this.fields:(0,t.is)(e,u.Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,t.is)(e,d.PgViewBase)?e[c.ViewBaseConfig].selectedFields:(0,t.is)(e,l.SQL)?{}:(0,o.getTableColumns)(e),new y({table:e,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class m extends p.TypedQueryBuilder{static [t.entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:i,session:r,dialect:n,withList:s,distinct:a}){for(const l of(super(),this.config={withList:s,table:e,fields:{...t},distinct:a,setOperators:[]},this.isPartialSelect=i,this.session=r,this.dialect=n,this._={selectedFields:t,config:this.config},this.tableName=(0,o.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},M(e)))this.usedTables.add(l)}getUsedTables(){return[...this.usedTables]}createJoin(e,i){return(s,a)=>{let h=this.tableName,f=(0,o.getTableLikeName)(s);for(let e of M(s))this.usedTables.add(e);if("string"==typeof f&&this.config.joins?.some(e=>e.alias===f))throw Error(`Alias "${f}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof h&&(this.config.fields={[h]:this.config.fields}),"string"==typeof f&&!(0,t.is)(s,l.SQL))){let e=(0,t.is)(s,u.Subquery)?s._.selectedFields:(0,t.is)(s,l.View)?s[c.ViewBaseConfig].selectedFields:s[n.Table.Symbol.Columns];this.config.fields[f]=e}if("function"==typeof a&&(a=a(new Proxy(this.config.fields,new r.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:a,table:s,joinType:e,alias:f,lateral:i}),"string"==typeof f)switch(e){case"left":this.joinsNotNullableMap[f]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[f]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[f]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[f]=!1}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(e,t){return i=>{let r="function"==typeof i?i(w()):i;if(!(0,o.haveSameKeys)(this.getSelectedFields(),r.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:r}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new r.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new r.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new r.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new r.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){let t=[];if(t.push(...M(this.config.table)),this.config.joins)for(let e of this.config.joins)t.push(...M(e.table));return new Proxy(new u.Subquery(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new r.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new r.SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(e){return this.cacheConfig=void 0===e?{config:{},enable:!0,autoInvalidate:!0}:!1===e?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}}class y extends m{static [t.entityKind]="PgSelect";_prepare(e){let{session:t,config:i,dialect:r,joinsNotNullableMap:n,authToken:a,cacheConfig:l,usedTables:u}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let{fields:c}=i;return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let i=(0,o.orderSelectedFields)(c),s=t.prepareQuery(r.sqlToQuery(this.getSQL()),i,e,!0,void 0,{type:"select",tables:[...u]},l);return s.joinsNotNullableMap=n,s.setToken(a)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}function b(e,t){return(i,r,...n)=>{let s=[r,...n].map(i=>({type:e,isAll:t,rightSelect:i}));for(let e of s)if(!(0,o.haveSameKeys)(i.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return i.addSetOperators(s)}}(0,o.applyMixins)(y,[i.QueryPromise]);let w=()=>({union:v,unionAll:S,intersect:x,intersectAll:C,except:P,exceptAll:T}),v=b("union",!1),S=b("union",!0),x=b("intersect",!1),C=b("intersect",!0),P=b("except",!1),T=b("except",!0);class E{static [t.entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,t.is)(e,f.PgDialect)?e:void 0,this.dialectConfig=(0,t.is)(e,f.PgDialect)?void 0:e}$with=(e,t)=>{let i=this;return{as:n=>("function"==typeof n&&(n=n(i)),new Proxy(new u.WithSubquery(n.getSQL(),t??("getSelectedFields"in n?n.getSelectedFields()??{}:{}),e,!0),new r.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;return{select:function(i){return new g({fields:i??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new g({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,i){return new g({fields:i??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new g({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new g({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new g({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new f.PgDialect(this.dialectConfig)),this.dialect}}var _=d;class A{constructor(e,t){this.name=e,this.schema=t}static [t.entityKind]="PgDefaultViewBuilderCore";config={};with(e){return this.config.with=e,this}}class N extends A{static [t.entityKind]="PgViewBuilder";as(e){"function"==typeof e&&(e=e(new E));let t=new r.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),i=new Proxy(e.getSelectedFields(),t);return new Proxy(new O({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:i,query:e.getSQL().inlineParams()}}),t)}}class q extends A{static [t.entityKind]="PgManualViewBuilder";columns;constructor(e,t,i){super(e,i),this.columns=(0,o.getTableColumns)((0,a.pgTable)(e,t))}existing(){return new Proxy(new O({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new r.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new O({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new r.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class L{constructor(e,t){this.name=e,this.schema=t}static [t.entityKind]="PgMaterializedViewBuilderCore";config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}}class B extends L{static [t.entityKind]="PgMaterializedViewBuilder";as(e){"function"==typeof e&&(e=e(new E));let t=new r.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),i=new Proxy(e.getSelectedFields(),t);return new Proxy(new D({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:i,query:e.getSQL().inlineParams()}}),t)}}class I extends L{static [t.entityKind]="PgManualMaterializedViewBuilder";columns;constructor(e,t,i){super(e,i),this.columns=(0,o.getTableColumns)((0,a.pgTable)(e,t))}existing(){return new Proxy(new D({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new r.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new D({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new r.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class O extends _.PgViewBase{static [t.entityKind]="PgView";[h.PgViewConfig];constructor({pgConfig:e,config:t}){super(t),e&&(this[h.PgViewConfig]={with:e.with})}}let k=Symbol.for("drizzle:PgMaterializedViewConfig");class D extends _.PgViewBase{static [t.entityKind]="PgMaterializedView";[k];constructor({pgConfig:e,config:t}){super(t),this[k]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}}function M(e){return(0,t.is)(e,a.PgTable)?[e[n.Schema]?`${e[n.Schema]}.${e[n.Table.Symbol.BaseName]}`:e[n.Table.Symbol.BaseName]]:(0,t.is)(e,u.Subquery)?e._.usedTables??[]:(0,t.is)(e,l.SQL)?e.usedTables??[]:[]}class R extends i.QueryPromise{constructor(e,t,i,r){super(),this.session=t,this.dialect=i,this.config={table:e,withList:r}}static [t.entityKind]="PgDelete";config;cacheConfig;where(e){return this.config.where=e,this}returning(e=this.config.table[n.Table.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=(0,o.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"delete",tables:M(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new r.SelectionProxyHandler({alias:(0,n.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var Q=i;class ${constructor(e,t,i,r,n){this.table=e,this.session=t,this.dialect=i,this.withList=r,this.overridingSystemValue_=n}static [t.entityKind]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let i=e.map(e=>{let i={},r=this.table[n.Table.Symbol.Columns];for(let n of Object.keys(e)){let s=e[n];i[n]=(0,t.is)(s,l.SQL)?s:new l.Param(s,r[n])}return i});return new F(this.table,i,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let i="function"==typeof e?e(new E):e;if(!(0,t.is)(i,l.SQL)&&!(0,o.haveSameKeys)(this.table[n.Columns],i._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new F(this.table,i,this.session,this.dialect,this.withList,!0)}}class F extends Q.QueryPromise{constructor(e,t,i,r,n,s,o){super(),this.session=i,this.dialect=r,this.config={table:e,values:t,withList:n,select:s,overridingSystemValue_:o}}static [t.entityKind]="PgInsert";config;cacheConfig;returning(e=this.config.table[n.Table.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=(0,o.orderSelectedFields)(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=l.sql`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?l.sql` where ${e.where}`:void 0;this.config.onConflict=l.sql`(${l.sql.raw(t)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?l.sql` where ${e.where}`:void 0,i=e.targetWhere?l.sql` where ${e.targetWhere}`:void 0,r=e.setWhere?l.sql` where ${e.setWhere}`:void 0,n=this.dialect.buildUpdateSet(this.config.table,(0,o.mapUpdateSet)(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=l.sql`(${l.sql.raw(s)})${i} do update set ${n}${t}${r}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:M(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new r.SelectionProxyHandler({alias:(0,n.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var U=i;class j{constructor(e,t,i,r){this.table=e,this.session=t,this.dialect=i,this.withList=r}static [t.entityKind]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new K(this.table,(0,o.mapUpdateSet)(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}}class K extends U.QueryPromise{constructor(e,t,i,r,n){super(),this.session=i,this.dialect=r,this.config={set:t,table:e,withList:n,joins:[]},this.tableName=(0,o.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [t.entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;cacheConfig;from(e){let t=(0,o.getTableLikeName)(e);return"string"==typeof t&&(this.joinsNotNullableMap[t]=!0),this.config.from=e,this}getTableLikeFields(e){return(0,t.is)(e,a.PgTable)?e[n.Table.Symbol.Columns]:(0,t.is)(e,u.Subquery)?e._.selectedFields:e[c.ViewBaseConfig].selectedFields}createJoin(e){return(i,s)=>{let a=(0,o.getTableLikeName)(i);if("string"==typeof a&&this.config.joins.some(e=>e.alias===a))throw Error(`Alias "${a}" is already used in this query`);if("function"==typeof s){let e=this.config.from&&!(0,t.is)(this.config.from,l.SQL)?this.getTableLikeFields(this.config.from):void 0;s=s(new Proxy(this.config.table[n.Table.Symbol.Columns],new r.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),e&&new Proxy(e,new r.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:s,table:i,joinType:e,alias:a}),"string"==typeof a)switch(e){case"left":this.joinsNotNullableMap[a]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[a]=!0;break;case"inner":this.joinsNotNullableMap[a]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[a]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[n.Table.Symbol.Columns]),this.config.from)){let i=(0,o.getTableLikeName)(this.config.from);if("string"==typeof i&&this.config.from&&!(0,t.is)(this.config.from,l.SQL)){let t=this.getTableLikeFields(this.config.from);e[i]=t}for(let i of this.config.joins){let r=(0,o.getTableLikeName)(i.table);if("string"==typeof r&&!(0,t.is)(i.table,l.SQL)){let t=this.getTableLikeFields(i.table);e[r]=t}}}return this.config.returningFields=e,this.config.returning=(0,o.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:M(this.config.table)},this.cacheConfig);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new r.SelectionProxyHandler({alias:(0,n.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var z=l;class V extends z.SQL{constructor(e){super(V.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=V.buildCount(e.source,e.filters)}sql;token;static [t.entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return z.sql`(select count(*) from ${e}${z.sql.raw(" where ").if(t)}${t})`}static buildCount(e,t){return z.sql`select count(*) as count from ${e}${z.sql.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}var W=i,H=e.i(79822);class G{constructor(e,t,i,r,n,s,o){this.fullSchema=e,this.schema=t,this.tableNamesMap=i,this.table=r,this.tableConfig=n,this.dialect=s,this.session=o}static [t.entityKind]="PgRelationalQueryBuilder";findMany(e){return new J(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new J(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class J extends W.QueryPromise{constructor(e,t,i,r,n,s,o,a,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=i,this.table=r,this.tableConfig=n,this.dialect=s,this.session=o,this.config=a,this.mode=l}static [t.entityKind]="PgRelationalQuery";_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(e,i)=>{let r=e.map(e=>(0,H.mapRelationalRow)(this.schema,this.tableConfig,e,t.selection,i));return"first"===this.mode?r[0]:r})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}var Y=i;class Z extends Y.QueryPromise{constructor(e,t,i,r){super(),this.execute=e,this.sql=t,this.query=i,this.mapBatchResult=r}static [t.entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}var X=i;class ee extends X.QueryPromise{constructor(e,t,i){super(),this.session=t,this.dialect=i,this.config={view:e}}static [t.entityKind]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}class et{constructor(e,t,i){if(this.dialect=e,this.session=t,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(const[r,n]of Object.entries(this._.schema))this.query[r]=new G(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[r],n,e,t);this.$cache={invalidate:async e=>{}}}static [t.entityKind]="PgDatabase";query;$with=(e,t)=>{let i=this;return{as:n=>("function"==typeof n&&(n=n(new E(i.dialect))),new Proxy(new u.WithSubquery(n.getSQL(),t??("getSelectedFields"in n?n.getSelectedFields()??{}:{}),e,!0),new r.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new V({source:e,filters:t,session:this.session})}$cache;with(...e){let t=this;return{select:function(i){return new g({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(i){return new g({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(i,r){return new g({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:i}})},update:function(i){return new j(i,t.session,t.dialect,e)},insert:function(i){return new $(i,t.session,t.dialect,e)},delete:function(i){return new R(i,t.session,t.dialect,e)}}}select(e){return new g({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new g({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new g({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new j(e,this.session,this.dialect)}insert(e){return new $(e,this.session,this.dialect)}delete(e){return new R(e,this.session,this.dialect)}refreshMaterializedView(e){return new ee(e,this.session,this.dialect)}authToken;execute(e){let t="string"==typeof e?l.sql.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(t),r=this.session.prepareQuery(i,void 0,void 0,!1);return new Z(()=>r.execute(void 0,this.authToken),t,i,e=>r.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}e.s(["PgDatabase",()=>et],44482)},42389,18916,e=>{"use strict";var t=e.i(98323),i=e.i(44988),r=e.i(7932),n=e.i(44482),s=e.i(15428),o=e.i(79822),a=e.i(4313);class l{static [i.entityKind]="Cache"}class u extends l{strategy(){return"all"}static [i.entityKind]="NoopCache";async get(e){}async put(e,t,i,r){}async onMutate(e){}}async function c(e,t){let i=`${e}-${JSON.stringify(t)}`,r=new TextEncoder().encode(i);return[...new Uint8Array(await crypto.subtle.digest("SHA-256",r))].map(e=>e.toString(16).padStart(2,"0")).join("")}var h=e.i(71783),f=e.i(18899),d=e.i(22360),p=n;class g{constructor(e,t,i,r){this.query=e,this.cache=t,this.queryMetadata=i,this.cacheConfig=r,t&&"all"===t.strategy()&&void 0===r&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static [i.entityKind]="PgPreparedQuery";joinsNotNullableMap;async queryWithCache(e,t,r){if(void 0===this.cache||(0,i.is)(this.cache,u)||void 0===this.queryMetadata||this.cacheConfig&&!this.cacheConfig.enable)try{return await r()}catch(i){throw new h.DrizzleQueryError(e,t,i)}if(("insert"===this.queryMetadata.type||"update"===this.queryMetadata.type||"delete"===this.queryMetadata.type)&&this.queryMetadata.tables.length>0)try{let[e]=await Promise.all([r(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return e}catch(i){throw new h.DrizzleQueryError(e,t,i)}if(!this.cacheConfig)try{return await r()}catch(i){throw new h.DrizzleQueryError(e,t,i)}if("select"===this.queryMetadata.type){let i=await this.cache.get(this.cacheConfig.tag??await c(e,t),this.queryMetadata.tables,void 0!==this.cacheConfig.tag,this.cacheConfig.autoInvalidate);if(void 0===i){let i;try{i=await r()}catch(i){throw new h.DrizzleQueryError(e,t,i)}return await this.cache.put(this.cacheConfig.tag??await c(e,t),i,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],void 0!==this.cacheConfig.tag,this.cacheConfig.config),i}return i}try{return await r()}catch(i){throw new h.DrizzleQueryError(e,t,i)}}}class m{constructor(e){this.dialect=e}static [i.entityKind]="PgSession";execute(e,t){return d.tracer.startActiveSpan("drizzle.operation",()=>d.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){return Number((await this.execute(e,t))[0].count)}}class y extends p.PgDatabase{constructor(e,t,i,r=0){super(e,t,i),this.schema=i,this.nestedIndex=r}static [i.entityKind]="PgTransaction";rollback(){throw new h.TransactionRollbackError}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),f.sql.raw(t.join(" "))}setTransaction(e){return this.session.execute(f.sql`set transaction ${this.getTransactionConfigSQL(e)}`)}}let b={arrayMode:!1,fullResults:!0},w={arrayMode:!0,fullResults:!0};class v extends g{constructor(e,t,i,r,n,s,o,a,l){super(t,r,n,s),this.client=e,this.logger=i,this.fields=o,this._isResponseInArrayMode=a,this.customResultMapper=l,this.clientQuery=e.query??e}static [i.entityKind]="NeonHttpPreparedQuery";clientQuery;async execute(e={},t=this.authToken){let i=(0,f.fillPlaceholders)(this.query.params,e);this.logger.logQuery(this.query.sql,i);let{fields:r,clientQuery:n,query:s,customResultMapper:o}=this;if(!r&&!o)return this.queryWithCache(s.sql,i,async()=>n(s.sql,i,void 0===t?b:{...b,authToken:t}));let a=await this.queryWithCache(s.sql,i,async()=>await n(s.sql,i,void 0===t?w:{...w,authToken:t}));return this.mapResult(a)}mapResult(e){if(!this.fields&&!this.customResultMapper)return e;let t=e.rows;return this.customResultMapper?this.customResultMapper(t):t.map(e=>(0,a.mapResultRow)(this.fields,e,this.joinsNotNullableMap))}all(e={}){let t=(0,f.fillPlaceholders)(this.query.params,e);return this.logger.logQuery(this.query.sql,t),this.clientQuery(this.query.sql,t,void 0===this.authToken?b:{...b,authToken:this.authToken}).then(e=>e.rows)}values(e={},t){let i=(0,f.fillPlaceholders)(this.query.params,e);return this.logger.logQuery(this.query.sql,i),this.clientQuery(this.query.sql,i,{arrayMode:!0,fullResults:!0,authToken:t}).then(e=>e.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}class S extends m{constructor(e,t,i,n={}){super(t),this.client=e,this.schema=i,this.options=n,this.clientQuery=e.query??e,this.logger=n.logger??new r.NoopLogger,this.cache=n.cache??new u}static [i.entityKind]="NeonHttpSession";clientQuery;logger;cache;prepareQuery(e,t,i,r,n,s,o){return new v(this.client,e,this.logger,this.cache,s,o,t,r,n)}async batch(e){let t=[],i=[];for(let r of e){let e=r._prepare(),n=e.getQuery();t.push(e),i.push(this.clientQuery(n.sql,n.params,{fullResults:!0,arrayMode:e.isResponseInArrayMode()}))}return(await this.client.transaction(i,w)).map((e,i)=>t[i].mapResult(e,!0))}async query(e,t){return this.logger.logQuery(e,t),await this.clientQuery(e,t,{arrayMode:!0,fullResults:!0})}async queryObjects(e,t){return this.clientQuery(e,t,{arrayMode:!1,fullResults:!0})}async count(e,t){return Number((await this.execute(e,t)).rows[0].count)}async transaction(e,t={}){throw Error("No transactions support in neon-http driver")}}class x extends y{static [i.entityKind]="NeonHttpTransaction";async transaction(e){throw Error("No transactions support in neon-http driver")}}class C{constructor(e,t,i={}){this.client=e,this.dialect=t,this.options=i,this.initMappers()}static [i.entityKind]="NeonHttpDriver";createSession(e){return new S(this.client,this.dialect,e,{logger:this.options.logger,cache:this.options.cache})}initMappers(){t.types.setTypeParser(t.types.builtins.TIMESTAMPTZ,e=>e),t.types.setTypeParser(t.types.builtins.TIMESTAMP,e=>e),t.types.setTypeParser(t.types.builtins.DATE,e=>e),t.types.setTypeParser(t.types.builtins.INTERVAL,e=>e),t.types.setTypeParser(1231,e=>e),t.types.setTypeParser(1115,e=>e),t.types.setTypeParser(1185,e=>e),t.types.setTypeParser(1187,e=>e),t.types.setTypeParser(1182,e=>e)}}function P(e,t,i,r){return new Proxy(e,{get(e,n){let s=e[n];return"function"!=typeof s&&("object"!=typeof s||null===s)?s:r?P(s,t,i):"query"===n?P(s,t,i,!0):new Proxy(s,{apply(e,r,s){let o=e.call(r,...s);return"object"==typeof o&&null!==o&&"setToken"in o&&"function"==typeof o.setToken&&o.setToken(t),i(e,n,o)}})}})}class T extends n.PgDatabase{static [i.entityKind]="NeonHttpDatabase";$withAuth(e){return this.authToken=e,P(this,e,(t,i,r)=>"with"===i?P(r,e,(e,t,i)=>i):r)}async batch(e){return this.session.batch(e)}}function E(e,t={}){let i,n,a=new s.PgDialect({casing:t.casing});if(!0===t.logger?i=new r.DefaultLogger:!1!==t.logger&&(i=t.logger),t.schema){let e=(0,o.extractTablesRelationalConfig)(t.schema,o.createTableRelationsHelpers);n={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let l=new C(e,a,{logger:i,cache:t.cache}).createSession(n),u=new T(a,l,n);return u.$client=e,u.$cache=t.cache,u.$cache&&(u.$cache.invalidate=t.cache?.onMutate),u}function _(...e){if("string"==typeof e[0])return E((0,t.neon)(e[0]),e[1]);if((0,a.isConfig)(e[0])){let{connection:i,client:r,...n}=e[0];if(r)return E(r,n);if("object"==typeof i){let{connectionString:e,...r}=i;return E((0,t.neon)(e,r),n)}return E((0,t.neon)(i),n)}return E(e[0],e[1])}(_||(_={})).mock=function(e){return E({},e)};var A=e.i(94093),N=e.i(84259),q=e.i(3090),L=e.i(2847),B=e.i(70988),I=e.i(48209),O=e.i(44902);let k=BigInt(0x100000000-1),D=BigInt(32);function M(e,t=""){if(!Number.isSafeInteger(e)||e<0){let i=t&&`"${t}" `;throw Error(`${i}expected integer >= 0, got ${e}`)}}function R(e,t,i=""){let r=e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name,n=e?.length,s=void 0!==t;if(!r||s&&n!==t)throw Error((i&&`"${i}" `)+"expected Uint8Array"+(s?` of length ${t}`:"")+", got "+(r?`length=${n}`:`type=${typeof e}`));return e}function Q(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function $(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let F=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0]?e=>e:function(e){for(let i=0;i<e.length;i++){var t;e[i]=(t=e[i])<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255}return e},U=BigInt(0),j=BigInt(1),K=BigInt(2),z=BigInt(7),V=BigInt(256),W=BigInt(113),H=[],G=[],J=[];for(let e=0,t=j,i=1,r=0;e<24;e++){[i,r]=[r,(2*i+3*r)%5],H.push(2*(5*r+i)),G.push((e+1)*(e+2)/2%64);let n=U;for(let e=0;e<7;e++)(t=(t<<j^(t>>z)*W)%V)&K&&(n^=j<<(j<<BigInt(e))-j);J.push(n)}let Y=function(e,t=!1){let i=e.length,r=new Uint32Array(i),n=new Uint32Array(i);for(let s=0;s<i;s++){let{h:i,l:o}=function(e,t=!1){return t?{h:Number(e&k),l:Number(e>>D&k)}:{h:0|Number(e>>D&k),l:0|Number(e&k)}}(e[s],t);[r[s],n[s]]=[i,o]}return[r,n]}(J,!0),Z=Y[0],X=Y[1],ee=(e,t,i)=>i>32?t<<i-32|e>>>64-i:e<<i|t>>>32-i,et=(e,t,i)=>i>32?e<<i-32|t>>>64-i:t<<i|e>>>32-i;class ei{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(e,t,i,r=!1,n=24){if(this.blockLen=e,this.suffix=t,this.outputLen=i,this.enableXOF=r,this.rounds=n,M(i,"outputLen"),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(this.state)}clone(){return this._cloneInto()}keccak(){F(this.state32),function(e,t=24){let i=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let t=0;t<10;t++)i[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let r=(t+8)%10,n=(t+2)%10,s=i[n],o=i[n+1],a=ee(s,o,1)^i[r],l=et(s,o,1)^i[r+1];for(let i=0;i<50;i+=10)e[t+i]^=a,e[t+i+1]^=l}let t=e[2],n=e[3];for(let i=0;i<24;i++){let r=G[i],s=ee(t,n,r),o=et(t,n,r),a=H[i];t=e[a],n=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let r=0;r<10;r++)i[r]=e[t+r];for(let r=0;r<10;r++)e[t+r]^=~i[(r+2)%10]&i[(r+4)%10]}e[0]^=Z[r],e[1]^=X[r]}$(i)}(this.state32,this.rounds),F(this.state32),this.posOut=0,this.pos=0}update(e){Q(this),R(e);let{blockLen:t,state:i}=this,r=e.length;for(let n=0;n<r;){let s=Math.min(t-this.pos,r-n);for(let t=0;t<s;t++)i[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:i,blockLen:r}=this;e[i]^=t,(128&t)!=0&&i===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){Q(this,!1),R(e),this.finish();let t=this.state,{blockLen:i}=this;for(let r=0,n=e.length;r<n;){this.posOut>=i&&this.keccak();let s=Math.min(i-this.posOut,n-r);e.set(t.subarray(this.posOut,this.posOut+s),r),this.posOut+=s,r+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return M(e),this.xofInto(new Uint8Array(e))}digestInto(e){R(e,void 0,"digestInto() output");let t=this.outputLen;if(e.length<t)throw Error('"digestInto() output" expected to be of length >='+t);if(this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,$(this.state)}_cloneInto(e){let{blockLen:t,suffix:i,outputLen:r,rounds:n,enableXOF:s}=this;return(e||=new ei(t,i,r,s,n)).state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=i,e.outputLen=r,e.enableXOF=s,e.destroyed=this.destroyed,e}}let er=((e,t,i,r={})=>(function(e,t={}){let i=(t,i)=>e(i).update(t).digest(),r=e(void 0);return i.outputLen=r.outputLen,i.blockLen=r.blockLen,i.create=t=>e(t),Object.assign(i,t),Object.freeze(i)})(()=>new ei(t,e,i),r))(6,72,64,{oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,10])});var en=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,es=Math.ceil,eo=Math.floor,ea="[BigNumber Error] ",el=ea+"Number primitive has more than 15 significant digits: ",eu=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function ec(e){var t=0|e;return e>0||e===t?t:t-1}function eh(e){for(var t,i,r=1,n=e.length,s=e[0]+"";r<n;){for(i=14-(t=e[r++]+"").length;i--;t="0"+t);s+=t}for(n=s.length;48===s.charCodeAt(--n););return s.slice(0,n+1||1)}function ef(e,t){var i,r,n=e.c,s=t.c,o=e.s,a=t.s,l=e.e,u=t.e;if(!o||!a)return null;if(i=n&&!n[0],r=s&&!s[0],i||r)return i?r?0:-a:o;if(o!=a)return o;if(i=o<0,r=l==u,!n||!s)return r?0:!n^i?1:-1;if(!r)return l>u^i?1:-1;for(o=0,a=(l=n.length)<(u=s.length)?l:u;o<a;o++)if(n[o]!=s[o])return n[o]>s[o]^i?1:-1;return l==u?0:l>u^i?1:-1}function ed(e,t,i,r){if(e<t||e>i||e!==eo(e))throw Error(ea+(r||"Argument")+("number"==typeof e?e<t||e>i?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function ep(e){var t=e.c.length-1;return ec(e.e/14)==t&&e.c[t]%2!=0}function eg(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function em(e,t,i){var r,n;if(t<0){for(n=i+".";++t;n+=i);e=n+e}else if(r=e.length,++t>r){for(n=i,t-=r;--t;n+=i);e+=n}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}var ey=function e(t){var i,r,n,s,o,a,l,u,c,h=T.prototype={constructor:T,toString:null,valueOf:null},f=new T(1),d=20,p=4,g=-7,m=21,y=-1e7,b=1e7,w=!1,v=1,S=0,x={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},C="0123456789abcdefghijklmnopqrstuvwxyz",P=!0;function T(e,t){var i,r,n,s,o,a,l,h,f=this;if(!(f instanceof T))return new T(e,t);if(null==t){if(e&&!0===e._isBigNumber){f.s=e.s,!e.c||e.e>b?f.c=f.e=null:e.e<y?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice());return}if((a="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(s=0,o=e;o>=10;o/=10,s++);s>b?f.c=f.e=null:(f.e=s,f.c=[e]);return}h=String(e)}else{if(!en.test(h=String(e)))return c(f,h,a);f.s=45==h.charCodeAt(0)?(h=h.slice(1),-1):1}(s=h.indexOf("."))>-1&&(h=h.replace(".","")),(o=h.search(/e/i))>0?(s<0&&(s=o),s+=+h.slice(o+1),h=h.substring(0,o)):s<0&&(s=h.length)}else{if(ed(t,2,C.length,"Base"),10==t&&P)return N(f=new T(e),d+f.e+1,p);if(h=String(e),a="number"==typeof e){if(0*e!=0)return c(f,h,a,t);if(f.s=1/e<0?(h=h.slice(1),-1):1,T.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(el+e)}else f.s=45===h.charCodeAt(0)?(h=h.slice(1),-1):1;for(i=C.slice(0,t),s=o=0,l=h.length;o<l;o++)if(0>i.indexOf(r=h.charAt(o))){if("."==r){if(o>s){s=l;continue}}else if(!n&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){n=!0,o=-1,s=0;continue}return c(f,String(e),a,t)}a=!1,(s=(h=u(h,t,10,f.s)).indexOf("."))>-1?h=h.replace(".",""):s=h.length}for(o=0;48===h.charCodeAt(o);o++);for(l=h.length;48===h.charCodeAt(--l););if(h=h.slice(o,++l)){if(l-=o,a&&T.DEBUG&&l>15&&(e>0x1fffffffffffff||e!==eo(e)))throw Error(el+f.s*e);if((s=s-o-1)>b)f.c=f.e=null;else if(s<y)f.c=[f.e=0];else{if(f.e=s,f.c=[],o=(s+1)%14,s<0&&(o+=14),o<l){for(o&&f.c.push(+h.slice(0,o)),l-=14;o<l;)f.c.push(+h.slice(o,o+=14));o=14-(h=h.slice(o)).length}else o-=l;for(;o--;h+="0");f.c.push(+h)}}else f.c=[f.e=0]}function E(e,t,i,r){var n,s,o,a,l;if(null==i?i=p:ed(i,0,8),!e.c)return e.toString();if(n=e.c[0],o=e.e,null==t)l=eh(e.c),l=1==r||2==r&&(o<=g||o>=m)?eg(l,o):em(l,o,"0");else if(s=(e=N(new T(e),t,i)).e,a=(l=eh(e.c)).length,1==r||2==r&&(t<=s||s<=g)){for(;a<t;l+="0",a++);l=eg(l,s)}else if(t-=o+(2===r&&s>o),l=em(l,s,"0"),s+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=s-a)>0)for(s+1==a&&(l+=".");t--;l+="0");return e.s<0&&n?"-"+l:l}function _(e,t){for(var i,r,n=1,s=new T(e[0]);n<e.length;n++)(r=new T(e[n])).s&&(i=ef(s,r))!==t&&(0!==i||s.s!==t)||(s=r);return s}function A(e,t,i){for(var r=1,n=t.length;!t[--n];t.pop());for(n=t[0];n>=10;n/=10,r++);return(i=r+14*i-1)>b?e.c=e.e=null:i<y?e.c=[e.e=0]:(e.e=i,e.c=t),e}function N(e,t,i,r){var n,s,o,a,l,u,c,h=e.c;if(h){e:{for(n=1,a=h[0];a>=10;a/=10,n++);if((s=t-n)<0)s+=14,o=t,c=eo((l=h[u=0])/eu[n-o-1]%10);else if((u=es((s+1)/14))>=h.length)if(r){for(;h.length<=u;h.push(0));l=c=0,n=1,s%=14,o=s-14+1}else break e;else{for(n=1,l=a=h[u];a>=10;a/=10,n++);s%=14,c=(o=s-14+n)<0?0:eo(l/eu[n-o-1]%10)}if(r=r||t<0||null!=h[u+1]||(o<0?l:l%eu[n-o-1]),r=i<4?(c||r)&&(0==i||i==(e.s<0?3:2)):c>5||5==c&&(4==i||r||6==i&&(s>0?o>0?l/eu[n-o]:0:h[u-1])%10&1||i==(e.s<0?8:7)),t<1||!h[0])return h.length=0,r?(t-=e.e+1,h[0]=eu[(14-t%14)%14],e.e=-t||0):h[0]=e.e=0,e;if(0==s?(h.length=u,a=1,u--):(h.length=u+1,a=eu[14-s],h[u]=o>0?eo(l/eu[n-o]%eu[o])*a:0),r)for(;;)if(0==u){for(s=1,o=h[0];o>=10;o/=10,s++);for(o=h[0]+=a,a=1;o>=10;o/=10,a++);s!=a&&(e.e++,1e14==h[0]&&(h[0]=1));break}else{if(h[u]+=a,1e14!=h[u])break;h[u--]=0,a=1}for(s=h.length;0===h[--s];h.pop());}e.e>b?e.c=e.e=null:e.e<y&&(e.c=[e.e=0])}return e}function q(e){var t,i=e.e;return null===i?e.toString():(t=eh(e.c),t=i<=g||i>=m?eg(t,i):em(t,i,"0"),e.s<0?"-"+t:t)}return T.clone=e,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=function(e){var t,i;if(null!=e)if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(ed(i=e[t],0,1e9,t),d=i),e.hasOwnProperty(t="ROUNDING_MODE")&&(ed(i=e[t],0,8,t),p=i),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((i=e[t])&&i.pop?(ed(i[0],-1e9,0,t),ed(i[1],0,1e9,t),g=i[0],m=i[1]):(ed(i,-1e9,1e9,t),g=-(m=i<0?-i:i))),e.hasOwnProperty(t="RANGE"))if((i=e[t])&&i.pop)ed(i[0],-1e9,-1,t),ed(i[1],1,1e9,t),y=i[0],b=i[1];else if(ed(i,-1e9,1e9,t),i)y=-(b=i<0?-i:i);else throw Error(ea+t+" cannot be zero: "+i);if(e.hasOwnProperty(t="CRYPTO"))if(!!(i=e[t])===i)if(i)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))w=i;else throw w=!i,Error(ea+"crypto unavailable");else w=i;else throw Error(ea+t+" not true or false: "+i);if(e.hasOwnProperty(t="MODULO_MODE")&&(ed(i=e[t],0,9,t),v=i),e.hasOwnProperty(t="POW_PRECISION")&&(ed(i=e[t],0,1e9,t),S=i),e.hasOwnProperty(t="FORMAT"))if("object"==typeof(i=e[t]))x=i;else throw Error(ea+t+" not an object: "+i);if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(i=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(i))throw Error(ea+t+" invalid: "+i);P="0123456789"==i.slice(0,10),C=i}}else throw Error(ea+"Object expected: "+e);return{DECIMAL_PLACES:d,ROUNDING_MODE:p,EXPONENTIAL_AT:[g,m],RANGE:[y,b],CRYPTO:w,MODULO_MODE:v,POW_PRECISION:S,FORMAT:x,ALPHABET:C}},T.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!T.DEBUG)return!0;var t,i,r=e.c,n=e.e,s=e.s;e:if("[object Array]"==({}).toString.call(r)){if((1===s||-1===s)&&n>=-1e9&&n<=1e9&&n===eo(n)){if(0===r[0]){if(0===n&&1===r.length)return!0;break e}if((t=(n+1)%14)<1&&(t+=14),String(r[0]).length==t){for(t=0;t<r.length;t++)if((i=r[t])<0||i>=1e14||i!==eo(i))break e;if(0!==i)return!0}}}else if(null===r&&null===n&&(null===s||1===s||-1===s))return!0;throw Error(ea+"Invalid BigNumber: "+e)},T.maximum=T.max=function(){return _(arguments,-1)},T.minimum=T.min=function(){return _(arguments,1)},i=0x20000000000000*Math.random()&2097151?function(){return eo(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},T.random=function(e){var t,r,n,s,o,a=0,l=[],u=new T(f);if(null==e?e=d:ed(e,0,1e9),s=es(e/14),w)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));a<s;)(o=131072*t[a]+(t[a+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[a]=r[0],t[a+1]=r[1]):(l.push(o%1e14),a+=2);a=s/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(s*=7);a<s;)(o=(31&t[a])*0x1000000000000+0x10000000000*t[a+1]+0x100000000*t[a+2]+0x1000000*t[a+3]+(t[a+4]<<16)+(t[a+5]<<8)+t[a+6])>=9e15?crypto.randomBytes(7).copy(t,a):(l.push(o%1e14),a+=7);a=s/7}else throw w=!1,Error(ea+"crypto unavailable");if(!w)for(;a<s;)(o=i())<9e15&&(l[a++]=o%1e14);for(s=l[--a],e%=14,s&&e&&(o=eu[14-e],l[a]=eo(s/o)*o);0===l[a];l.pop(),a--);if(a<0)l=[n=0];else{for(n=-1;0===l[0];l.splice(0,1),n-=14);for(a=1,o=l[0];o>=10;o/=10,a++);a<14&&(n-=14-a)}return u.e=n,u.c=l,u},T.sum=function(){for(var e=1,t=arguments,i=new T(t[0]);e<t.length;)i=i.plus(t[e++]);return i},u=function(){var e="0123456789";function t(e,t,i,r){for(var n,s,o=[0],a=0,l=e.length;a<l;){for(s=o.length;s--;o[s]*=t);for(o[0]+=r.indexOf(e.charAt(a++)),n=0;n<o.length;n++)o[n]>i-1&&(null==o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/i|0,o[n]%=i)}return o.reverse()}return function(i,r,n,s,o){var a,u,c,h,f,g,m,y,b=i.indexOf("."),w=d,v=p;for(b>=0&&(h=S,S=0,i=i.replace(".",""),g=(y=new T(r)).pow(i.length-b),S=h,y.c=t(em(eh(g.c),g.e,"0"),10,n,e),y.e=y.c.length),c=h=(m=t(i,r,n,o?(a=C,e):(a=e,C))).length;0==m[--h];m.pop());if(!m[0])return a.charAt(0);if(b<0?--c:(g.c=m,g.e=c,g.s=s,m=(g=l(g,y,w,v,n)).c,f=g.r,c=g.e),b=m[u=c+w+1],h=n/2,f=f||u<0||null!=m[u+1],f=v<4?(null!=b||f)&&(0==v||v==(g.s<0?3:2)):b>h||b==h&&(4==v||f||6==v&&1&m[u-1]||v==(g.s<0?8:7)),u<1||!m[0])i=f?em(a.charAt(1),-w,a.charAt(0)):a.charAt(0);else{if(m.length=u,f)for(--n;++m[--u]>n;)m[u]=0,u||(++c,m=[1].concat(m));for(h=m.length;!m[--h];);for(b=0,i="";b<=h;i+=a.charAt(m[b++]));i=em(i,c,a.charAt(0))}return i}}(),l=function(){function e(e,t,i){var r,n,s,o,a=0,l=e.length,u=t%1e7,c=t/1e7|0;for(e=e.slice();l--;)r=c*(s=e[l]%1e7)+(o=e[l]/1e7|0)*u,a=((n=u*s+r%1e7*1e7+a)/i|0)+(r/1e7|0)+c*o,e[l]=n%i;return a&&(e=[a].concat(e)),e}function t(e,t,i,r){var n,s;if(i!=r)s=i>r?1:-1;else for(n=s=0;n<i;n++)if(e[n]!=t[n]){s=e[n]>t[n]?1:-1;break}return s}function i(e,t,i,r){for(var n=0;i--;)e[i]-=n,n=+(e[i]<t[i]),e[i]=n*r+e[i]-t[i];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,n,s,o,a){var l,u,c,h,f,d,p,g,m,y,b,w,v,S,x,C,P,E=r.s==n.s?1:-1,_=r.c,A=n.c;if(!_||!_[0]||!A||!A[0])return new T(!r.s||!n.s||(_?A&&_[0]==A[0]:!A)?NaN:_&&0==_[0]||!A?0*E:E/0);for(m=(g=new T(E)).c=[],E=s+(u=r.e-n.e)+1,a||(a=1e14,u=ec(r.e/14)-ec(n.e/14),E=E/14|0),c=0;A[c]==(_[c]||0);c++);if(A[c]>(_[c]||0)&&u--,E<0)m.push(1),h=!0;else{for(S=_.length,C=A.length,c=0,E+=2,(f=eo(a/(A[0]+1)))>1&&(A=e(A,f,a),_=e(_,f,a),C=A.length,S=_.length),v=C,b=(y=_.slice(0,C)).length;b<C;y[b++]=0);P=[0].concat(P=A.slice()),x=A[0],A[1]>=a/2&&x++;do{if(f=0,(l=t(A,y,C,b))<0){if(w=y[0],C!=b&&(w=w*a+(y[1]||0)),(f=eo(w/x))>1)for(f>=a&&(f=a-1),p=(d=e(A,f,a)).length,b=y.length;1==t(d,y,p,b);)f--,i(d,C<p?P:A,p,a),p=d.length,l=1;else 0==f&&(l=f=1),p=(d=A.slice()).length;if(p<b&&(d=[0].concat(d)),i(y,d,b,a),b=y.length,-1==l)for(;1>t(A,y,C,b);)f++,i(y,C<b?P:A,b,a),b=y.length}else 0===l&&(f++,y=[0]);m[c++]=f,y[0]?y[b++]=_[v]||0:(y=[_[v]],b=1)}while((v++<S||null!=y[0])&&E--)h=null!=y[0],m[0]||m.splice(0,1)}if(1e14==a){for(c=1,E=m[0];E>=10;E/=10,c++);N(g,s+(g.e=c+14*u-1)+1,o,h)}else g.e=u,g.r=+h;return g}}(),r=/^(-?)0([xbo])(?=\w[\w.]*$)/i,n=/^([^.]+)\.$/,s=/^\.([^.]+)$/,o=/^-?(Infinity|NaN)$/,a=/^\s*\+(?=[\w.])|^\s+|\s+$/g,c=function(e,t,i,l){var u,c=i?t:t.replace(a,"");if(o.test(c))e.s=isNaN(c)?null:c<0?-1:1;else{if(!i&&(c=c.replace(r,function(e,t,i){return u="x"==(i=i.toLowerCase())?16:"b"==i?2:8,l&&l!=u?e:t}),l&&(u=l,c=c.replace(n,"$1").replace(s,"0.$1")),t!=c))return new T(c,u);if(T.DEBUG)throw Error(ea+"Not a"+(l?" base "+l:"")+" number: "+t);e.s=null}e.c=e.e=null},h.absoluteValue=h.abs=function(){var e=new T(this);return e.s<0&&(e.s=1),e},h.comparedTo=function(e,t){return ef(this,new T(e,t))},h.decimalPlaces=h.dp=function(e,t){var i,r,n;if(null!=e)return ed(e,0,1e9),null==t?t=p:ed(t,0,8),N(new T(this),e+this.e+1,t);if(!(i=this.c))return null;if(r=((n=i.length-1)-ec(this.e/14))*14,n=i[n])for(;n%10==0;n/=10,r--);return r<0&&(r=0),r},h.dividedBy=h.div=function(e,t){return l(this,new T(e,t),d,p)},h.dividedToIntegerBy=h.idiv=function(e,t){return l(this,new T(e,t),0,1)},h.exponentiatedBy=h.pow=function(e,t){var i,r,n,s,o,a,l,u,c,h=this;if((e=new T(e)).c&&!e.isInteger())throw Error(ea+"Exponent not an integer: "+q(e));if(null!=t&&(t=new T(t)),a=e.e>14,!h.c||!h.c[0]||1==h.c[0]&&!h.e&&1==h.c.length||!e.c||!e.c[0])return c=new T(Math.pow(+q(h),a?e.s*(2-ep(e)):+q(e))),t?c.mod(t):c;if(l=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new T(NaN);(r=!l&&h.isInteger()&&t.isInteger())&&(h=h.mod(t))}else{if(e.e>9&&(h.e>0||h.e<-1||(0==h.e?h.c[0]>1||a&&h.c[1]>=24e7:h.c[0]<8e13||a&&h.c[0]<=9999975e7)))return s=h.s<0&&ep(e)?-0:0,h.e>-1&&(s=1/s),new T(l?1/s:s);S&&(s=es(S/14+2))}for(a?(i=new T(.5),l&&(e.s=1),u=ep(e)):u=(n=Math.abs(+q(e)))%2,c=new T(f);;){if(u){if(!(c=c.times(h)).c)break;s?c.c.length>s&&(c.c.length=s):r&&(c=c.mod(t))}if(n){if(0===(n=eo(n/2)))break;u=n%2}else if(N(e=e.times(i),e.e+1,1),e.e>14)u=ep(e);else{if(0==(n=+q(e)))break;u=n%2}h=h.times(h),s?h.c&&h.c.length>s&&(h.c.length=s):r&&(h=h.mod(t))}return r?c:(l&&(c=f.div(c)),t?c.mod(t):s?N(c,S,p,o):c)},h.integerValue=function(e){var t=new T(this);return null==e?e=p:ed(e,0,8),N(t,t.e+1,e)},h.isEqualTo=h.eq=function(e,t){return 0===ef(this,new T(e,t))},h.isFinite=function(){return!!this.c},h.isGreaterThan=h.gt=function(e,t){return ef(this,new T(e,t))>0},h.isGreaterThanOrEqualTo=h.gte=function(e,t){return 1===(t=ef(this,new T(e,t)))||0===t},h.isInteger=function(){return!!this.c&&ec(this.e/14)>this.c.length-2},h.isLessThan=h.lt=function(e,t){return 0>ef(this,new T(e,t))},h.isLessThanOrEqualTo=h.lte=function(e,t){return -1===(t=ef(this,new T(e,t)))||0===t},h.isNaN=function(){return!this.s},h.isNegative=function(){return this.s<0},h.isPositive=function(){return this.s>0},h.isZero=function(){return!!this.c&&0==this.c[0]},h.minus=function(e,t){var i,r,n,s,o=this.s;if(t=(e=new T(e,t)).s,!o||!t)return new T(NaN);if(o!=t)return e.s=-t,this.plus(e);var a=this.e/14,l=e.e/14,u=this.c,c=e.c;if(!a||!l){if(!u||!c)return u?(e.s=-t,e):new T(c?this:NaN);if(!u[0]||!c[0])return c[0]?(e.s=-t,e):new T(u[0]?this:3==p?-0:0)}if(a=ec(a),l=ec(l),u=u.slice(),o=a-l){for((s=o<0)?(o=-o,n=u):(l=a,n=c),n.reverse(),t=o;t--;n.push(0));n.reverse()}else for(r=(s=(o=u.length)<(t=c.length))?o:t,o=t=0;t<r;t++)if(u[t]!=c[t]){s=u[t]<c[t];break}if(s&&(n=u,u=c,c=n,e.s=-e.s),(t=(r=c.length)-(i=u.length))>0)for(;t--;u[i++]=0);for(t=1e14-1;r>o;){if(u[--r]<c[r]){for(i=r;i&&!u[--i];u[i]=t);--u[i],u[r]+=1e14}u[r]-=c[r]}for(;0==u[0];u.splice(0,1),--l);return u[0]?A(e,u,l):(e.s=3==p?-1:1,e.c=[e.e=0],e)},h.modulo=h.mod=function(e,t){var i,r;return(e=new T(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==v?(r=e.s,e.s=1,i=l(this,e,0,3),e.s=r,i.s*=r):i=l(this,e,0,v),(e=this.minus(i.times(e))).c[0]||1!=v||(e.s=this.s),e):new T(this):new T(NaN)},h.multipliedBy=h.times=function(e,t){var i,r,n,s,o,a,l,u,c,h,f,d,p,g=this.c,m=(e=new T(e,t)).c;if(!g||!m||!g[0]||!m[0])return this.s&&e.s&&(!g||g[0]||m)&&(!m||m[0]||g)?(e.s*=this.s,g&&m?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(r=ec(this.e/14)+ec(e.e/14),e.s*=this.s,(l=g.length)<(h=m.length)&&(p=g,g=m,m=p,n=l,l=h,h=n),n=l+h,p=[];n--;p.push(0));for(n=h;--n>=0;){for(i=0,f=m[n]%1e7,d=m[n]/1e7|0,s=n+(o=l);s>n;)a=d*(u=g[--o]%1e7)+(c=g[o]/1e7|0)*f,i=((u=f*u+a%1e7*1e7+p[s]+i)/1e14|0)+(a/1e7|0)+d*c,p[s--]=u%1e14;p[s]=i}return i?++r:p.splice(0,1),A(e,p,r)},h.negated=function(){var e=new T(this);return e.s=-e.s||null,e},h.plus=function(e,t){var i,r=this.s;if(t=(e=new T(e,t)).s,!r||!t)return new T(NaN);if(r!=t)return e.s=-t,this.minus(e);var n=this.e/14,s=e.e/14,o=this.c,a=e.c;if(!n||!s){if(!o||!a)return new T(r/0);if(!o[0]||!a[0])return a[0]?e:new T(o[0]?this:0*r)}if(n=ec(n),s=ec(s),o=o.slice(),r=n-s){for(r>0?(s=n,i=a):(r=-r,i=o),i.reverse();r--;i.push(0));i.reverse()}for((r=o.length)-(t=a.length)<0&&(i=a,a=o,o=i,t=r),r=0;t;)r=(o[--t]=o[t]+a[t]+r)/1e14|0,o[t]=1e14===o[t]?0:o[t]%1e14;return r&&(o=[r].concat(o),++s),A(e,o,s)},h.precision=h.sd=function(e,t){var i,r,n;if(null!=e&&!!e!==e)return ed(e,1,1e9),null==t?t=p:ed(t,0,8),N(new T(this),e,t);if(!(i=this.c))return null;if(r=14*(n=i.length-1)+1,n=i[n]){for(;n%10==0;n/=10,r--);for(n=i[0];n>=10;n/=10,r++);}return e&&this.e+1>r&&(r=this.e+1),r},h.shiftedBy=function(e){return ed(e,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+e)},h.squareRoot=h.sqrt=function(){var e,t,i,r,n,s=this.c,o=this.s,a=this.e,u=d+4,c=new T("0.5");if(1!==o||!s||!s[0])return new T(!o||o<0&&(!s||s[0])?NaN:s?this:1/0);if(0==(o=Math.sqrt(+q(this)))||o==1/0?(((t=eh(s)).length+a)%2==0&&(t+="0"),o=Math.sqrt(+t),a=ec((a+1)/2)-(a<0||a%2),i=new T(t=o==1/0?"5e"+a:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+a)):i=new T(o+""),i.c[0]){for((o=(a=i.e)+u)<3&&(o=0);;)if(n=i,i=c.times(n.plus(l(this,n,u,1))),eh(n.c).slice(0,o)===(t=eh(i.c)).slice(0,o)){if(i.e<a&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(N(i,i.e+d+2,1),e=!i.times(i).eq(this));break}if(!r&&(N(n,n.e+d+2,0),n.times(n).eq(this))){i=n;break}u+=4,o+=4,r=1}}return N(i,i.e+d+1,p,e)},h.toExponential=function(e,t){return null!=e&&(ed(e,0,1e9),e++),E(this,e,t,1)},h.toFixed=function(e,t){return null!=e&&(ed(e,0,1e9),e=e+this.e+1),E(this,e,t)},h.toFormat=function(e,t,i){var r;if(null==i)null!=e&&t&&"object"==typeof t?(i=t,t=null):e&&"object"==typeof e?(i=e,e=t=null):i=x;else if("object"!=typeof i)throw Error(ea+"Argument not an object: "+i);if(r=this.toFixed(e,t),this.c){var n,s=r.split("."),o=+i.groupSize,a=+i.secondaryGroupSize,l=i.groupSeparator||"",u=s[0],c=s[1],h=this.s<0,f=h?u.slice(1):u,d=f.length;if(a&&(n=o,o=a,a=n,d-=n),o>0&&d>0){for(n=d%o||o,u=f.substr(0,n);n<d;n+=o)u+=l+f.substr(n,o);a>0&&(u+=l+f.slice(n)),h&&(u="-"+u)}r=c?u+(i.decimalSeparator||"")+((a=+i.fractionGroupSize)?c.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):c):u}return(i.prefix||"")+r+(i.suffix||"")},h.toFraction=function(e){var t,i,r,n,s,o,a,u,c,h,d,g,m=this.c;if(null!=e&&(!(a=new T(e)).isInteger()&&(a.c||1!==a.s)||a.lt(f)))throw Error(ea+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+q(a));if(!m)return new T(this);for(t=new T(f),c=i=new T(f),r=u=new T(f),g=eh(m),s=t.e=g.length-this.e-1,t.c[0]=eu[(o=s%14)<0?14+o:o],e=!e||a.comparedTo(t)>0?s>0?t:c:a,o=b,b=1/0,a=new T(g),u.c[0]=0;h=l(a,t,0,1),1!=(n=i.plus(h.times(r))).comparedTo(e);)i=r,r=n,c=u.plus(h.times(n=c)),u=n,t=a.minus(h.times(n=t)),a=n;return n=l(e.minus(i),r,0,1),u=u.plus(n.times(c)),i=i.plus(n.times(r)),u.s=c.s=this.s,s*=2,d=1>l(c,r,s,p).minus(this).abs().comparedTo(l(u,i,s,p).minus(this).abs())?[c,r]:[u,i],b=o,d},h.toNumber=function(){return+q(this)},h.toPrecision=function(e,t){return null!=e&&ed(e,1,1e9),E(this,e,t,2)},h.toString=function(e){var t,i=this,r=i.s,n=i.e;return null===n?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=n<=g||n>=m?eg(eh(i.c),n):em(eh(i.c),n,"0"):10===e&&P?t=em(eh((i=N(new T(i),d+n+1,p)).c),i.e,"0"):(ed(e,2,C.length,"Base"),t=u(em(eh(i.c),n,"0"),10,e,r,!0)),r<0&&i.c[0]&&(t="-"+t)),t},h.valueOf=h.toJSON=function(){return q(this)},h._isBigNumber=!0,h[Symbol.toStringTag]="BigNumber",h[Symbol.for("nodejs.util.inspect.custom")]=h.valueOf,null!=t&&T.set(t),T}();let eb=24,ew="undefined"!=typeof globalThis&&globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues?()=>{let e=new Uint32Array(1);return globalThis.crypto.getRandomValues(e),e[0]/0x100000000}:Math.random,ev=(e=4,t=ew)=>{let i="";for(;i.length<e;)i+=Math.floor(36*t()).toString(36);return i},eS=(e="")=>(function(e){let t=new ey(0);for(let i of e.values())t=t.multipliedBy(256).plus(i);return t})(er(new TextEncoder().encode(e))).toString(36).slice(1),ex=Array.from({length:26},(e,t)=>String.fromCharCode(t+97)),eC=({globalObj:t=e.g,random:i=ew}={})=>{let r=Object.keys(t).toString();return eS(r.length?r+ev(32,i):ev(32,i)).substring(0,32)},eP=e=>()=>e++,eT=0x1c6b1f1f,eE=(({random:e=ew,counter:t=eP(Math.floor(e()*eT)),length:i=eb,fingerprint:r=eC({random:e})}={})=>{if(i>32)throw Error(`Length must be between 2 and 32. Received: ${i}`);return function(){let n=ex[Math.floor(e()*ex.length)],s=Date.now().toString(36),o=t().toString(36),a=ev(i,e),l=`${s+a+o+r}`;return`${n+eS(l).substring(1,i)}`}})(),e_=(0,A.pgTable)("users",{id:(0,N.text)("id").primaryKey().$defaultFn(()=>eE()),name:(0,N.text)("name"),email:(0,N.text)("email").notNull().unique(),emailVerified:(0,q.timestamp)("email_verified",{mode:"date"}),image:(0,N.text)("image"),isAdmin:(0,L.boolean)("is_admin").notNull().default(!1),createdAt:(0,q.timestamp)("created_at",{mode:"date"}).notNull().defaultNow(),updatedAt:(0,q.timestamp)("updated_at",{mode:"date"}).notNull().defaultNow()}),eA=(0,A.pgTable)("accounts",{userId:(0,N.text)("user_id").notNull().references(()=>e_.id,{onDelete:"cascade"}),type:(0,N.text)("type").notNull(),provider:(0,N.text)("provider").notNull(),providerAccountId:(0,N.text)("provider_account_id").notNull(),refresh_token:(0,N.text)("refresh_token"),access_token:(0,N.text)("access_token"),expires_at:(0,B.integer)("expires_at"),token_type:(0,N.text)("token_type"),scope:(0,N.text)("scope"),id_token:(0,N.text)("id_token"),session_state:(0,N.text)("session_state")},e=>({compoundKey:(0,O.primaryKey)({columns:[e.provider,e.providerAccountId]})})),eN=(0,A.pgTable)("sessions",{sessionToken:(0,N.text)("session_token").notNull().primaryKey(),userId:(0,N.text)("user_id").notNull().references(()=>e_.id,{onDelete:"cascade"}),expires:(0,q.timestamp)("expires",{mode:"date"}).notNull()}),eq=(0,A.pgTable)("verification_tokens",{identifier:(0,N.text)("identifier").notNull(),token:(0,N.text)("token").notNull(),expires:(0,q.timestamp)("expires",{mode:"date"}).notNull()},e=>({compositePk:(0,O.primaryKey)({columns:[e.identifier,e.token]})})),eL=(0,A.pgTable)("produtos",{id:(0,N.text)("id").primaryKey().$defaultFn(()=>eE()),nome:(0,N.text)("nome").notNull(),descricao:(0,N.text)("descricao"),preco:(0,I.decimal)("preco",{precision:10,scale:2}).notNull(),cor:(0,N.text)("cor"),linkCompra:(0,N.text)("link_compra"),imagemUrl:(0,N.text)("imagem_url"),categoria:(0,N.text)("categoria"),quantidade:(0,B.integer)("quantidade").notNull().default(1),prioridade:(0,B.integer)("prioridade").notNull().default(0),createdAt:(0,q.timestamp)("created_at",{mode:"date"}).notNull().defaultNow(),updatedAt:(0,q.timestamp)("updated_at",{mode:"date"}).notNull().defaultNow()}),eB=(0,A.pgTable)("reservas",{id:(0,N.text)("id").primaryKey().$defaultFn(()=>eE()),produtoId:(0,N.text)("produto_id").notNull().unique().references(()=>eL.id,{onDelete:"cascade"}),nomeConvidado:(0,N.text)("nome_convidado").notNull(),emailConvidado:(0,N.text)("email_convidado"),whatsapp:(0,N.text)("whatsapp"),mensagem:(0,N.text)("mensagem"),confirmado:(0,L.boolean)("confirmado").notNull().default(!1),createdAt:(0,q.timestamp)("created_at",{mode:"date"}).notNull().defaultNow()});e.s(["accounts",0,eA,"produtos",0,eL,"reservas",0,eB,"sessions",0,eN,"users",0,e_,"verificationTokens",0,eq],18916);var eI=e.i(18916);let eO=(0,o.relations)(e_,({many:e})=>({accounts:e(eA),sessions:e(eN)})),ek=(0,o.relations)(eA,({one:e})=>({user:e(e_,{fields:[eA.userId],references:[e_.id]})})),eD=(0,o.relations)(eN,({one:e})=>({user:e(e_,{fields:[eN.userId],references:[e_.id]})})),eM=(0,o.relations)(eL,({one:e})=>({reserva:e(eB,{fields:[eL.id],references:[eB.produtoId]})})),eR=(0,o.relations)(eB,({one:e})=>({produto:e(eL,{fields:[eB.produtoId],references:[eL.id]})}));e.s(["accountsRelations",0,ek,"produtosRelations",0,eM,"reservasRelations",0,eR,"sessionsRelations",0,eD,"usersRelations",0,eO],98767);var eQ=e.i(98767);let e$=_((0,t.neon)(process.env.DATABASE_URL),{schema:{...eI,...eQ}});e.s(["db",0,e$],42389)}];

//# sourceMappingURL=_84cdeaed._.js.map