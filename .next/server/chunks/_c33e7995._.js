module.exports=[30240,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={MutableRequestCookiesAdapter:function(){return f},ReadonlyRequestCookiesError:function(){return l},RequestCookiesAdapter:function(){return c},appendMutableCookies:function(){return h},areCookiesMutableInCurrentPhase:function(){return y},createCookiesWithMutableAccessCheck:function(){return p},getModifiedCookieValues:function(){return d},responseCookiesToRequestCookies:function(){return g}};for(var n in i)Object.defineProperty(r,n,{enumerable:!0,get:i[n]});let s=e.r(472),a=e.r(30759),o=e.r(56704);class l extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new l}}class c{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return l.callable;default:return a.ReflectAdapter.get(e,t,r)}}})}}let u=Symbol.for("next.mutated.cookies");function d(e){let t=e[u];return t&&Array.isArray(t)&&0!==t.length?t:[]}function h(e,t){let r=d(t);if(0===r.length)return!1;let i=new s.ResponseCookies(e),n=i.getAll();for(let e of r)i.set(e);for(let e of n)i.set(e);return!0}class f{static wrap(e,t){let r=new s.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let i=[],n=new Set,l=()=>{let e=o.workAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=!0),i=r.getAll().filter(e=>n.has(e.name)),t){let e=[];for(let t of i){let r=new s.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}},c=new Proxy(r,{get(e,t,r){switch(t){case u:return i;case"delete":return function(...t){n.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.delete(...t),c}finally{l()}};case"set":return function(...t){n.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t),c}finally{l()}};default:return a.ReflectAdapter.get(e,t,r)}}});return c}}function p(e){let t=new Proxy(e.mutableCookies,{get(r,i,n){switch(i){case"delete":return function(...i){return m(e,"cookies().delete"),r.delete(...i),t};case"set":return function(...i){return m(e,"cookies().set"),r.set(...i),t};default:return a.ReflectAdapter.get(r,i,n)}}});return t}function y(e){return"action"===e.phase}function m(e,t){if(!y(e))throw new l}function g(e){let t=new s.RequestCookies(new Headers);for(let r of e.getAll())t.set(r);return t}},13884,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return l}});let i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(void 0);if(r&&r.has(e))return r.get(e);var i={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=s?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}(e.r(47540));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}let s={current:null},a="function"==typeof i.cache?i.cache:e=>e,o=console.warn;function l(e){return function(...t){o(e(...t))}}a(e=>{try{o(s.current)}finally{s.current=null}})},7460,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cookies",{enumerable:!0,get:function(){return f}});let i=e.r(30240),n=e.r(472),s=e.r(56704),a=e.r(32319),o=e.r(68665),l=e.r(97573),c=e.r(4642),u=e.r(13884),d=e.r(43824),h=e.r(76414);function f(){let e="cookies",t=s.workAsyncStorage.getStore(),r=a.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,d.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`cookies()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E843",enumerable:!1,configurable:!0});if(t.forceStatic)return y(i.RequestCookiesAdapter.seal(new n.RequestCookies(new Headers({}))));if(t.dynamicShouldError)throw Object.defineProperty(new l.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E849",enumerable:!1,configurable:!0});if(r)switch(r.type){case"cache":let s=Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E831",enumerable:!1,configurable:!0});throw Error.captureStackTrace(s,f),t.invalidDynamicUsageError??=s,s;case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E846",enumerable:!1,configurable:!0});case"prerender":var u=t,m=r;let a=p.get(m);if(a)return a;let g=(0,c.makeHangingPromise)(m.renderSignal,u.route,"`cookies()`");return p.set(m,g),g;case"prerender-client":let b="`cookies`";throw Object.defineProperty(new h.InvariantError(`${b} must not be used within a Client Component. Next.js should be preventing ${b} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,o.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,o.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,o.delayUntilRuntimeStage)(r,y(r.cookies));case"private-cache":return y(r.cookies);case"request":return(0,o.trackDynamicDataInDynamicRender)(r),y((0,i.areCookiesMutableInCurrentPhase)(r)?r.userspaceMutableCookies:r.cookies)}}(0,a.throwForMissingRequestStore)(e)}e.r(18185);let p=new WeakMap;function y(e){let t=p.get(e);if(t)return t;let r=Promise.resolve(e);return p.set(e,r),r}(0,u.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`cookies()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E830",enumerable:!1,configurable:!0})})},36052,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={HeadersAdapter:function(){return o},ReadonlyHeadersError:function(){return a}};for(var n in i)Object.defineProperty(r,n,{enumerable:!0,get:i[n]});let s=e.r(30759);class a extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new a}}class o extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,i){if("symbol"==typeof r)return s.ReflectAdapter.get(t,r,i);let n=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===n);if(void 0!==a)return s.ReflectAdapter.get(t,a,i)},set(t,r,i,n){if("symbol"==typeof r)return s.ReflectAdapter.set(t,r,i,n);let a=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===a);return s.ReflectAdapter.set(t,o??r,i,n)},has(t,r){if("symbol"==typeof r)return s.ReflectAdapter.has(t,r);let i=r.toLowerCase(),n=Object.keys(e).find(e=>e.toLowerCase()===i);return void 0!==n&&s.ReflectAdapter.has(t,n)},deleteProperty(t,r){if("symbol"==typeof r)return s.ReflectAdapter.deleteProperty(t,r);let i=r.toLowerCase(),n=Object.keys(e).find(e=>e.toLowerCase()===i);return void 0===n||s.ReflectAdapter.deleteProperty(t,n)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return a.callable;default:return s.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new o(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,i]of this.entries())e.call(t,i,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},19971,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"headers",{enumerable:!0,get:function(){return h}});let i=e.r(36052),n=e.r(56704),s=e.r(32319),a=e.r(68665),o=e.r(97573),l=e.r(4642),c=e.r(13884),u=e.r(43824),d=e.r(76414);function h(){let e="headers",t=n.workAsyncStorage.getStore(),r=s.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,u.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(t.forceStatic)return p(i.HeadersAdapter.seal(new Headers({})));if(r)switch(r.type){case"cache":{let e=Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(e,h),t.invalidDynamicUsageError??=e,e}case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(t.dynamicShouldError)throw Object.defineProperty(new o.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(r)switch(r.type){case"prerender":var c=t,y=r;let n=f.get(y);if(n)return n;let s=(0,l.makeHangingPromise)(y.renderSignal,c.route,"`headers()`");return f.set(y,s),s;case"prerender-client":let m="`headers`";throw Object.defineProperty(new d.InvariantError(`${m} must not be used within a client component. Next.js should be preventing ${m} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,a.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,a.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,a.delayUntilRuntimeStage)(r,p(r.headers));case"private-cache":return p(r.headers);case"request":return(0,a.trackDynamicDataInDynamicRender)(r),p(r.headers)}}(0,s.throwForMissingRequestStore)(e)}e.r(18185);let f=new WeakMap;function p(e){let t=f.get(e);if(t)return t;let r=Promise.resolve(e);return f.set(e,r),r}(0,c.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})})},21423,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"draftMode",{enumerable:!0,get:function(){return u}});let i=e.r(32319),n=e.r(56704),s=e.r(68665),a=e.r(13884),o=e.r(97573),l=e.r(65252),c=e.r(76414);function u(){let e=n.workAsyncStorage.getStore(),t=i.workUnitAsyncStorage.getStore();switch((!e||!t)&&(0,i.throwForMissingRequestStore)("draftMode"),t.type){case"prerender-runtime":return(0,s.delayUntilRuntimeStage)(t,d(t.draftMode,e));case"request":return d(t.draftMode,e);case"cache":case"private-cache":case"unstable-cache":let r=(0,i.getDraftModeProviderForCacheScope)(e,t);if(r)return d(r,e);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return d(null,e);default:return t}}function d(e,t){let r=f.get(e??h);return r||Promise.resolve(new p(e))}e.r(30759);let h={},f=new WeakMap;class p{constructor(e){this._provider=e}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){y("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){y("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function y(e,t){let r=n.workAsyncStorage.getStore(),a=i.workUnitAsyncStorage.getStore();if(r){if((null==a?void 0:a.phase)==="after")throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(r.dynamicShouldError)throw Object.defineProperty(new o.StaticGenBailoutError(`Route ${r.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(a)switch(a.type){case"cache":case"private-cache":{let i=Object.defineProperty(Error(`Route ${r.route} used "${e}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(i,t),r.invalidDynamicUsageError??=i,i}case"unstable-cache":throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let t=Object.defineProperty(Error(`Route ${r.route} used ${e} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,s.abortAndThrowOnSynchronousRequestDataAccess)(r.route,e,t,a)}case"prerender-client":let i="`draftMode`";throw Object.defineProperty(new c.InvariantError(`${i} must not be used within a Client Component. Next.js should be preventing ${i} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,s.postponeWithTracking)(r.route,e,a.dynamicTracking);case"prerender-legacy":a.revalidate=0;let n=Object.defineProperty(new l.DynamicServerError(`Route ${r.route} couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw r.dynamicUsageDescription=e,r.dynamicUsageStack=n.stack,n;case"request":(0,s.trackDynamicDataInDynamicRender)(a)}}}(0,a.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})})},93458,(e,t,r)=>{t.exports.cookies=e.r(7460).cookies,t.exports.headers=e.r(19971).headers,t.exports.draftMode=e.r(21423).draftMode},8595,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return n}});class i extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class n extends URLSearchParams{append(){throw new i}delete(){throw new i}set(){throw new i}sort(){throw new i}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},50723,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RedirectStatusCode",{enumerable:!0,get:function(){return n}});var i,n=((i={})[i.SeeOther=303]="SeeOther",i[i.TemporaryRedirect=307]="TemporaryRedirect",i[i.PermanentRedirect=308]="PermanentRedirect",i);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},19334,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n={REDIRECT_ERROR_CODE:function(){return o},RedirectType:function(){return l},isRedirectError:function(){return c}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(50723),o="NEXT_REDIRECT";var l=((i={}).push="push",i.replace="replace",i);function c(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let t=e.digest.split(";"),[r,i]=t,n=t.slice(2,-2).join(";"),s=Number(t.at(-2));return r===o&&("replace"===i||"push"===i)&&"string"==typeof n&&!isNaN(s)&&s in a.RedirectStatusCode}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},22349,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={getRedirectError:function(){return l},getRedirectStatusCodeFromError:function(){return f},getRedirectTypeFromError:function(){return h},getURLFromRedirectError:function(){return d},permanentRedirect:function(){return u},redirect:function(){return c}};for(var n in i)Object.defineProperty(r,n,{enumerable:!0,get:i[n]});let s=e.r(50723),a=e.r(19334),o=e.r(20635).actionAsyncStorage;function l(e,t,r=s.RedirectStatusCode.TemporaryRedirect){let i=Object.defineProperty(Error(a.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return i.digest=`${a.REDIRECT_ERROR_CODE};${t};${e};${r};`,i}function c(e,t){throw l(e,t??=o?.getStore()?.isAction?a.RedirectType.push:a.RedirectType.replace,s.RedirectStatusCode.TemporaryRedirect)}function u(e,t=a.RedirectType.replace){throw l(e,t,s.RedirectStatusCode.PermanentRedirect)}function d(e){return(0,a.isRedirectError)(e)?e.digest.split(";").slice(2,-2).join(";"):null}function h(e){if(!(0,a.isRedirectError)(e))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return e.digest.split(";",2)[1]}function f(e){if(!(0,a.isRedirectError)(e))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(e.digest.split(";").at(-2))}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},12053,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={HTTPAccessErrorStatus:function(){return s},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return o},getAccessFallbackErrorTypeByStatus:function(){return u},getAccessFallbackHTTPStatus:function(){return c},isHTTPAccessFallbackError:function(){return l}};for(var n in i)Object.defineProperty(r,n,{enumerable:!0,get:i[n]});let s={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},a=new Set(Object.values(s)),o="NEXT_HTTP_ERROR_FALLBACK";function l(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r]=e.digest.split(";");return t===o&&a.has(Number(r))}function c(e){return Number(e.digest.split(";")[1])}function u(e){switch(e){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},2507,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"notFound",{enumerable:!0,get:function(){return s}});let i=e.r(12053),n=`${i.HTTP_ERROR_FALLBACK_ERROR_CODE};404`;function s(){let e=Object.defineProperty(Error(n),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw e.digest=n,e}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},47658,(e,t,r)=>{"use strict";function i(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"forbidden",{enumerable:!0,get:function(){return i}}),e.r(12053).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},35458,(e,t,r)=>{"use strict";function i(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unauthorized",{enumerable:!0,get:function(){return i}}),e.r(12053).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},67539,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isPostpone",{enumerable:!0,get:function(){return n}});let i=Symbol.for("react.postpone");function n(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}},62782,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isNextRouterError",{enumerable:!0,get:function(){return s}});let i=e.r(12053),n=e.r(19334);function s(e){return(0,n.isRedirectError)(e)||(0,i.isHTTPAccessFallbackError)(e)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},17387,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unstable_rethrow",{enumerable:!0,get:function(){return function e(t){if((0,a.isNextRouterError)(t)||(0,s.isBailoutToCSRError)(t)||(0,l.isDynamicServerError)(t)||(0,o.isDynamicPostpone)(t)||(0,n.isPostpone)(t)||(0,i.isHangingPromiseRejectionError)(t)||(0,o.isPrerenderInterruptedError)(t))throw t;t instanceof Error&&"cause"in t&&e(t.cause)}}});let i=e.r(4642),n=e.r(67539),s=e.r(31584),a=e.r(62782),o=e.r(68665),l=e.r(65252);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},9811,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unstable_rethrow",{enumerable:!0,get:function(){return i}});let i=e.r(17387).unstable_rethrow;("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},79509,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={ReadonlyURLSearchParams:function(){return s.ReadonlyURLSearchParams},RedirectType:function(){return o.RedirectType},forbidden:function(){return c.forbidden},notFound:function(){return l.notFound},permanentRedirect:function(){return a.permanentRedirect},redirect:function(){return a.redirect},unauthorized:function(){return u.unauthorized},unstable_isUnrecognizedActionError:function(){return h},unstable_rethrow:function(){return d.unstable_rethrow}};for(var n in i)Object.defineProperty(r,n,{enumerable:!0,get:i[n]});let s=e.r(8595),a=e.r(22349),o=e.r(19334),l=e.r(2507),c=e.r(47658),u=e.r(35458),d=e.r(9811);function h(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},79832,e=>{"use strict";let t,r,i,n,s,a;var o=function(e,t,r,i,n){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},l=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};function c(e){let t=e?"__Secure-":"";return{sessionToken:{name:`${t}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},callbackUrl:{name:`${t}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},csrfToken:{name:`${e?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},pkceCodeVerifier:{name:`${t}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},state:{name:`${t}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},nonce:{name:`${t}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},webauthnChallenge:{name:`${t}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}}}}class u{constructor(e,t,r){if(rl.add(this),rc.set(this,{}),ru.set(this,void 0),rd.set(this,void 0),o(this,rd,r,"f"),o(this,ru,e,"f"),!t)return;const{name:i}=e;for(const[e,r]of Object.entries(t))e.startsWith(i)&&r&&(l(this,rc,"f")[e]=r)}get value(){return Object.keys(l(this,rc,"f")).sort((e,t)=>parseInt(e.split(".").pop()||"0")-parseInt(t.split(".").pop()||"0")).map(e=>l(this,rc,"f")[e]).join("")}chunk(e,t){let r=l(this,rl,"m",rf).call(this);for(let i of l(this,rl,"m",rh).call(this,{name:l(this,ru,"f").name,value:e,options:{...l(this,ru,"f").options,...t}}))r[i.name]=i;return Object.values(r)}clean(){return Object.values(l(this,rl,"m",rf).call(this))}}rc=new WeakMap,ru=new WeakMap,rd=new WeakMap,rl=new WeakSet,rh=function(e){let t=Math.ceil(e.value.length/3936);if(1===t)return l(this,rc,"f")[e.name]=e.value,[e];let r=[];for(let i=0;i<t;i++){let t=`${e.name}.${i}`,n=e.value.substr(3936*i,3936);r.push({...e,name:t,value:n}),l(this,rc,"f")[t]=n}return l(this,rd,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:e.value.length,chunks:r.map(e=>e.value.length+160)}),r},rf=function(){let e={};for(let t in l(this,rc,"f"))delete l(this,rc,"f")?.[t],e[t]={name:t,value:"",options:{...l(this,ru,"f").options,maxAge:0}};return e};class d extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);const r=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${r}`}}class h extends d{}h.kind="signIn";class f extends d{}f.type="AdapterError";class p extends d{}p.type="AccessDenied";class y extends d{}y.type="CallbackRouteError";class m extends d{}m.type="ErrorPageLoop";class g extends d{}g.type="EventError";class b extends d{}b.type="InvalidCallbackUrl";class w extends h{constructor(){super(...arguments),this.code="credentials"}}w.type="CredentialsSignin";class v extends d{}v.type="InvalidEndpoints";class _ extends d{}_.type="InvalidCheck";class S extends d{}S.type="JWTSessionError";class A extends d{}A.type="MissingAdapter";class k extends d{}k.type="MissingAdapterMethods";class T extends d{}T.type="MissingAuthorize";class x extends d{}x.type="MissingSecret";class E extends h{}E.type="OAuthAccountNotLinked";class C extends h{}C.type="OAuthCallbackError";class q extends d{}q.type="OAuthProfileParseError";class $ extends d{}$.type="SessionTokenError";class O extends d{}O.type="SignOutError";class P extends d{}P.type="UnknownAction";class R extends d{}R.type="UnsupportedStrategy";class I extends d{}I.type="InvalidProvider";class U extends d{}U.type="UntrustedHost";class L extends d{}L.type="Verification";class j extends h{}j.type="MissingCSRF";let N=new Set(["CredentialsSignin","OAuthAccountNotLinked","OAuthCallbackError","AccessDenied","Verification","MissingCSRF","AccountNotLinked","WebAuthnVerificationError"]);class K extends d{}K.type="DuplicateConditionalUI";class D extends d{}D.type="MissingWebAuthnAutocomplete";class M extends d{}M.type="WebAuthnVerificationError";class B extends h{}B.type="AccountNotLinked";class H extends d{}H.type="ExperimentalFeatureNotEnabled";let Q=!1;function W(e,t){try{return/^https?:/.test(new URL(e,e.startsWith("/")?t:void 0).protocol)}catch{return!1}}let J=!1,F=!1,V=!1,z=["createVerificationToken","useVerificationToken","getUserByEmail"],G=["createUser","getUser","getUserByEmail","getUserByAccount","updateUser","linkAccount","createSession","getSessionAndUser","updateSession","deleteSession"],X=["createUser","getUser","linkAccount","getAccount","getAuthenticator","createAuthenticator","listAuthenticatorsByUserId","updateAuthenticatorCounter"];var Y=e.i(54799);"function"!=typeof Y.hkdf||process.versions.electron||(t=async(...e)=>new Promise((t,r)=>{Y.hkdf(...e,(e,i)=>{e?r(e):t(new Uint8Array(i))})}));let Z=async(e,r,i,n,s)=>(t||((e,t,r,i,n)=>{let s=parseInt(e.substr(3),10)>>3||20,a=(0,Y.createHmac)(e,r.byteLength?r:new Uint8Array(s)).update(t).digest(),o=Math.ceil(n/s),l=new Uint8Array(s*o+i.byteLength+1),c=0,u=0;for(let t=1;t<=o;t++)l.set(i,u),l[u+i.byteLength]=t,l.set((0,Y.createHmac)(e,a).update(l.subarray(c,u+i.byteLength+1)).digest(),u),c=u,u+=s;return l.slice(0,n)}))(e,r,i,n,s);function ee(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function et(e,t,r,i,n){return Z(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=ee(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),ee(r,"salt"),function(e){let t=ee(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(i),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(n,e))}let er=new TextEncoder,ei=new TextDecoder;function en(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;for(let i of e)t.set(i,r),r+=i.length;return t}function es(e,t,r){if(t<0||t>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function ea(e){let t=Math.floor(e/0x100000000),r=new Uint8Array(8);return es(r,t,0),es(r,e%0x100000000,4),r}function eo(e){let t=new Uint8Array(4);return es(t,e),t}function el(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>127)throw TypeError("non-ASCII string encountered in encode()");t[r]=i}return t}function ec(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof e?e:ei.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=ei.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/");try{var r=t;if(Uint8Array.fromBase64)return Uint8Array.fromBase64(r);let e=atob(r),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function eu(e){let t=e;return("string"==typeof t&&(t=er.encode(t)),Uint8Array.prototype.toBase64)?t.toBase64({alphabet:"base64url",omitPadding:!0}):(function(e){if(Uint8Array.prototype.toBase64)return e.toBase64();let t=[];for(let r=0;r<e.length;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join(""))})(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}e.s(["decode",()=>ec,"encode",()=>eu],63370);let ed=Symbol();class eh extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class ef extends eh{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.claim=r,this.reason=i,this.payload=t}}class ep extends eh{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.claim=r,this.reason=i,this.payload=t}}class ey extends eh{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class em extends eh{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class eg extends eh{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(e="decryption operation failed",t){super(e,t)}}class eb extends eh{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class ew extends eh{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class ev extends eh{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class e_ extends eh{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}function eS(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new em(`Unsupported JWE Algorithm: ${e}`)}}function eA(e,t){if(t.length<<3!==eS(e))throw new eb("Invalid Initialization Vector length")}function ek(e,t){let r=e.byteLength<<3;if(r!==t)throw new eb(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)}let eT=(e,t="algorithm.name")=>TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`);function ex(e,t,r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if("AES-GCM"!==e.algorithm.name)throw eT("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw eT(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if("AES-KW"!==e.algorithm.name)throw eT("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw eT(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":break;default:throw eT("ECDH or X25519")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if("PBKDF2"!==e.algorithm.name)throw eT("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if("RSA-OAEP"!==e.algorithm.name)throw eT("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==r)throw eT(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}if(r&&!e.usages.includes(r))throw TypeError(`CryptoKey does not support this operation, its usages must include ${r}.`)}function eE(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let eC=(e,...t)=>eE("Key must be ",e,...t),eq=(e,t,...r)=>eE(`Key for the ${e} algorithm must be `,t,...r);function e$(e){if(!eO(e))throw Error("CryptoKey instance expected")}let eO=e=>{if(e?.[Symbol.toStringTag]==="CryptoKey")return!0;try{return e instanceof CryptoKey}catch{return!1}},eP=e=>e?.[Symbol.toStringTag]==="KeyObject",eR=e=>eO(e)||eP(e);async function eI(e,t,r,i,n){if(!(r instanceof Uint8Array))throw TypeError(eC(r,"Uint8Array"));let s=parseInt(e.slice(1,4),10),a=await crypto.subtle.importKey("raw",r.subarray(s>>3),"AES-CBC",!1,["encrypt"]),o=await crypto.subtle.importKey("raw",r.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),l=new Uint8Array(await crypto.subtle.encrypt({iv:i,name:"AES-CBC"},a,t)),c=en(n,i,l,ea(n.length<<3));return{ciphertext:l,tag:new Uint8Array((await crypto.subtle.sign("HMAC",o,c)).slice(0,s>>3)),iv:i}}async function eU(e,t,r,i,n){let s;r instanceof Uint8Array?s=await crypto.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(ex(r,e,"encrypt"),s=r);let a=new Uint8Array(await crypto.subtle.encrypt({additionalData:n,iv:i,name:"AES-GCM",tagLength:128},s,t)),o=a.slice(-16);return{ciphertext:a.slice(0,-16),tag:o,iv:i}}async function eL(e,t,r,i,n){if(!eO(r)&&!(r instanceof Uint8Array))throw TypeError(eC(r,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(i)eA(e,i);else i=crypto.getRandomValues(new Uint8Array(eS(e)>>3));switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&ek(r,parseInt(e.slice(-3),10)),eI(e,t,r,i,n);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&ek(r,parseInt(e.slice(1,4),10)),eU(e,t,r,i,n);default:throw new em("Unsupported JWE Content Encryption Algorithm")}}function ej(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function eN(e,t,r){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"AES-KW",!0,[r]):(ex(e,t,r),e)}async function eK(e,t,r){let i=await eN(t,e,"wrapKey");ej(i,e);let n=await crypto.subtle.importKey("raw",r,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",n,i,"AES-KW"))}async function eD(e,t,r){let i=await eN(t,e,"unwrapKey");ej(i,e);let n=await crypto.subtle.unwrapKey("raw",r,i,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",n))}async function eM(e,t){let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(r,t))}function eB(e){return en(eo(e.length),e)}async function eH(e,t,r){let i=t>>3,n=Math.ceil(i/32),s=new Uint8Array(32*n);for(let t=1;t<=n;t++){let i=new Uint8Array(4+e.length+r.length);i.set(eo(t),0),i.set(e,4),i.set(r,4+e.length);let n=await eM("sha256",i);s.set(n,(t-1)*32)}return s.slice(0,i)}async function eQ(e,t,r,i,n=new Uint8Array,s=new Uint8Array){var a;ex(e,"ECDH"),ex(t,"ECDH","deriveBits");let o=en(eB(el(r)),eB(n),eB(s),eo(i),new Uint8Array);return eH(new Uint8Array(await crypto.subtle.deriveBits({name:e.algorithm.name,public:e},t,"X25519"===(a=e).algorithm.name?256:Math.ceil(parseInt(a.algorithm.namedCurve.slice(-3),10)/8)<<3)),i,o)}function eW(e){switch(e.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return"X25519"===e.algorithm.name}}async function eJ(e,t,r,i){if(!(e instanceof Uint8Array)||e.length<8)throw new eb("PBES2 Salt Input must be 8 or more octets");let n=en(el(t),Uint8Array.of(0),e),s=parseInt(t.slice(13,16),10),a={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:n},o=await (i instanceof Uint8Array?crypto.subtle.importKey("raw",i,"PBKDF2",!1,["deriveBits"]):(ex(i,t,"deriveBits"),i));return new Uint8Array(await crypto.subtle.deriveBits(a,o,s))}async function eF(e,t,r,i=2048,n=crypto.getRandomValues(new Uint8Array(16))){let s=await eJ(n,e,i,t);return{encryptedKey:await eK(e.slice(-6),s,r),p2c:i,p2s:eu(n)}}async function eV(e,t,r,i,n){let s=await eJ(n,e,i,t);return eD(e.slice(-6),s,r)}function ez(e,t){if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}}let eG=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new em(`alg ${e} is not supported either by JOSE or your javascript runtime`)}};async function eX(e,t,r){return ex(t,e,"encrypt"),ez(e,t),new Uint8Array(await crypto.subtle.encrypt(eG(e),t,r))}async function eY(e,t,r){return ex(t,e,"decrypt"),ez(e,t),new Uint8Array(await crypto.subtle.decrypt(eG(e),t,r))}function eZ(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}let e0=e=>eZ(e)&&"string"==typeof e.kty;async function e1(e){if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=function(e){let t,r;switch(e.kty){case"AKP":switch(e.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":t={name:e.alg},r=e.priv?["sign"]:["verify"];break;default:throw new em('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new em('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new em('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"Ed25519":case"EdDSA":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new em('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new em('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),i={...e};return"AKP"!==i.kty&&delete i.alg,delete i.use,crypto.subtle.importKey("jwk",i,t,e.ext??(!e.d&&!e.priv),e.key_ops??r)}let e2=async(e,t,i,n=!1)=>{let s=(r||=new WeakMap).get(e);if(s?.[i])return s[i];let a=await e1({...t,alg:i});return n&&Object.freeze(e),s?s[i]=a:r.set(e,{[i]:a}),a};async function e5(e,t){if(e instanceof Uint8Array||eO(e))return e;if(eP(e)){if("secret"===e.type)return e.export();if("toCryptoKey"in e&&"function"==typeof e.toCryptoKey)try{return((e,t)=>{let i,n=(r||=new WeakMap).get(e);if(n?.[t])return n[t];let s="public"===e.type,a=!!s;if("x25519"===e.asymmetricKeyType){switch(t){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}i=e.toCryptoKey(e.asymmetricKeyType,a,s?[]:["deriveBits"])}if("ed25519"===e.asymmetricKeyType){if("EdDSA"!==t&&"Ed25519"!==t)throw TypeError("given KeyObject instance cannot be used for this algorithm");i=e.toCryptoKey(e.asymmetricKeyType,a,[s?"verify":"sign"])}switch(e.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":if(t!==e.asymmetricKeyType.toUpperCase())throw TypeError("given KeyObject instance cannot be used for this algorithm");i=e.toCryptoKey(e.asymmetricKeyType,a,[s?"verify":"sign"])}if("rsa"===e.asymmetricKeyType){let r;switch(t){case"RSA-OAEP":r="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":r="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":r="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":r="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(t.startsWith("RSA-OAEP"))return e.toCryptoKey({name:"RSA-OAEP",hash:r},a,s?["encrypt"]:["decrypt"]);i=e.toCryptoKey({name:t.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:r},a,[s?"verify":"sign"])}if("ec"===e.asymmetricKeyType){let r=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(e.asymmetricKeyDetails?.namedCurve);if(!r)throw TypeError("given KeyObject instance cannot be used for this algorithm");"ES256"===t&&"P-256"===r&&(i=e.toCryptoKey({name:"ECDSA",namedCurve:r},a,[s?"verify":"sign"])),"ES384"===t&&"P-384"===r&&(i=e.toCryptoKey({name:"ECDSA",namedCurve:r},a,[s?"verify":"sign"])),"ES512"===t&&"P-521"===r&&(i=e.toCryptoKey({name:"ECDSA",namedCurve:r},a,[s?"verify":"sign"])),t.startsWith("ECDH-ES")&&(i=e.toCryptoKey({name:"ECDH",namedCurve:r},a,s?[]:["deriveBits"]))}if(!i)throw TypeError("given KeyObject instance cannot be used for this algorithm");return n?n[t]=i:r.set(e,{[t]:i}),i})(e,t)}catch(e){if(e instanceof TypeError)throw e}let i=e.export({format:"jwk"});return e2(e,i,t)}if(e0(e))return e.k?ec(e.k):e2(e,e,t,!0);throw Error("unreachable")}function e8(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new em(`Unsupported JWE Algorithm: ${e}`)}}let e3=e=>crypto.getRandomValues(new Uint8Array(e8(e)>>3));async function e4(e){if(eP(e))if("secret"!==e.type)return e.export({format:"jwk"});else e=e.export();if(e instanceof Uint8Array)return{kty:"oct",k:eu(e)};if(!eO(e))throw TypeError(eC(e,"CryptoKey","KeyObject","Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:i,use:n,...s}=await crypto.subtle.exportKey("jwk",e);return"AKP"===s.kty&&(s.alg=i),s}async function e6(e){return e4(e)}async function e9(e,t){if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let r={name:"HMAC",hash:"SHA-256"},i=await crypto.subtle.generateKey(r,!1,["sign"]),n=new Uint8Array(await crypto.subtle.sign(r,i,e)),s=new Uint8Array(await crypto.subtle.sign(r,i,t)),a=0,o=-1;for(;++o<32;)a|=n[o]^s[o];return 0===a}async function e7(e,t,r,i,n,s){let a,o;if(!(t instanceof Uint8Array))throw TypeError(eC(t,"Uint8Array"));let l=parseInt(e.slice(1,4),10),c=await crypto.subtle.importKey("raw",t.subarray(l>>3),"AES-CBC",!1,["decrypt"]),u=await crypto.subtle.importKey("raw",t.subarray(0,l>>3),{hash:`SHA-${l<<1}`,name:"HMAC"},!1,["sign"]),d=en(s,i,r,ea(s.length<<3)),h=new Uint8Array((await crypto.subtle.sign("HMAC",u,d)).slice(0,l>>3));try{a=await e9(n,h)}catch{}if(!a)throw new eg;try{o=new Uint8Array(await crypto.subtle.decrypt({iv:i,name:"AES-CBC"},c,r))}catch{}if(!o)throw new eg;return o}async function te(e,t,r,i,n,s){let a;t instanceof Uint8Array?a=await crypto.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(ex(t,e,"decrypt"),a=t);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:s,iv:i,name:"AES-GCM",tagLength:128},a,en(r,n)))}catch{throw new eg}}async function tt(e,t,r,i,n,s){if(!eO(t)&&!(t instanceof Uint8Array))throw TypeError(eC(t,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!i)throw new eb("JWE Initialization Vector missing");if(!n)throw new eb("JWE Authentication Tag missing");switch(eA(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&ek(t,parseInt(e.slice(-3),10)),e7(e,t,r,i,n,s);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&ek(t,parseInt(e.slice(1,4),10)),te(e,t,r,i,n,s);default:throw new em("Unsupported JWE Content Encryption Algorithm")}}async function tr(e,t,r,i){let n=e.slice(0,7),s=await eL(n,r,t,i,new Uint8Array);return{encryptedKey:s.ciphertext,iv:eu(s.iv),tag:eu(s.tag)}}async function ti(e,t,r,i,n){return tt(e.slice(0,7),t,r,i,n,new Uint8Array)}async function tn(e,t,r,i,n={}){let s,a,o;switch(e){case"dir":o=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let l;if(e$(r),!eW(r))throw new em("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:c,apv:u}=n;l=n.epk?await e5(n.epk,e):(await crypto.subtle.generateKey(r.algorithm,!0,["deriveBits"])).privateKey;let{x:d,y:h,crv:f,kty:p}=await e6(l),y=await eQ(r,l,"ECDH-ES"===e?t:e,"ECDH-ES"===e?e8(t):parseInt(e.slice(-5,-2),10),c,u);if(a={epk:{x:d,crv:f,kty:p}},"EC"===p&&(a.epk.y=h),c&&(a.apu=eu(c)),u&&(a.apv=eu(u)),"ECDH-ES"===e){o=y;break}o=i||e3(t);let m=e.slice(-6);s=await eK(m,y,o);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o=i||e3(t),e$(r),s=await eX(e,r,o);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{o=i||e3(t);let{p2c:l,p2s:c}=n;({encryptedKey:s,...a}=await eF(e,r,o,l,c));break}case"A128KW":case"A192KW":case"A256KW":o=i||e3(t),s=await eK(e,r,o);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{o=i||e3(t);let{iv:l}=n;({encryptedKey:s,...a}=await tr(e,r,o,l));break}default:throw new em('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:o,encryptedKey:s,parameters:a}}function ts(...e){let t,r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0}function ta(e,t,r,i,n){let s;if(void 0!==n.crit&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let a of(s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!s.has(a))throw new em(`Extension Header Parameter "${a}" is not recognized`);if(void 0===n[a])throw new e(`Extension Header Parameter "${a}" is missing`);if(s.get(a)&&void 0===i[a])throw new e(`Extension Header Parameter "${a}" MUST be integrity protected`)}return new Set(i.crit)}let to=e=>e?.[Symbol.toStringTag],tl=(e,t,r)=>{if(void 0!==t.use){let e;switch(r){case"sign":case"verify":e="sig";break;case"encrypt":case"decrypt":e="enc"}if(t.use!==e)throw TypeError(`Invalid key for this operation, its "use" must be "${e}" when present`)}if(void 0!==t.alg&&t.alg!==e)throw TypeError(`Invalid key for this operation, its "alg" must be "${e}" when present`);if(Array.isArray(t.key_ops)){let i;switch(!0){case"sign"===r||"verify"===r:case"dir"===e:case e.includes("CBC-HS"):i=r;break;case e.startsWith("PBES2"):i="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(e):i=!e.includes("GCM")&&e.endsWith("KW")?"encrypt"===r?"wrapKey":"unwrapKey":r;break;case"encrypt"===r&&e.startsWith("RSA"):i="wrapKey";break;case"decrypt"===r:i=e.startsWith("RSA")?"unwrapKey":"deriveBits"}if(i&&t.key_ops?.includes?.(i)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${i}" when present`)}return!0};function tc(e,t,r){switch(e.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":((e,t,r)=>{if(!(t instanceof Uint8Array)){if(e0(t)){if("oct"===t.kty&&"string"==typeof t.k&&tl(e,t,r))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!eR(t))throw TypeError(eq(e,t,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if("secret"!==t.type)throw TypeError(`${to(t)} instances for symmetric algorithms must be of type "secret"`)}})(e,t,r);break;default:((e,t,r)=>{if(e0(t))switch(r){case"decrypt":case"sign":if("oct"!==t.kty&&("AKP"===t.kty&&"string"==typeof t.priv||"string"==typeof t.d)&&tl(e,t,r))return;throw TypeError("JSON Web Key for this operation must be a private JWK");case"encrypt":case"verify":if("oct"!==t.kty&&void 0===t.d&&void 0===t.priv&&tl(e,t,r))return;throw TypeError("JSON Web Key for this operation must be a public JWK")}if(!eR(t))throw TypeError(eq(e,t,"CryptoKey","KeyObject","JSON Web Key"));if("secret"===t.type)throw TypeError(`${to(t)} instances for asymmetric algorithms must not be of type "secret"`);if("public"===t.type)switch(r){case"sign":throw TypeError(`${to(t)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${to(t)} instances for asymmetric algorithm decryption must be of type "private"`)}if("private"===t.type)switch(r){case"verify":throw TypeError(`${to(t)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${to(t)} instances for asymmetric algorithm encryption must be of type "public"`)}})(e,t,r)}}class tu{#e;#t;#r;#i;#n;#s;#a;#o;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#e=e}setKeyManagementParameters(e){if(this.#o)throw TypeError("setKeyManagementParameters can only be called once");return this.#o=e,this}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setSharedUnprotectedHeader(e){if(this.#r)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#r=e,this}setUnprotectedHeader(e){if(this.#i)throw TypeError("setUnprotectedHeader can only be called once");return this.#i=e,this}setAdditionalAuthenticatedData(e){return this.#n=e,this}setContentEncryptionKey(e){if(this.#s)throw TypeError("setContentEncryptionKey can only be called once");return this.#s=e,this}setInitializationVector(e){if(this.#a)throw TypeError("setInitializationVector can only be called once");return this.#a=e,this}async encrypt(e,t){let r,i,n,s,a,o;if(!this.#t&&!this.#i&&!this.#r)throw new eb("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!ts(this.#t,this.#i,this.#r))throw new eb("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let l={...this.#t,...this.#i,...this.#r};if(ta(eb,new Map,t?.crit,this.#t,l),void 0!==l.zip)throw new em('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:c,enc:u}=l;if("string"!=typeof c||!c)throw new eb('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof u||!u)throw new eb('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this.#s&&("dir"===c||"ECDH-ES"===c))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${c}`);tc("dir"===c?u:c,e,"encrypt");{let n,s=await e5(e,c);({cek:i,encryptedKey:r,parameters:n}=await tn(c,u,s,this.#s,this.#o)),n&&(t&&ed in t?this.#i?this.#i={...this.#i,...n}:this.setUnprotectedHeader(n):this.#t?this.#t={...this.#t,...n}:this.setProtectedHeader(n))}if(this.#t?a=el(s=eu(JSON.stringify(this.#t))):(s="",a=new Uint8Array),this.#n){let e=el(o=eu(this.#n));n=en(a,el("."),e)}else n=a;let{ciphertext:d,tag:h,iv:f}=await eL(u,this.#e,i,this.#a,n),p={ciphertext:eu(d)};return f&&(p.iv=eu(f)),h&&(p.tag=eu(h)),r&&(p.encrypted_key=eu(r)),o&&(p.aad=o),this.#t&&(p.protected=s),this.#r&&(p.unprotected=this.#r),this.#i&&(p.header=this.#i),p}}class td{#l;constructor(e){this.#l=new tu(e)}setContentEncryptionKey(e){return this.#l.setContentEncryptionKey(e),this}setInitializationVector(e){return this.#l.setInitializationVector(e),this}setProtectedHeader(e){return this.#l.setProtectedHeader(e),this}setKeyManagementParameters(e){return this.#l.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this.#l.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}let th=e=>Math.floor(e.getTime()/1e3),tf=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function tp(e){let t,r=tf.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let i=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(i);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*i);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*i);break;case"day":case"days":case"d":t=Math.round(86400*i);break;case"week":case"weeks":case"w":t=Math.round(604800*i);break;default:t=Math.round(0x1e187e0*i)}return"-"===r[1]||"ago"===r[4]?-t:t}function ty(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t}let tm=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`;class tg{#c;constructor(e){if(!eZ(e))throw TypeError("JWT Claims Set MUST be an object");this.#c=structuredClone(e)}data(){return er.encode(JSON.stringify(this.#c))}get iss(){return this.#c.iss}set iss(e){this.#c.iss=e}get sub(){return this.#c.sub}set sub(e){this.#c.sub=e}get aud(){return this.#c.aud}set aud(e){this.#c.aud=e}set jti(e){this.#c.jti=e}set nbf(e){"number"==typeof e?this.#c.nbf=ty("setNotBefore",e):e instanceof Date?this.#c.nbf=ty("setNotBefore",th(e)):this.#c.nbf=th(new Date)+tp(e)}set exp(e){"number"==typeof e?this.#c.exp=ty("setExpirationTime",e):e instanceof Date?this.#c.exp=ty("setExpirationTime",th(e)):this.#c.exp=th(new Date)+tp(e)}set iat(e){void 0===e?this.#c.iat=th(new Date):e instanceof Date?this.#c.iat=ty("setIssuedAt",th(e)):"string"==typeof e?this.#c.iat=ty("setIssuedAt",th(new Date)+tp(e)):this.#c.iat=ty("setIssuedAt",e)}}class tb{#s;#a;#o;#t;#u;#d;#h;#f;constructor(e={}){this.#f=new tg(e)}setIssuer(e){return this.#f.iss=e,this}setSubject(e){return this.#f.sub=e,this}setAudience(e){return this.#f.aud=e,this}setJti(e){return this.#f.jti=e,this}setNotBefore(e){return this.#f.nbf=e,this}setExpirationTime(e){return this.#f.exp=e,this}setIssuedAt(e){return this.#f.iat=e,this}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setKeyManagementParameters(e){if(this.#o)throw TypeError("setKeyManagementParameters can only be called once");return this.#o=e,this}setContentEncryptionKey(e){if(this.#s)throw TypeError("setContentEncryptionKey can only be called once");return this.#s=e,this}setInitializationVector(e){if(this.#a)throw TypeError("setInitializationVector can only be called once");return this.#a=e,this}replicateIssuerAsHeader(){return this.#u=!0,this}replicateSubjectAsHeader(){return this.#d=!0,this}replicateAudienceAsHeader(){return this.#h=!0,this}async encrypt(e,t){let r=new td(this.#f.data());return this.#t&&(this.#u||this.#d||this.#h)&&(this.#t={...this.#t,iss:this.#u?this.#f.iss:void 0,sub:this.#d?this.#f.sub:void 0,aud:this.#h?this.#f.aud:void 0}),r.setProtectedHeader(this.#t),this.#a&&r.setInitializationVector(this.#a),this.#s&&r.setContentEncryptionKey(this.#s),this.#o&&r.setKeyManagementParameters(this.#o),r.encrypt(e,t)}}var tw=e.i(63370),tw=tw;let tv=(e,t)=>{if("string"!=typeof e||!e)throw new ev(`${t} missing or invalid`)};async function t_(e,t){let r,i;if(e0(e))r=e;else if(eR(e))r=await e6(e);else throw TypeError(eC(e,"CryptoKey","KeyObject","JSON Web Key"));if("sha256"!==(t??="sha256")&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(r.kty){case"AKP":tv(r.alg,'"alg" (Algorithm) Parameter'),tv(r.pub,'"pub" (Public key) Parameter'),i={alg:r.alg,kty:r.kty,pub:r.pub};break;case"EC":tv(r.crv,'"crv" (Curve) Parameter'),tv(r.x,'"x" (X Coordinate) Parameter'),tv(r.y,'"y" (Y Coordinate) Parameter'),i={crv:r.crv,kty:r.kty,x:r.x,y:r.y};break;case"OKP":tv(r.crv,'"crv" (Subtype of Key Pair) Parameter'),tv(r.x,'"x" (Public Key) Parameter'),i={crv:r.crv,kty:r.kty,x:r.x};break;case"RSA":tv(r.e,'"e" (Exponent) Parameter'),tv(r.n,'"n" (Modulus) Parameter'),i={e:r.e,kty:r.kty,n:r.n};break;case"oct":tv(r.k,'"k" (Key Value) Parameter'),i={k:r.k,kty:r.kty};break;default:throw new em('"kty" (Key Type) Parameter missing or unsupported')}let n=el(JSON.stringify(i));return eu(await eM(t,n))}async function tS(e,t,r){let i;if(!eZ(e))throw TypeError("JWK must be an object");switch(t??=e.alg,i??=r?.extractable??e.ext,e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return ec(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new em('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return e1({...e,alg:t,ext:i});case"AKP":if("string"!=typeof e.alg||!e.alg)throw TypeError('missing "alg" (Algorithm) Parameter value');if(void 0!==t&&t!==e.alg)throw TypeError("JWK alg and alg option value mismatch");return e1({...e,ext:i});case"EC":case"OKP":return e1({...e,alg:t,ext:i});default:throw new em('Unsupported "kty" (Key Type) Parameter value')}}async function tA(e,t,r,i,n){switch(e){case"dir":if(void 0!==r)throw new eb("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new eb("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let n,s;if(!eZ(i.epk))throw new eb('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(e$(t),!eW(t))throw new em("ECDH with the provided key is not allowed or not supported by your javascript runtime");let a=await tS(i.epk,e);if(e$(a),void 0!==i.apu){if("string"!=typeof i.apu)throw new eb('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{n=ec(i.apu)}catch{throw new eb("Failed to base64url decode the apu")}}if(void 0!==i.apv){if("string"!=typeof i.apv)throw new eb('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{s=ec(i.apv)}catch{throw new eb("Failed to base64url decode the apv")}}let o=await eQ(a,t,"ECDH-ES"===e?i.enc:e,"ECDH-ES"===e?e8(i.enc):parseInt(e.slice(-5,-2),10),n,s);if("ECDH-ES"===e)return o;if(void 0===r)throw new eb("JWE Encrypted Key missing");return eD(e.slice(-6),o,r)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new eb("JWE Encrypted Key missing");return e$(t),eY(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let s;if(void 0===r)throw new eb("JWE Encrypted Key missing");if("number"!=typeof i.p2c)throw new eb('JOSE Header "p2c" (PBES2 Count) missing or invalid');let a=n?.maxPBES2Count||1e4;if(i.p2c>a)throw new eb('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof i.p2s)throw new eb('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{s=ec(i.p2s)}catch{throw new eb("Failed to base64url decode the p2s")}return eV(e,t,r,i.p2c,s)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new eb("JWE Encrypted Key missing");return eD(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let n,s;if(void 0===r)throw new eb("JWE Encrypted Key missing");if("string"!=typeof i.iv)throw new eb('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof i.tag)throw new eb('JOSE Header "tag" (Authentication Tag) missing or invalid');try{n=ec(i.iv)}catch{throw new eb("Failed to base64url decode the iv")}try{s=ec(i.tag)}catch{throw new eb("Failed to base64url decode the tag")}return ti(e,t,r,n,s)}default:throw new em('Invalid or unsupported "alg" (JWE Algorithm) header value')}}function tk(e,t){if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}async function tT(e,t,r){let i,n,s,a,o,l,c;if(!eZ(e))throw new eb("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new eb("JOSE Header missing");if(void 0!==e.iv&&"string"!=typeof e.iv)throw new eb("JWE Initialization Vector incorrect type");if("string"!=typeof e.ciphertext)throw new eb("JWE Ciphertext missing or incorrect type");if(void 0!==e.tag&&"string"!=typeof e.tag)throw new eb("JWE Authentication Tag incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new eb("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new eb("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new eb("JWE AAD incorrect type");if(void 0!==e.header&&!eZ(e.header))throw new eb("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!eZ(e.unprotected))throw new eb("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=ec(e.protected);i=JSON.parse(ei.decode(t))}catch{throw new eb("JWE Protected Header is invalid")}if(!ts(i,e.header,e.unprotected))throw new eb("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let u={...i,...e.header,...e.unprotected};if(ta(eb,new Map,r?.crit,i,u),void 0!==u.zip)throw new em('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:d,enc:h}=u;if("string"!=typeof d||!d)throw new eb("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new eb("missing JWE Encryption Algorithm (enc) in JWE Header");let f=r&&tk("keyManagementAlgorithms",r.keyManagementAlgorithms),p=r&&tk("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(f&&!f.has(d)||!f&&d.startsWith("PBES2"))throw new ey('"alg" (Algorithm) Header Parameter value not allowed');if(p&&!p.has(h))throw new ey('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==e.encrypted_key)try{n=ec(e.encrypted_key)}catch{throw new eb("Failed to base64url decode the encrypted_key")}let y=!1;"function"==typeof t&&(t=await t(i,e),y=!0),tc("dir"===d?h:d,t,"decrypt");let m=await e5(t,d);try{s=await tA(d,m,n,u,r)}catch(e){if(e instanceof TypeError||e instanceof eb||e instanceof em)throw e;s=e3(h)}if(void 0!==e.iv)try{a=ec(e.iv)}catch{throw new eb("Failed to base64url decode the iv")}if(void 0!==e.tag)try{o=ec(e.tag)}catch{throw new eb("Failed to base64url decode the tag")}let g=void 0!==e.protected?el(e.protected):new Uint8Array;l=void 0!==e.aad?en(g,el("."),el(e.aad)):g;try{c=ec(e.ciphertext)}catch{throw new eb("Failed to base64url decode the ciphertext")}let b={plaintext:await tt(h,s,c,a,o,l)};if(void 0!==e.protected&&(b.protectedHeader=i),void 0!==e.aad)try{b.additionalAuthenticatedData=ec(e.aad)}catch{throw new eb("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(b.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(b.unprotectedHeader=e.header),y)?{...b,key:m}:b}async function tx(e,t,r){if(e instanceof Uint8Array&&(e=ei.decode(e)),"string"!=typeof e)throw new eb("Compact JWE must be a string or Uint8Array");let{0:i,1:n,2:s,3:a,4:o,length:l}=e.split(".");if(5!==l)throw new eb("Invalid Compact JWE");let c=await tT({ciphertext:a,iv:s||void 0,protected:i,tag:o||void 0,encrypted_key:n||void 0},t,r),u={plaintext:c.plaintext,protectedHeader:c.protectedHeader};return"function"==typeof t?{...u,key:c.key}:u}async function tE(e,t,r){let i=await tx(e,t,r),n=function(e,t,r={}){var i,n;let s,a;try{s=JSON.parse(ei.decode(t))}catch{}if(!eZ(s))throw new ew("JWT Claims Set must be a top-level JSON object");let{typ:o}=r;if(o&&("string"!=typeof e.typ||tm(e.typ)!==tm(o)))throw new ef('unexpected "typ" JWT header value',s,"typ","check_failed");let{requiredClaims:l=[],issuer:c,subject:u,audience:d,maxTokenAge:h}=r,f=[...l];for(let e of(void 0!==h&&f.push("iat"),void 0!==d&&f.push("aud"),void 0!==u&&f.push("sub"),void 0!==c&&f.push("iss"),new Set(f.reverse())))if(!(e in s))throw new ef(`missing required "${e}" claim`,s,e,"missing");if(c&&!(Array.isArray(c)?c:[c]).includes(s.iss))throw new ef('unexpected "iss" claim value',s,"iss","check_failed");if(u&&s.sub!==u)throw new ef('unexpected "sub" claim value',s,"sub","check_failed");if(d&&(i=s.aud,n="string"==typeof d?[d]:d,"string"==typeof i?!n.includes(i):!(Array.isArray(i)&&n.some(Set.prototype.has.bind(new Set(i))))))throw new ef('unexpected "aud" claim value',s,"aud","check_failed");switch(typeof r.clockTolerance){case"string":a=tp(r.clockTolerance);break;case"number":a=r.clockTolerance;break;case"undefined":a=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:p}=r,y=th(p||new Date);if((void 0!==s.iat||h)&&"number"!=typeof s.iat)throw new ef('"iat" claim must be a number',s,"iat","invalid");if(void 0!==s.nbf){if("number"!=typeof s.nbf)throw new ef('"nbf" claim must be a number',s,"nbf","invalid");if(s.nbf>y+a)throw new ef('"nbf" claim timestamp check failed',s,"nbf","check_failed")}if(void 0!==s.exp){if("number"!=typeof s.exp)throw new ef('"exp" claim must be a number',s,"exp","invalid");if(s.exp<=y-a)throw new ep('"exp" claim timestamp check failed',s,"exp","check_failed")}if(h){let e=y-s.iat;if(e-a>("number"==typeof h?h:tp(h)))throw new ep('"iat" claim timestamp check failed (too far in the past)',s,"iat","check_failed");if(e<0-a)throw new ef('"iat" claim timestamp check failed (it should be in the past)',s,"iat","check_failed")}return s}(i.protectedHeader,i.plaintext,r),{protectedHeader:s}=i;if(void 0!==s.iss&&s.iss!==n.iss)throw new ef('replicated "iss" claim header parameter mismatch',n,"iss","mismatch");if(void 0!==s.sub&&s.sub!==n.sub)throw new ef('replicated "sub" claim header parameter mismatch',n,"sub","mismatch");if(void 0!==s.aud&&JSON.stringify(s.aud)!==JSON.stringify(n.aud))throw new ef('replicated "aud" claim header parameter mismatch',n,"aud","mismatch");let a={payload:n,protectedHeader:s};return"function"==typeof t?{...a,key:i.key}:a}let tC=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,tq=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,t$=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,tO=/^[\u0020-\u003A\u003D-\u007E]*$/,tP=Object.prototype.toString,tR=((a=function(){}).prototype=Object.create(null),a);function tI(e,t){let r=new tR,i=e.length;if(i<2)return r;let n=t?.decode||tN,s=0;do{let t=e.indexOf("=",s);if(-1===t)break;let a=e.indexOf(";",s),o=-1===a?i:a;if(t>o){s=e.lastIndexOf(";",t-1)+1;continue}let l=tU(e,s,t),c=tL(e,t,l),u=e.slice(l,c);if(void 0===r[u]){let i=tU(e,t+1,o),s=tL(e,o,i),a=n(e.slice(i,s));r[u]=a}s=o+1}while(s<i)return r}function tU(e,t,r){do{let r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r)return r}function tL(e,t,r){for(;t>r;){let r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function tj(e,t,r){let i=r?.encode||encodeURIComponent;if(!tC.test(e))throw TypeError(`argument name is invalid: ${e}`);let n=i(t);if(!tq.test(n))throw TypeError(`argument val is invalid: ${t}`);let s=e+"="+n;if(!r)return s;if(void 0!==r.maxAge){if(!Number.isInteger(r.maxAge))throw TypeError(`option maxAge is invalid: ${r.maxAge}`);s+="; Max-Age="+r.maxAge}if(r.domain){if(!t$.test(r.domain))throw TypeError(`option domain is invalid: ${r.domain}`);s+="; Domain="+r.domain}if(r.path){if(!tO.test(r.path))throw TypeError(`option path is invalid: ${r.path}`);s+="; Path="+r.path}if(r.expires){var a;if(a=r.expires,"[object Date]"!==tP.call(a)||!Number.isFinite(r.expires.valueOf()))throw TypeError(`option expires is invalid: ${r.expires}`);s+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.partitioned&&(s+="; Partitioned"),r.priority)switch("string"==typeof r.priority?r.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${r.sameSite}`)}return s}function tN(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}e.s(["parse",()=>tI,"serialize",()=>tj],45571);var tK=e.i(45571);let{parse:tD}=tK,tM="A256CBC-HS512";async function tB(e){let{token:t={},secret:r,maxAge:i=2592e3,salt:n}=e,s=Array.isArray(r)?r:[r],a=await tQ(tM,s[0],n),o=await t_({kty:"oct",k:tw.encode(a)},`sha${a.byteLength<<3}`);return await new tb(t).setProtectedHeader({alg:"dir",enc:tM,kid:o}).setIssuedAt().setExpirationTime((Date.now()/1e3|0)+i).setJti(crypto.randomUUID()).encrypt(a)}async function tH(e){let{token:t,secret:r,salt:i}=e,n=Array.isArray(r)?r:[r];if(!t)return null;let{payload:s}=await tE(t,async({kid:e,enc:t})=>{for(let r of n){let n=await tQ(t,r,i);if(void 0===e||e===await t_({kty:"oct",k:tw.encode(n)},`sha${n.byteLength<<3}`))return n}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:[tM,"A256GCM"]});return s}async function tQ(e,t,r){let i;switch(e){case"A256CBC-HS512":i=64;break;case"A256GCM":i=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await et("sha256",t,r,`Auth.js Generated Encryption Key (${r})`,i)}async function tW({options:e,paramValue:t,cookieValue:r}){let{url:i,callbacks:n}=e,s=i.origin;return t?s=await n.redirect({url:t,baseUrl:i.origin}):r&&(s=await n.redirect({url:r,baseUrl:i.origin})),{callbackUrl:s,callbackUrlCookie:s!==r?s:void 0}}let tJ="\x1b[31m",tF="\x1b[0m",tV={error(e){let t=e instanceof d?e.type:e.name;if(console.error(`${tJ}[auth][error]${tF} ${t}: ${e.message}`),e.cause&&"object"==typeof e.cause&&"err"in e.cause&&e.cause.err instanceof Error){let{err:t,...r}=e.cause;console.error(`${tJ}[auth][cause]${tF}:`,t.stack),r&&console.error(`${tJ}[auth][details]${tF}:`,JSON.stringify(r,null,2))}else e.stack&&console.error(e.stack.replace(/.*/,"").substring(1))},warn(e){console.warn(`\x1b[33m[auth][warn][${e}]${tF}`,"Read more: https://warnings.authjs.dev")},debug(e,t){console.log(`\x1b[90m[auth][debug]:${tF} ${e}`,JSON.stringify(t,null,2))}};function tz(e){let t={...tV};return e.debug||(t.debug=()=>{}),e.logger?.error&&(t.error=e.logger.error),e.logger?.warn&&(t.warn=e.logger.warn),e.logger?.debug&&(t.debug=e.logger.debug),e.logger??(e.logger=t),t}let tG=["providers","session","csrf","signin","signout","callback","verify-request","error","webauthn-options"],{parse:tX,serialize:tY}=tK;async function tZ(e){if(!("body"in e)||!e.body||"POST"!==e.method)return;let t=e.headers.get("content-type");return t?.includes("application/json")?await e.json():t?.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await e.text())):void 0}async function t0(e,t){try{if("GET"!==e.method&&"POST"!==e.method)throw new P("Only GET and POST requests are supported");t.basePath??(t.basePath="/auth");let r=new URL(e.url),{action:i,providerId:n}=function(e,t){let r=e.match(RegExp(`^${t}(.+)`));if(null===r)throw new P(`Cannot parse action at ${e}`);let i=r.at(-1).replace(/^\//,"").split("/").filter(Boolean);if(1!==i.length&&2!==i.length)throw new P(`Cannot parse action at ${e}`);let[n,s]=i;if(!tG.includes(n)||s&&!["signin","callback","webauthn-options"].includes(n))throw new P(`Cannot parse action at ${e}`);return{action:n,providerId:"undefined"==s?void 0:s}}(r.pathname,t.basePath);return{url:r,action:i,providerId:n,method:e.method,headers:Object.fromEntries(e.headers),body:e.body?await tZ(e):void 0,cookies:tX(e.headers.get("cookie")??"")??{},error:r.searchParams.get("error")??void 0,query:Object.fromEntries(r.searchParams)}}catch(i){let r=tz(t);r.error(i),r.debug("request",e)}}function t1(e){let t=new Headers(e.headers);e.cookies?.forEach(e=>{let{name:r,value:i,options:n}=e,s=tY(r,i,n);t.has("Set-Cookie")?t.append("Set-Cookie",s):t.set("Set-Cookie",s)});let r=e.body;"application/json"===t.get("content-type")?r=JSON.stringify(e.body):"application/x-www-form-urlencoded"===t.get("content-type")&&(r=new URLSearchParams(e.body).toString());let i=new Response(r,{headers:t,status:e.redirect?302:e.status??200});return e.redirect&&i.headers.set("Location",e.redirect),i}async function t2(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("").toString()}function t5(e){return Array.from(crypto.getRandomValues(new Uint8Array(e))).reduce((e,t)=>e+("0"+t.toString(16)).slice(-2),"")}async function t8({options:e,cookieValue:t,isPost:r,bodyValue:i}){if(t){let[n,s]=t.split("|");if(s===await t2(`${n}${e.secret}`))return{csrfTokenVerified:r&&n===i,csrfToken:n}}let n=t5(32),s=await t2(`${n}${e.secret}`);return{cookie:`${n}|${s}`,csrfToken:n}}function t3(e,t){if(!t)throw new j(`CSRF token was missing during an action ${e}`)}function t4(e){return null!==e&&"object"==typeof e}function t6(e,...t){if(!t.length)return e;let r=t.shift();if(t4(e)&&t4(r))for(let t in r)t4(r[t])?(t4(e[t])||(e[t]=Array.isArray(r[t])?[]:{}),t6(e[t],r[t])):void 0!==r[t]&&(e[t]=r[t]);return t6(e,...t)}let t9=Symbol("skip-csrf-check"),t7=Symbol("return-type-raw"),re=Symbol("custom-fetch"),rt=Symbol("conform-internal"),rr=e=>rn({id:e.sub??e.id??crypto.randomUUID(),name:e.name??e.nickname??e.preferred_username,email:e.email,image:e.picture}),ri=e=>rn({access_token:e.access_token,id_token:e.id_token,refresh_token:e.refresh_token,expires_at:e.expires_at,scope:e.scope,token_type:e.token_type,session_state:e.session_state});function rn(e){let t={};for(let[r,i]of Object.entries(e))void 0!==i&&(t[r]=i);return t}function rs(e,t){if(!e&&t)return;if("string"==typeof e)return{url:new URL(e)};let r=new URL(e?.url??"https://authjs.dev");if(e?.params!=null)for(let[t,i]of Object.entries(e.params))"claims"===t&&(i=JSON.stringify(i)),r.searchParams.set(t,String(i));return{url:r,request:e?.request,conform:e?.conform,...e?.clientPrivateKey?{clientPrivateKey:e?.clientPrivateKey}:null}}let ra={signIn:()=>!0,redirect:({url:e,baseUrl:t})=>e.startsWith("/")?`${t}${e}`:new URL(e).origin===t?e:t,session:({session:e})=>({user:{name:e.user?.name,email:e.user?.email,image:e.user?.image},expires:e.expires?.toISOString?.()??e.expires}),jwt:({token:e})=>e};async function ro({authOptions:e,providerId:t,action:r,url:i,cookies:n,callbackUrl:s,csrfToken:a,csrfDisabled:o,isPost:l}){var u,d;let h=tz(e),{providers:p,provider:y}=function(e){let{providerId:t,config:r}=e,i=new URL(r.basePath??"/auth",e.url.origin),n=r.providers.map(e=>{let t="function"==typeof e?e():e,{options:n,...s}=t,a=n?.id??s.id,o=t6(s,n,{signinUrl:`${i}/signin/${a}`,callbackUrl:`${i}/callback/${a}`});if("oauth"===t.type||"oidc"===t.type){var l;let e,t,i,s;o.redirectProxyUrl??(o.redirectProxyUrl=n?.redirectProxyUrl??r.redirectProxyUrl);let a=((l=o).issuer&&(l.wellKnown??(l.wellKnown=`${l.issuer}/.well-known/openid-configuration`)),(e=rs(l.authorization,l.issuer))&&!e.url?.searchParams.has("scope")&&e.url.searchParams.set("scope","openid profile email"),t=rs(l.token,l.issuer),i=rs(l.userinfo,l.issuer),s=l.checks??["pkce"],l.redirectProxyUrl&&(s.includes("state")||s.push("state"),l.redirectProxyUrl=`${l.redirectProxyUrl}/callback/${l.id}`),{...l,authorization:e,token:t,checks:s,userinfo:i,profile:l.profile??rr,account:l.account??ri});return a.authorization?.url.searchParams.get("response_mode")==="form_post"&&delete a.redirectProxyUrl,a[re]??(a[re]=n?.[re]),a}return o}),s=n.find(({id:e})=>e===t);if(t&&!s){let e=n.map(e=>e.id).join(", ");throw Error(`Provider with id "${t}" not found. Available providers: [${e}].`)}return{providers:n,provider:s}}({url:i,providerId:t,config:e}),m=!1;if((y?.type==="oauth"||y?.type==="oidc")&&y.redirectProxyUrl)try{m=new URL(y.redirectProxyUrl).origin===i.origin}catch{throw TypeError(`redirectProxyUrl must be a valid URL. Received: ${y.redirectProxyUrl}`)}let b={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...e,url:i,action:r,provider:y,cookies:t6(c(e.useSecureCookies??"https:"===i.protocol),e.cookies),providers:p,session:{strategy:e.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>crypto.randomUUID(),...e.session},jwt:{secret:e.secret,maxAge:e.session?.maxAge??2592e3,encode:tB,decode:tH,...e.jwt},events:(u=e.events??{},d=h,Object.keys(u).reduce((e,t)=>(e[t]=async(...e)=>{try{let r=u[t];return await r(...e)}catch(e){d.error(new g(e))}},e),{})),adapter:function(e,t){if(e)return Object.keys(e).reduce((r,i)=>(r[i]=async(...r)=>{try{t.debug(`adapter_${i}`,{args:r});let n=e[i];return await n(...r)}catch(r){let e=new f(r);throw t.error(e),e}},r),{})}(e.adapter,h),callbacks:{...ra,...e.callbacks},logger:h,callbackUrl:i.origin,isOnRedirectProxy:m,experimental:{...e.experimental}},w=[];if(o)b.csrfTokenVerified=!0;else{let{csrfToken:e,cookie:t,csrfTokenVerified:r}=await t8({options:b,cookieValue:n?.[b.cookies.csrfToken.name],isPost:l,bodyValue:a});b.csrfToken=e,b.csrfTokenVerified=r,t&&w.push({name:b.cookies.csrfToken.name,value:t,options:b.cookies.csrfToken.options})}let{callbackUrl:v,callbackUrlCookie:_}=await tW({options:b,cookieValue:n?.[b.cookies.callbackUrl.name],paramValue:s});return b.callbackUrl=v,_&&w.push({name:b.cookies.callbackUrl.name,value:_,options:b.cookies.callbackUrl.options}),{options:b,cookies:w}}var rl,rc,ru,rd,rh,rf,rp,ry,rm,rg,rb,rw,rv,r_,rS,rA,rk={},rT=[],rx=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,rE=Array.isArray;function rC(e,t){for(var r in t)e[r]=t[r];return e}function rq(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function r$(e,t,r,i,n){var s={type:e,props:t,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==n?++rm:n,__i:-1,__u:0};return null==n&&null!=ry.vnode&&ry.vnode(s),s}function rO(e){return e.children}function rP(e,t){this.props=e,this.context=t}function rR(e,t){if(null==t)return e.__?rR(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?rR(e):null}function rI(e){(!e.__d&&(e.__d=!0)&&rg.push(e)&&!rU.__r++||rb!==ry.debounceRendering)&&((rb=ry.debounceRendering)||rw)(rU)}function rU(){var e,t,r,i,n,s,a,o;for(rg.sort(rv);e=rg.shift();)e.__d&&(t=rg.length,i=void 0,s=(n=(r=e).__v).__e,a=[],o=[],r.__P&&((i=rC({},n)).__v=n.__v+1,ry.vnode&&ry.vnode(i),rD(r.__P,i,n,r.__n,r.__P.namespaceURI,32&n.__u?[s]:null,a,null==s?rR(n):s,!!(32&n.__u),o),i.__v=n.__v,i.__.__k[i.__i]=i,function(e,t,r){t.__d=void 0;for(var i=0;i<r.length;i++)rM(r[i],r[++i],r[++i]);ry.__c&&ry.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){ry.__e(e,t.__v)}})}(a,i,o),i.__e!=s&&function e(t){var r,i;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if(null!=(i=t.__k[r])&&null!=i.__e){t.__e=t.__c.base=i.__e;break}return e(t)}}(i)),rg.length>t&&rg.sort(rv));rU.__r=0}function rL(e,t,r,i,n,s,a,o,l,c,u){var d,h,f,p,y,m=i&&i.__k||rT,g=t.length;for(r.__d=l,function(e,t,r){var i,n,s,a,o,l=t.length,c=r.length,u=c,d=0;for(e.__k=[],i=0;i<l;i++)null!=(n=t[i])&&"boolean"!=typeof n&&"function"!=typeof n?(a=i+d,(n=e.__k[i]="string"==typeof n||"number"==typeof n||"bigint"==typeof n||n.constructor==String?r$(null,n,null,null,null):rE(n)?r$(rO,{children:n},null,null,null):void 0===n.constructor&&n.__b>0?r$(n.type,n.props,n.key,n.ref?n.ref:null,n.__v):n).__=e,n.__b=e.__b+1,s=null,-1!==(o=n.__i=function(e,t,r,i){var n=e.key,s=e.type,a=r-1,o=r+1,l=t[r];if(null===l||l&&n==l.key&&s===l.type&&0==(131072&l.__u))return r;if(i>+(null!=l&&0==(131072&l.__u)))for(;a>=0||o<t.length;){if(a>=0){if((l=t[a])&&0==(131072&l.__u)&&n==l.key&&s===l.type)return a;a--}if(o<t.length){if((l=t[o])&&0==(131072&l.__u)&&n==l.key&&s===l.type)return o;o++}}return -1}(n,r,a,u))&&(u--,(s=r[o])&&(s.__u|=131072)),null==s||null===s.__v?(-1==o&&d--,"function"!=typeof n.type&&(n.__u|=65536)):o!==a&&(o==a-1?d--:o==a+1?d++:(o>a?d--:d++,n.__u|=65536))):n=e.__k[i]=null;if(u)for(i=0;i<c;i++)null!=(s=r[i])&&0==(131072&s.__u)&&(s.__e==e.__d&&(e.__d=rR(s)),function e(t,r,i){var n,s;if(ry.unmount&&ry.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||rM(n,null,r)),null!=(n=t.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){ry.__e(e,r)}n.base=n.__P=null}if(n=t.__k)for(s=0;s<n.length;s++)n[s]&&e(n[s],r,i||"function"!=typeof t.type);i||rq(t.__e),t.__c=t.__=t.__e=t.__d=void 0}(s,s))}(r,t,m),l=r.__d,d=0;d<g;d++)null!=(f=r.__k[d])&&(h=-1===f.__i?rk:m[f.__i]||rk,f.__i=d,rD(e,f,h,n,s,a,o,l,c,u),p=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&rM(h.ref,null,f),u.push(f.ref,f.__c||p,f)),null==y&&null!=p&&(y=p),65536&f.__u||h.__k===f.__k?l=function e(t,r,i){var n,s;if("function"==typeof t.type){for(n=t.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=t,r=e(n[s],r,i));return r}t.__e!=r&&(r&&t.type&&!i.contains(r)&&(r=rR(t)),i.insertBefore(t.__e,r||null),r=t.__e);do r=r&&r.nextSibling;while(null!=r&&8===r.nodeType)return r}(f,l,e):"function"==typeof f.type&&void 0!==f.__d?l=f.__d:p&&(l=p.nextSibling),f.__d=void 0,f.__u&=-196609);r.__d=l,r.__e=y}function rj(e,t,r){"-"===t[0]?e.setProperty(t,null==r?"":r):e[t]=null==r?"":"number"!=typeof r||rx.test(t)?r:r+"px"}function rN(e,t,r,i,n){var s;e:if("style"===t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)r&&t in r||rj(e.style,t,"");if(r)for(t in r)i&&r[t]===i[t]||rj(e.style,t,r[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=r,r?i?r.u=i.u:(r.u=r_,e.addEventListener(t,s?rA:rS,s)):e.removeEventListener(t,s?rA:rS,s);else{if("http://www.w3.org/2000/svg"==n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==r?"":r))}}function rK(e){return function(t){if(this.l){var r=this.l[t.type+e];if(null==t.t)t.t=r_++;else if(t.t<r.u)return;return r(ry.event?ry.event(t):t)}}}function rD(e,t,r,i,n,s,a,o,l,c){var u,d,h,f,p,y,m,g,b,w,v,_,S,A,k,T,x=t.type;if(void 0!==t.constructor)return null;128&r.__u&&(l=!!(32&r.__u),s=[o=t.__e=r.__e]),(u=ry.__b)&&u(t);e:if("function"==typeof x)try{if(g=t.props,b="prototype"in x&&x.prototype.render,w=(u=x.contextType)&&i[u.__c],v=u?w?w.props.value:u.__:i,r.__c?m=(d=t.__c=r.__c).__=d.__E:(b?t.__c=d=new x(g,v):(t.__c=d=new rP(g,v),d.constructor=x,d.render=rB),w&&w.sub(d),d.props=g,d.state||(d.state={}),d.context=v,d.__n=i,h=d.__d=!0,d.__h=[],d._sb=[]),b&&null==d.__s&&(d.__s=d.state),b&&null!=x.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=rC({},d.__s)),rC(d.__s,x.getDerivedStateFromProps(g,d.__s))),f=d.props,p=d.state,d.__v=t,h)b&&null==x.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),b&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(b&&null==x.getDerivedStateFromProps&&g!==f&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(g,v),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(g,d.__s,v)||t.__v===r.__v)){for(t.__v!==r.__v&&(d.props=g,d.state=d.__s,d.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(e){e&&(e.__=t)}),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[],d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(g,d.__s,v),b&&null!=d.componentDidUpdate&&d.__h.push(function(){d.componentDidUpdate(f,p,y)})}if(d.context=v,d.props=g,d.__P=e,d.__e=!1,S=ry.__r,A=0,b){for(d.state=d.__s,d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),k=0;k<d._sb.length;k++)d.__h.push(d._sb[k]);d._sb=[]}else do d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++A<25)d.state=d.__s,null!=d.getChildContext&&(i=rC(rC({},i),d.getChildContext())),b&&!h&&null!=d.getSnapshotBeforeUpdate&&(y=d.getSnapshotBeforeUpdate(f,p)),rL(e,rE(T=null!=u&&u.type===rO&&null==u.key?u.props.children:u)?T:[T],t,r,i,n,s,a,o,l,c),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),m&&(d.__E=d.__=null)}catch(e){if(t.__v=null,l||null!=s){for(t.__u|=l?160:128;o&&8===o.nodeType&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else t.__e=r.__e,t.__k=r.__k;ry.__e(e,t,r)}else null==s&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=function(e,t,r,i,n,s,a,o,l){var c,u,d,h,f,p,y,m=r.props,g=t.props,b=t.type;if("svg"===b?n="http://www.w3.org/2000/svg":"math"===b?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),null!=s){for(c=0;c<s.length;c++)if((f=s[c])&&"setAttribute"in f==!!b&&(b?f.localName===b:3===f.nodeType)){e=f,s[c]=null;break}}if(null==e){if(null===b)return document.createTextNode(g);e=document.createElementNS(n,b,g.is&&g),o&&(ry.__m&&ry.__m(t,s),o=!1),s=null}if(null===b)m===g||o&&e.data===g||(e.data=g);else{if(s=s&&rp.call(e.childNodes),m=r.props||rk,!o&&null!=s)for(m={},c=0;c<e.attributes.length;c++)m[(f=e.attributes[c]).name]=f.value;for(c in m)if(f=m[c],"children"==c);else if("dangerouslySetInnerHTML"==c)d=f;else if(!(c in g)){if("value"==c&&"defaultValue"in g||"checked"==c&&"defaultChecked"in g)continue;rN(e,c,null,f,n)}for(c in g)f=g[c],"children"==c?h=f:"dangerouslySetInnerHTML"==c?u=f:"value"==c?p=f:"checked"==c?y=f:o&&"function"!=typeof f||m[c]===f||rN(e,c,f,m[c],n);if(u)o||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),rL(e,rE(h)?h:[h],t,r,i,"foreignObject"===b?"http://www.w3.org/1999/xhtml":n,s,a,s?s[0]:r.__k&&rR(r,0),o,l),null!=s)for(c=s.length;c--;)rq(s[c]);o||(c="value","progress"===b&&null==p?e.removeAttribute("value"):void 0===p||p===e[c]&&("progress"!==b||p)&&("option"!==b||p===m[c])||rN(e,c,p,m[c],n),c="checked",void 0!==y&&y!==e[c]&&rN(e,c,y,m[c],n))}return e}(r.__e,t,r,i,n,s,a,l,c);(u=ry.diffed)&&u(t)}function rM(e,t,r){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==t||(e.__u=e(t))}else e.current=t}catch(e){ry.__e(e,r)}}function rB(e,t,r){return this.constructor(e,r)}rp=rT.slice,ry={__e:function(e,t,r,i){for(var n,s,a;t=t.__;)if((n=t.__c)&&!n.__)try{if((s=n.constructor)&&null!=s.getDerivedStateFromError&&(n.setState(s.getDerivedStateFromError(e)),a=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e,i||{}),a=n.__d),a)return n.__E=n}catch(t){e=t}throw e}},rm=0,rP.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=rC({},this.state),"function"==typeof e&&(e=e(rC({},r),this.props)),e&&rC(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),rI(this))},rP.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),rI(this))},rP.prototype.render=rO,rg=[],rw="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,rv=function(e,t){return e.__v.__b-t.__v.__b},rU.__r=0,r_=0,rS=rK(!1),rA=rK(!0);var rH=/[\s\n\\/='"\0<>]/,rQ=/^(xlink|xmlns|xml)([A-Z])/,rW=/^accessK|^auto[A-Z]|^cell|^ch|^col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z]/,rJ=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,rF=new Set(["draggable","spellcheck"]),rV=/["&<]/;function rz(e){if(0===e.length||!1===rV.test(e))return e;for(var t=0,r=0,i="",n="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 60:n="&lt;";break;default:continue}r!==t&&(i+=e.slice(t,r)),i+=n,t=r+1}return r!==t&&(i+=e.slice(t,r)),i}var rG={},rX=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),rY=/[A-Z]/g;function rZ(){this.__d=!0}function r0(e,t,r){if(!e.s){if(r instanceof r3){if(!r.s)return void(r.o=r0.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(r0.bind(null,e,t),r0.bind(null,e,2));e.s=t,e.v=r;let i=e.o;i&&i(e)}}var r1,r2,r5,r8,r3=function(){function e(){}return e.prototype.then=function(t,r){var i=new e,n=this.s;if(n){var s=1&n?t:r;if(s){try{r0(i,1,s(this.v))}catch(e){r0(i,2,e)}return i}return this}return this.o=function(e){try{var n=e.v;1&e.s?r0(i,1,t?t(n):n):r?r0(i,1,r(n)):r0(i,2,n)}catch(e){r0(i,2,e)}},i},e}(),r4={},r6=[],r9=Array.isArray,r7=Object.assign;function ie(e,t){var r,i=e.type,n=!0;return e.__c?(n=!1,(r=e.__c).state=r.__s):r=new i(e.props,t),e.__c=r,r.__v=e,r.props=e.props,r.context=t,r.__d=!0,null==r.state&&(r.state=r4),null==r.__s&&(r.__s=r.state),i.getDerivedStateFromProps?r.state=r7({},r.state,i.getDerivedStateFromProps(r.props,r.state)):n&&r.componentWillMount?(r.componentWillMount(),r.state=r.__s!==r.state?r.__s:r.state):!n&&r.componentWillUpdate&&r.componentWillUpdate(),r5&&r5(e),r.render(r.props,r.state,t)}var it=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),ir=0;function ii(e,t,r,i,n,s){t||(t={});var a,o,l=t;"ref"in t&&(a=t.ref,delete t.ref);var c={type:e,props:l,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--ir,__i:-1,__u:0,__source:n,__self:s};if("function"==typeof e&&(a=e.defaultProps))for(o in a)void 0===l[o]&&(l[o]=a[o]);return ry.vnode&&ry.vnode(c),c}async function is(e,t){let r=window.SimpleWebAuthnBrowser;async function i(r){let i=new URL(`${e}/webauthn-options/${t}`);r&&i.searchParams.append("action",r),s().forEach(e=>{i.searchParams.append(e.name,e.value)});let n=await fetch(i);return n.ok?n.json():void console.error("Failed to fetch options",n)}function n(){let e=`#${t}-form`,r=document.querySelector(e);if(!r)throw Error(`Form '${e}' not found`);return r}function s(){return Array.from(n().querySelectorAll("input[data-form-field]"))}async function a(e,t){let r=n();if(e){let t=document.createElement("input");t.type="hidden",t.name="action",t.value=e,r.appendChild(t)}if(t){let e=document.createElement("input");e.type="hidden",e.name="data",e.value=JSON.stringify(t),r.appendChild(e)}return r.submit()}async function o(e,t){let i=await r.startAuthentication(e,t);return await a("authenticate",i)}async function l(e){s().forEach(e=>{if(e.required&&!e.value)throw Error(`Missing required field: ${e.name}`)});let t=await r.startRegistration(e);return await a("register",t)}async function c(){if(!r.browserSupportsWebAuthnAutofill())return;let e=await i("authenticate");if(!e)return void console.error("Failed to fetch option for autofill authentication");try{await o(e.options,!0)}catch(e){console.error(e)}}(async function(){let e=n();if(!r.browserSupportsWebAuthn()){e.style.display="none";return}e&&e.addEventListener("submit",async e=>{e.preventDefault();let t=await i(void 0);if(!t)return void console.error("Failed to fetch options for form submission");if("authenticate"===t.action)try{await o(t.options,!1)}catch(e){console.error(e)}else if("register"===t.action)try{await l(t.options)}catch(e){console.error(e)}})})(),c()}let ia={default:"Unable to sign in.",Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallbackError:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page."},io=`:root {
  --border-width: 1px;
  --border-radius: 0.5rem;
  --color-error: #c94b4b;
  --color-info: #157efb;
  --color-info-hover: #0f6ddb;
  --color-info-text: #fff;
}

.__next-auth-theme-auto,
.__next-auth-theme-light {
  --color-background: #ececec;
  --color-background-hover: rgba(236, 236, 236, 0.8);
  --color-background-card: #fff;
  --color-text: #000;
  --color-primary: #444;
  --color-control-border: #bbb;
  --color-button-active-background: #f9f9f9;
  --color-button-active-border: #aaa;
  --color-separator: #ccc;
  --provider-bg: #fff;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #fff
  );
}

.__next-auth-theme-dark {
  --color-background: #161b22;
  --color-background-hover: rgba(22, 27, 34, 0.8);
  --color-background-card: #0d1117;
  --color-text: #fff;
  --color-primary: #ccc;
  --color-control-border: #555;
  --color-button-active-background: #060606;
  --color-button-active-border: #666;
  --color-separator: #444;
  --provider-bg: #161b22;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #000
  );
}

.__next-auth-theme-dark img[src$="42-school.svg"],
  .__next-auth-theme-dark img[src$="apple.svg"],
  .__next-auth-theme-dark img[src$="boxyhq-saml.svg"],
  .__next-auth-theme-dark img[src$="eveonline.svg"],
  .__next-auth-theme-dark img[src$="github.svg"],
  .__next-auth-theme-dark img[src$="mailchimp.svg"],
  .__next-auth-theme-dark img[src$="medium.svg"],
  .__next-auth-theme-dark img[src$="okta.svg"],
  .__next-auth-theme-dark img[src$="patreon.svg"],
  .__next-auth-theme-dark img[src$="ping-id.svg"],
  .__next-auth-theme-dark img[src$="roblox.svg"],
  .__next-auth-theme-dark img[src$="threads.svg"],
  .__next-auth-theme-dark img[src$="wikimedia.svg"] {
    filter: invert(1);
  }

.__next-auth-theme-dark #submitButton {
    background-color: var(--provider-bg, var(--color-info));
  }

@media (prefers-color-scheme: dark) {
  .__next-auth-theme-auto {
    --color-background: #161b22;
    --color-background-hover: rgba(22, 27, 34, 0.8);
    --color-background-card: #0d1117;
    --color-text: #fff;
    --color-primary: #ccc;
    --color-control-border: #555;
    --color-button-active-background: #060606;
    --color-button-active-border: #666;
    --color-separator: #444;
    --provider-bg: #161b22;
    --provider-bg-hover: color-mix(
      in srgb,
      var(--provider-brand-color) 30%,
      #000
    );
  }
    .__next-auth-theme-auto img[src$="42-school.svg"],
    .__next-auth-theme-auto img[src$="apple.svg"],
    .__next-auth-theme-auto img[src$="boxyhq-saml.svg"],
    .__next-auth-theme-auto img[src$="eveonline.svg"],
    .__next-auth-theme-auto img[src$="github.svg"],
    .__next-auth-theme-auto img[src$="mailchimp.svg"],
    .__next-auth-theme-auto img[src$="medium.svg"],
    .__next-auth-theme-auto img[src$="okta.svg"],
    .__next-auth-theme-auto img[src$="patreon.svg"],
    .__next-auth-theme-auto img[src$="ping-id.svg"],
    .__next-auth-theme-auto img[src$="roblox.svg"],
    .__next-auth-theme-auto img[src$="threads.svg"],
    .__next-auth-theme-auto img[src$="wikimedia.svg"] {
      filter: invert(1);
    }
    .__next-auth-theme-auto #submitButton {
      background-color: var(--provider-bg, var(--color-info));
    }
}

html {
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--color-background);
  margin: 0;
  padding: 0;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";
}

h1 {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  font-weight: 400;
  color: var(--color-text);
}

p {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  color: var(--color-text);
}

form {
  margin: 0;
  padding: 0;
}

label {
  font-weight: 500;
  text-align: left;
  margin-bottom: 0.25rem;
  display: block;
  color: var(--color-text);
}

input[type] {
  box-sizing: border-box;
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  border: var(--border-width) solid var(--color-control-border);
  background: var(--color-background-card);
  font-size: 1rem;
  border-radius: var(--border-radius);
  color: var(--color-text);
}

p {
  font-size: 1.1rem;
  line-height: 2rem;
}

a.button {
  text-decoration: none;
  line-height: 1rem;
}

a.button:link,
  a.button:visited {
    background-color: var(--color-background);
    color: var(--color-primary);
  }

button,
a.button {
  padding: 0.75rem 1rem;
  color: var(--provider-color, var(--color-primary));
  background-color: var(--provider-bg, var(--color-background));
  border: 1px solid #00000031;
  font-size: 0.9rem;
  height: 50px;
  border-radius: var(--border-radius);
  transition: background-color 250ms ease-in-out;
  font-weight: 300;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:is(button,a.button):hover {
    background-color: var(--provider-bg-hover, var(--color-background-hover));
    cursor: pointer;
  }

:is(button,a.button):active {
    cursor: pointer;
  }

:is(button,a.button) span {
    color: var(--provider-bg);
  }

#submitButton {
  color: var(--button-text-color, var(--color-info-text));
  background-color: var(--brand-color, var(--color-info));
  width: 100%;
}

#submitButton:hover {
    background-color: var(
      --button-hover-bg,
      var(--color-info-hover)
    ) !important;
  }

a.site {
  color: var(--color-primary);
  text-decoration: none;
  font-size: 1rem;
  line-height: 2rem;
}

a.site:hover {
    text-decoration: underline;
  }

.page {
  position: absolute;
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.page > div {
    text-align: center;
  }

.error a.button {
    padding-left: 2rem;
    padding-right: 2rem;
    margin-top: 0.5rem;
  }

.error .message {
    margin-bottom: 1.5rem;
  }

.signin input[type="text"] {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }

.signin hr {
    display: block;
    border: 0;
    border-top: 1px solid var(--color-separator);
    margin: 2rem auto 1rem auto;
    overflow: visible;
  }

.signin hr::before {
      content: "or";
      background: var(--color-background-card);
      color: #888;
      padding: 0 0.4rem;
      position: relative;
      top: -0.7rem;
    }

.signin .error {
    background: #f5f5f5;
    font-weight: 500;
    border-radius: 0.3rem;
    background: var(--color-error);
  }

.signin .error p {
      text-align: left;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      line-height: 1.2rem;
      color: var(--color-info-text);
    }

.signin > div,
  .signin form {
    display: block;
  }

.signin > div input[type], .signin form input[type] {
      margin-bottom: 0.5rem;
    }

.signin > div button, .signin form button {
      width: 100%;
    }

.signin .provider + .provider {
    margin-top: 1rem;
  }

.logo {
  display: inline-block;
  max-width: 150px;
  margin: 1.25rem 0;
  max-height: 70px;
}

.card {
  background-color: var(--color-background-card);
  border-radius: 1rem;
  padding: 1.25rem 2rem;
}

.card .header {
    color: var(--color-primary);
  }

.card input[type]::-moz-placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type]::placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type] {
    background: color-mix(in srgb, var(--color-background-card) 95%, black);
  }

.section-header {
  color: var(--color-text);
}

@media screen and (min-width: 450px) {
  .card {
    margin: 2rem 0;
    width: 368px;
  }
}

@media screen and (max-width: 450px) {
  .card {
    margin: 1rem 0;
    width: 343px;
  }
}
`;function il({html:e,title:t,status:r,cookies:i,theme:n,headTags:s}){return{cookies:i,status:r,headers:{"Content-Type":"text/html"},body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${io}</style><title>${t}</title>${s??""}</head><body class="__next-auth-theme-${n?.colorScheme??"auto"}"><div class="page">${function(e,t,r){var i=ry.__s;ry.__s=!0,r1=ry.__b,r2=ry.diffed,r5=ry.__r,r8=ry.unmount;var n=function(e,t,r){var i,n,s,a={};for(s in t)"key"==s?i=t[s]:"ref"==s?n=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?rp.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return r$(e,a,i,n,null)}(rO,null);n.__k=[e];try{var s=function e(t,r,i,n,s,a,o){if(null==t||!0===t||!1===t||""===t)return"";var l=typeof t;if("object"!=l)return"function"==l?"":"string"==l?rz(t):t+"";if(r9(t)){var c,u="";s.__k=t;for(var d=0;d<t.length;d++){var h=t[d];if(null!=h&&"boolean"!=typeof h){var f,p=e(h,r,i,n,s,a,o);"string"==typeof p?u+=p:(c||(c=[]),u&&c.push(u),u="",r9(p)?(f=c).push.apply(f,p):c.push(p))}}return c?(u&&c.push(u),c):u}if(void 0!==t.constructor)return"";t.__=s,r1&&r1(t);var y=t.type,m=t.props;if("function"==typeof y){var g,b,w,v=r;if(y===rO){if("tpl"in m){for(var _="",S=0;S<m.tpl.length;S++)if(_+=m.tpl[S],m.exprs&&S<m.exprs.length){var A=m.exprs[S];if(null==A)continue;"object"==typeof A&&(void 0===A.constructor||r9(A))?_+=e(A,r,i,n,t,a,o):_+=A}return _}if("UNSTABLE_comment"in m)return"<!--"+rz(m.UNSTABLE_comment)+"-->";b=m.children}else{if(null!=(g=y.contextType)){var k=r[g.__c];v=k?k.props.value:g.__}var T=y.prototype&&"function"==typeof y.prototype.render;if(T)b=ie(t,v),w=t.__c;else{t.__c=w={__v:t,context:v,props:t.props,setState:rZ,forceUpdate:rZ,__d:!0,__h:[]};for(var x=0;w.__d&&x++<25;)w.__d=!1,r5&&r5(t),b=y.call(w,m,v);w.__d=!0}if(null!=w.getChildContext&&(r=r7({},r,w.getChildContext())),T&&ry.errorBoundaries&&(y.getDerivedStateFromError||w.componentDidCatch)){b=null!=b&&b.type===rO&&null==b.key&&null==b.props.tpl?b.props.children:b;try{return e(b,r,i,n,t,a,o)}catch(s){return y.getDerivedStateFromError&&(w.__s=y.getDerivedStateFromError(s)),w.componentDidCatch&&w.componentDidCatch(s,r4),w.__d?(b=ie(t,r),null!=(w=t.__c).getChildContext&&(r=r7({},r,w.getChildContext())),e(b=null!=b&&b.type===rO&&null==b.key&&null==b.props.tpl?b.props.children:b,r,i,n,t,a,o)):""}finally{r2&&r2(t),t.__=null,r8&&r8(t)}}}b=null!=b&&b.type===rO&&null==b.key&&null==b.props.tpl?b.props.children:b;try{var E=e(b,r,i,n,t,a,o);return r2&&r2(t),t.__=null,ry.unmount&&ry.unmount(t),E}catch(s){if(!a&&o&&o.onError){var C=o.onError(s,t,function(s){return e(s,r,i,n,t,a,o)});if(void 0!==C)return C;var q=ry.__e;return q&&q(s,t),""}if(!a||!s||"function"!=typeof s.then)throw s;return s.then(function s(){try{return e(b,r,i,n,t,a,o)}catch(l){if(!l||"function"!=typeof l.then)throw l;return l.then(function(){return e(b,r,i,n,t,a,o)},s)}})}}var $,O="<"+y,P="";for(var R in m){var I=m[R];if("function"!=typeof I||"class"===R||"className"===R){switch(R){case"children":$=I;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in m)continue;R="for";break;case"className":if("class"in m)continue;R="class";break;case"defaultChecked":R="checked";break;case"defaultSelected":R="selected";break;case"defaultValue":case"value":switch(R="value",y){case"textarea":$=I;continue;case"select":n=I;continue;case"option":n!=I||"selected"in m||(O+=" selected")}break;case"dangerouslySetInnerHTML":P=I&&I.__html;continue;case"style":"object"==typeof I&&(I=function(e){var t="";for(var r in e){var i=e[r];if(null!=i&&""!==i){var n="-"==r[0]?r:rG[r]||(rG[r]=r.replace(rY,"-$&").toLowerCase()),s=";";"number"!=typeof i||n.startsWith("--")||rX.has(n)||(s="px;"),t=t+n+":"+i+s}}return t||void 0}(I));break;case"acceptCharset":R="accept-charset";break;case"httpEquiv":R="http-equiv";break;default:if(rQ.test(R))R=R.replace(rQ,"$1:$2").toLowerCase();else{if(rH.test(R))continue;("-"===R[4]||rF.has(R))&&null!=I?I+="":i?rJ.test(R)&&(R="panose1"===R?"panose-1":R.replace(/([A-Z])/g,"-$1").toLowerCase()):rW.test(R)&&(R=R.toLowerCase())}}null!=I&&!1!==I&&(O=!0===I||""===I?O+" "+R:O+" "+R+'="'+("string"==typeof I?rz(I):I+"")+'"')}}if(rH.test(y))throw Error(y+" is not a valid HTML tag name in "+O+">");if(P||("string"==typeof $?P=rz($):null!=$&&!1!==$&&!0!==$&&(P=e($,r,"svg"===y||"foreignObject"!==y&&i,n,t,a,o))),r2&&r2(t),t.__=null,r8&&r8(t),!P&&it.has(y))return O+"/>";var U="</"+y+">",L=O+">";return r9(P)?[L].concat(P,[U]):"string"!=typeof P?[L,P,U]:L+P+U}(e,r4,!1,void 0,n,!1,void 0);return r9(s)?s.join(""):s}catch(e){if(e.then)throw Error('Use "renderToStringAsync" for suspenseful rendering.');throw e}finally{ry.__c&&ry.__c(e,r6),ry.__s=i,r6.length=0}}(e)}</div></body></html>`}}function ic(e){let{url:t,theme:r,query:i,cookies:n,pages:s,providers:a}=e;return{csrf:(e,t,r)=>e?(t.logger.warn("csrf-disabled"),r.push({name:t.cookies.csrfToken.name,value:"",options:{...t.cookies.csrfToken.options,maxAge:0}}),{status:404,cookies:r}):{headers:{"Content-Type":"application/json","Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"},body:{csrfToken:t.csrfToken},cookies:r},providers:e=>({headers:{"Content-Type":"application/json"},body:e.reduce((e,{id:t,name:r,type:i,signinUrl:n,callbackUrl:s})=>(e[t]={id:t,name:r,type:i,signinUrl:n,callbackUrl:s},e),{})}),signin(t,o){if(t)throw new P("Unsupported action");if(s?.signIn){let t=`${s.signIn}${s.signIn.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:e.callbackUrl??"/"})}`;return o&&(t=`${t}&${new URLSearchParams({error:o})}`),{redirect:t,cookies:n}}let l=a?.find(e=>"webauthn"===e.type&&e.enableConditionalUI&&!!e.simpleWebAuthnBrowserVersion),c="";if(l){let{simpleWebAuthnBrowserVersion:e}=l;c=`<script src="https://unpkg.com/@simplewebauthn/browser@${e}/dist/bundle/index.umd.min.js" crossorigin="anonymous"></script>`}return il({cookies:n,theme:r,html:function(e){let{csrfToken:t,providers:r=[],callbackUrl:i,theme:n,email:s,error:a}=e;"undefined"!=typeof document&&n?.brandColor&&document.documentElement.style.setProperty("--brand-color",n.brandColor),"undefined"!=typeof document&&n?.buttonText&&document.documentElement.style.setProperty("--button-text-color",n.buttonText);let o=a&&(ia[a]??ia.default),l=r.find(e=>"webauthn"===e.type&&e.enableConditionalUI)?.id;return ii("div",{className:"signin",children:[n?.brandColor&&ii("style",{dangerouslySetInnerHTML:{__html:`:root {--brand-color: ${n.brandColor}}`}}),n?.buttonText&&ii("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${n.buttonText}
        }
      `}}),ii("div",{className:"card",children:[o&&ii("div",{className:"error",children:ii("p",{children:o})}),n?.logo&&ii("img",{src:n.logo,alt:"Logo",className:"logo"}),r.map((e,n)=>{let a,o,l;("oauth"===e.type||"oidc"===e.type)&&({bg:a="#fff",brandColor:o,logo:l=`https://authjs.dev/img/providers/${e.id}.svg`}=e.style??{});let c=o??a??"#fff";return ii("div",{className:"provider",children:["oauth"===e.type||"oidc"===e.type?ii("form",{action:e.signinUrl,method:"POST",children:[ii("input",{type:"hidden",name:"csrfToken",value:t}),i&&ii("input",{type:"hidden",name:"callbackUrl",value:i}),ii("button",{type:"submit",className:"button",style:{"--provider-brand-color":c},tabIndex:0,children:[ii("span",{style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)","mix-blend-mode":"luminosity",opacity:.95},children:["Sign in with ",e.name]}),l&&ii("img",{loading:"lazy",height:24,src:l})]})]}):null,("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&n>0&&"email"!==r[n-1].type&&"credentials"!==r[n-1].type&&"webauthn"!==r[n-1].type&&ii("hr",{}),"email"===e.type&&ii("form",{action:e.signinUrl,method:"POST",children:[ii("input",{type:"hidden",name:"csrfToken",value:t}),ii("label",{className:"section-header",htmlFor:`input-email-for-${e.id}-provider`,children:"Email"}),ii("input",{id:`input-email-for-${e.id}-provider`,autoFocus:!0,type:"email",name:"email",value:s,placeholder:"email@example.com",required:!0}),ii("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"credentials"===e.type&&ii("form",{action:e.callbackUrl,method:"POST",children:[ii("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.credentials).map(t=>ii("div",{children:[ii("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.credentials[t].label??t}),ii("input",{name:t,id:`input-${t}-for-${e.id}-provider`,type:e.credentials[t].type??"text",placeholder:e.credentials[t].placeholder??"",...e.credentials[t]})]},`input-group-${e.id}`)),ii("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"webauthn"===e.type&&ii("form",{action:e.callbackUrl,method:"POST",id:`${e.id}-form`,children:[ii("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.formFields).map(t=>ii("div",{children:[ii("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.formFields[t].label??t}),ii("input",{name:t,"data-form-field":!0,id:`input-${t}-for-${e.id}-provider`,type:e.formFields[t].type??"text",placeholder:e.formFields[t].placeholder??"",...e.formFields[t]})]},`input-group-${e.id}`)),ii("button",{id:`submitButton-${e.id}`,type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&n+1<r.length&&ii("hr",{})]},e.id)})]}),l&&ii(rO,{children:ii("script",{dangerouslySetInnerHTML:{__html:`
const currentURL = window.location.href;
const authURL = currentURL.substring(0, currentURL.lastIndexOf('/'));
(${is})(authURL, "${l}");
`}})})]})}({csrfToken:e.csrfToken,providers:e.providers?.filter(e=>["email","oauth","oidc"].includes(e.type)||"credentials"===e.type&&e.credentials||"webauthn"===e.type&&e.formFields||!1),callbackUrl:e.callbackUrl,theme:e.theme,error:o,...i}),title:"Sign In",headTags:c})},signout:()=>s?.signOut?{redirect:s.signOut,cookies:n}:il({cookies:n,theme:r,html:function(e){let{url:t,csrfToken:r,theme:i}=e;return ii("div",{className:"signout",children:[i?.brandColor&&ii("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${i.brandColor}
        }
      `}}),i?.buttonText&&ii("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${i.buttonText}
        }
      `}}),ii("div",{className:"card",children:[i?.logo&&ii("img",{src:i.logo,alt:"Logo",className:"logo"}),ii("h1",{children:"Signout"}),ii("p",{children:"Are you sure you want to sign out?"}),ii("form",{action:t?.toString(),method:"POST",children:[ii("input",{type:"hidden",name:"csrfToken",value:r}),ii("button",{id:"submitButton",type:"submit",children:"Sign out"})]})]})]})}({csrfToken:e.csrfToken,url:t,theme:r}),title:"Sign Out"}),verifyRequest:e=>s?.verifyRequest?{redirect:`${s.verifyRequest}${t?.search??""}`,cookies:n}:il({cookies:n,theme:r,html:function(e){let{url:t,theme:r}=e;return ii("div",{className:"verify-request",children:[r.brandColor&&ii("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${r.brandColor}
        }
      `}}),ii("div",{className:"card",children:[r.logo&&ii("img",{src:r.logo,alt:"Logo",className:"logo"}),ii("h1",{children:"Check your email"}),ii("p",{children:"A sign in link has been sent to your email address."}),ii("p",{children:ii("a",{className:"site",href:t.origin,children:t.host})})]})]})}({url:t,theme:r,...e}),title:"Verify Request"}),error:e=>s?.error?{redirect:`${s.error}${s.error.includes("?")?"&":"?"}error=${e}`,cookies:n}:il({cookies:n,theme:r,...function(e){let{url:t,error:r="default",theme:i}=e,n=`${t}/signin`,s={default:{status:200,heading:"Error",message:ii("p",{children:ii("a",{className:"site",href:t?.origin,children:t?.host})})},Configuration:{status:500,heading:"Server error",message:ii("div",{children:[ii("p",{children:"There is a problem with the server configuration."}),ii("p",{children:"Check the server logs for more information."})]})},AccessDenied:{status:403,heading:"Access Denied",message:ii("div",{children:[ii("p",{children:"You do not have permission to sign in."}),ii("p",{children:ii("a",{className:"button",href:n,children:"Sign in"})})]})},Verification:{status:403,heading:"Unable to sign in",message:ii("div",{children:[ii("p",{children:"The sign in link is no longer valid."}),ii("p",{children:"It may have been used already or it may have expired."})]}),signin:ii("a",{className:"button",href:n,children:"Sign in"})}},{status:a,heading:o,message:l,signin:c}=s[r]??s.default;return{status:a,html:ii("div",{className:"error",children:[i?.brandColor&&ii("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${i?.brandColor}
        }
      `}}),ii("div",{className:"card",children:[i?.logo&&ii("img",{src:i?.logo,alt:"Logo",className:"logo"}),ii("h1",{children:o}),ii("div",{className:"message",children:l}),c]})]})}}({url:t,theme:r,error:e}),title:"Error"})}}function iu(e,t=Date.now()){return new Date(t+1e3*e)}async function id(e,t,r,i){if(!r?.providerAccountId||!r.type)throw Error("Missing or invalid provider account");if(!["email","oauth","oidc","webauthn"].includes(r.type))throw Error("Provider not supported");let{adapter:n,jwt:s,events:a,session:{strategy:o,generateSessionToken:l}}=i;if(!n)return{user:t,account:r};let c=r,{createUser:u,updateUser:d,getUser:h,getUserByAccount:f,getUserByEmail:p,linkAccount:y,createSession:m,getSessionAndUser:g,deleteSession:b}=n,w=null,v=null,_=!1,S="jwt"===o;if(e)if(S)try{let t=i.cookies.sessionToken.name;(w=await s.decode({...s,token:e,salt:t}))&&"sub"in w&&w.sub&&(v=await h(w.sub))}catch{}else{let t=await g(e);t&&(w=t.session,v=t.user)}if("email"===c.type){let r=await p(t.email);return r?(v?.id!==r.id&&!S&&e&&await b(e),v=await d({id:r.id,emailVerified:new Date}),await a.updateUser?.({user:v})):(v=await u({...t,emailVerified:new Date}),await a.createUser?.({user:v}),_=!0),{session:w=S?{}:await m({sessionToken:l(),userId:v.id,expires:iu(i.session.maxAge)}),user:v,isNewUser:_}}if("webauthn"===c.type){let e=await f({providerAccountId:c.providerAccountId,provider:c.provider});if(e){if(v){if(e.id===v.id){let e={...c,userId:v.id};return{session:w,user:v,isNewUser:_,account:e}}throw new B("The account is already associated with another user",{provider:c.provider})}w=S?{}:await m({sessionToken:l(),userId:e.id,expires:iu(i.session.maxAge)});let t={...c,userId:e.id};return{session:w,user:e,isNewUser:_,account:t}}{if(v){await y({...c,userId:v.id}),await a.linkAccount?.({user:v,account:c,profile:t});let e={...c,userId:v.id};return{session:w,user:v,isNewUser:_,account:e}}if(t.email?await p(t.email):null)throw new B("Another account already exists with the same e-mail address",{provider:c.provider});v=await u({...t}),await a.createUser?.({user:v}),await y({...c,userId:v.id}),await a.linkAccount?.({user:v,account:c,profile:t}),w=S?{}:await m({sessionToken:l(),userId:v.id,expires:iu(i.session.maxAge)});let e={...c,userId:v.id};return{session:w,user:v,isNewUser:!0,account:e}}}let A=await f({providerAccountId:c.providerAccountId,provider:c.provider});if(A){if(v){if(A.id===v.id)return{session:w,user:v,isNewUser:_};throw new E("The account is already associated with another user",{provider:c.provider})}return{session:w=S?{}:await m({sessionToken:l(),userId:A.id,expires:iu(i.session.maxAge)}),user:A,isNewUser:_}}{let{provider:e}=i,{type:r,provider:n,providerAccountId:s,userId:o,...d}=c;if(c=Object.assign(e.account(d)??{},{providerAccountId:s,provider:n,type:r,userId:o}),v)return await y({...c,userId:v.id}),await a.linkAccount?.({user:v,account:c,profile:t}),{session:w,user:v,isNewUser:_};let h=t.email?await p(t.email):null;if(h){let e=i.provider;if(e?.allowDangerousEmailAccountLinking)v=h,_=!1;else throw new E("Another account already exists with the same e-mail address",{provider:c.provider})}else v=await u({...t,emailVerified:null}),_=!0;return await a.createUser?.({user:v}),await y({...c,userId:v.id}),await a.linkAccount?.({user:v,account:c,profile:t}),{session:w=S?{}:await m({sessionToken:l(),userId:v.id,expires:iu(i.session.maxAge)}),user:v,isNewUser:_}}}function ih(e,t){if(null==e)return!1;try{return e instanceof t||Object.getPrototypeOf(e)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(i="oauth4webapi/v3.8.3");let ip="ERR_INVALID_ARG_VALUE",iy="ERR_INVALID_ARG_TYPE";function im(e,t,r){let i=TypeError(e,{cause:r});return Object.assign(i,{code:t}),i}let ig=Symbol(),ib=Symbol(),iw=Symbol(),iv=Symbol(),i_=Symbol(),iS=Symbol();Symbol();let iA=new TextEncoder,ik=new TextDecoder;function iT(e){return"string"==typeof e?iA.encode(e):ik.decode(e)}function ix(e){return"string"==typeof e?s(e):n(e)}n=Uint8Array.prototype.toBase64?e=>(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e.toBase64({alphabet:"base64url",omitPadding:!0})):e=>{e instanceof ArrayBuffer&&(e=new Uint8Array(e));let t=[];for(let r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},s=Uint8Array.fromBase64?e=>{try{return Uint8Array.fromBase64(e,{alphabet:"base64url"})}catch(e){throw im("The input to be decoded is not correctly encoded.",ip,e)}}:e=>{try{let t=atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}catch(e){throw im("The input to be decoded is not correctly encoded.",ip,e)}};class iE extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=nC,Error.captureStackTrace?.(this,this.constructor)}}class iC extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,t?.code&&(this.code=t?.code),Error.captureStackTrace?.(this,this.constructor)}}function iq(e,t,r){return new iC(e,{code:t,cause:r})}function i$(e){return!(null===e||"object"!=typeof e||Array.isArray(e))}function iO(e){ih(e,Headers)&&(e=Object.fromEntries(e.entries()));let t=new Headers(e??{});if(i&&!t.has("user-agent")&&t.set("user-agent",i),t.has("authorization"))throw im('"options.headers" must not include the "authorization" header name',ip);return t}function iP(e,t){if(void 0!==t){if("function"==typeof t&&(t=t(e.href)),!(t instanceof AbortSignal))throw im('"options.signal" must return or be an instance of AbortSignal',iy);return t}}function iR(e){return e.includes("//")?e.replace("//","/"):e}async function iI(e,t,r,i){if(!(e instanceof URL))throw im(`"${t}" must be an instance of URL`,iy);iG(e,i?.[ig]!==!0);let n=r(new URL(e.href)),s=iO(i?.headers);return s.set("accept","application/json"),(i?.[iv]||fetch)(n.href,{body:void 0,headers:Object.fromEntries(s.entries()),method:"GET",redirect:"manual",signal:iP(n,i?.signal)})}async function iU(e,t){return iI(e,"issuerIdentifier",e=>{switch(t?.algorithm){case void 0:case"oidc":e.pathname=iR(`${e.pathname}/.well-known/openid-configuration`);break;case"oauth2":!function(e,t,r=!1){"/"===e.pathname?e.pathname=t:e.pathname=iR(`${t}/${r?e.pathname:e.pathname.replace(/(\/)$/,"")}`)}(e,".well-known/oauth-authorization-server");break;default:throw im('"options.algorithm" must be "oidc" (default), or "oauth2"',ip)}return e},t)}function iL(e,t,r,i,n){try{if("number"!=typeof e||!Number.isFinite(e))throw im(`${r} must be a number`,iy,n);if(e>0)return;if(t){if(0!==e)throw im(`${r} must be a non-negative number`,ip,n);return}throw im(`${r} must be a positive number`,ip,n)}catch(e){if(i)throw iq(e.message,i,n);throw e}}function ij(e,t,r,i){try{if("string"!=typeof e)throw im(`${t} must be a string`,iy,i);if(0===e.length)throw im(`${t} must not be empty`,ip,i)}catch(e){if(r)throw iq(e.message,r,i);throw e}}async function iN(e,t){if(!(e instanceof URL)&&e!==nG)throw im('"expectedIssuerIdentifier" must be an instance of URL',iy);if(!ih(t,Response))throw im('"response" must be an instance of Response',iy);if(200!==t.status)throw iq('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',nI,t);nB(t);let r=await nz(t);if(ij(r.issuer,'"response" body "issuer" property',nP,{body:r}),e!==nG&&new URL(r.issuer).href!==e.href)throw iq('"response" body "issuer" property does not match the expected value',nK,{expected:e.href,body:r,attribute:"issuer"});return r}function iK(e){var t=e,r="application/json";if(ni(t)!==r)throw function(e,...t){let r='"response" content-type must be ';if(t.length>2){let e=t.pop();r+=`${t.join(", ")}, or ${e}`}else 2===t.length?r+=`${t[0]} or ${t[1]}`:r+=t[0];return iq(r,nR,e)}(t,r)}function iD(){return ix(crypto.getRandomValues(new Uint8Array(32)))}async function iM(e){return ij(e,"codeVerifier"),ix(await crypto.subtle.digest("SHA-256",iT(e)))}function iB(e){let t=e?.[ib];return"number"==typeof t&&Number.isFinite(t)?t:0}function iH(e){let t=e?.[iw];return"number"==typeof t&&Number.isFinite(t)&&-1!==Math.sign(t)?t:30}function iQ(){return Math.floor(Date.now()/1e3)}function iW(e){if("object"!=typeof e||null===e)throw im('"as" must be an object',iy);ij(e.issuer,'"as.issuer"')}function iJ(e){if("object"!=typeof e||null===e)throw im('"client" must be an object',iy);ij(e.client_id,'"client.client_id"')}function iF(e,t){let r=iQ()+iB(t);return{jti:iD(),aud:e.issuer,exp:r+60,iat:r,nbf:r,iss:t.client_id,sub:t.client_id}}async function iV(e,t,r){if(!r.usages.includes("sign"))throw im('CryptoKey instances used for signing assertions must include "sign" in their "usages"',ip);let i=`${ix(iT(JSON.stringify(e)))}.${ix(iT(JSON.stringify(t)))}`,n=ix(await crypto.subtle.sign(function(e){switch(e.algorithm.name){case"ECDSA":return{name:e.algorithm.name,hash:function(e){let{algorithm:t}=e;switch(t.namedCurve){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new iE("unsupported ECDSA namedCurve",{cause:e})}}(e)};case"RSA-PSS":switch(nH(e),e.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:e.algorithm.name,saltLength:parseInt(e.algorithm.hash.name.slice(-3),10)>>3};default:throw new iE("unsupported RSA-PSS hash name",{cause:e})}case"RSASSA-PKCS1-v1_5":return nH(e),e.algorithm.name;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":case"Ed25519":return e.algorithm.name}throw new iE("unsupported CryptoKey algorithm name",{cause:e})}(r),r,iT(i)));return`${i}.${n}`}let iz=URL.parse?(e,t)=>URL.parse(e,t):(e,t)=>{try{return new URL(e,t)}catch{return null}};function iG(e,t){if(t&&"https:"!==e.protocol)throw iq("only requests to HTTPS are allowed",nU,e);if("https:"!==e.protocol&&"http:"!==e.protocol)throw iq("only HTTP and HTTPS requests are allowed",nL,e)}function iX(e,t,r,i){let n;if("string"!=typeof e||!(n=iz(e)))throw iq(`authorization server metadata does not contain a valid ${r?`"as.mtls_endpoint_aliases.${t}"`:`"as.${t}"`}`,void 0===e?nD:nM,{attribute:r?`mtls_endpoint_aliases.${t}`:t});return iG(n,i),n}function iY(e,t,r,i){return r&&e.mtls_endpoint_aliases&&t in e.mtls_endpoint_aliases?iX(e.mtls_endpoint_aliases[t],t,r,i):iX(e[t],t,r,i)}class iZ extends Error{cause;code;error;status;error_description;response;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=nE,this.cause=t.cause,this.error=t.cause.error,this.status=t.response.status,this.error_description=t.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:t.response}),Error.captureStackTrace?.(this,this.constructor)}}class i0 extends Error{cause;code;error;error_description;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=nq,this.cause=t.cause,this.error=t.cause.get("error"),this.error_description=t.cause.get("error_description")??void 0,Error.captureStackTrace?.(this,this.constructor)}}class i1 extends Error{cause;code;response;status;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=nx,this.cause=t.cause,this.status=t.response.status,this.response=t.response,Object.defineProperty(this,"response",{enumerable:!1}),Error.captureStackTrace?.(this,this.constructor)}}let i2="[a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+",i5=RegExp("^[,\\s]*("+i2+")"),i8=RegExp("^[,\\s]*("+i2+')\\s*=\\s*"((?:[^"\\\\]|\\\\[\\s\\S])*)"[,\\s]*(.*)'),i3=RegExp("^[,\\s]*"+("("+i2+")\\s*=\\s*(")+i2+")[,\\s]*(.*)"),i4=RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+={0,2})(?:$|[,\\s])(.*)");async function i6(e){if(e.status>399&&e.status<500){nB(e),iK(e);try{let t=await e.clone().json();if(i$(t)&&"string"==typeof t.error&&t.error.length)return t}catch{}}}async function i9(e,t,r){if(e.status!==t){let t;if(nd(e),t=await i6(e))throw await e.body?.cancel(),new iZ("server responded with an error in the response body",{cause:t,response:e});throw iq(`"response" is not a conform ${r} response (unexpected HTTP status code)`,nI,e)}}function i7(e){if(!nm.has(e))throw im('"options.DPoP" is not a valid DPoPHandle',ip)}async function ne(e,t,r,i,n,s){if(ij(e,'"accessToken"'),!(r instanceof URL))throw im('"url" must be an instance of URL',iy);iG(r,s?.[ig]!==!0),i=iO(i),s?.DPoP&&(i7(s.DPoP),await s.DPoP.addProof(r,i,t.toUpperCase(),e)),i.set("authorization",`${i.has("dpop")?"DPoP":"Bearer"} ${e}`);let a=await (s?.[iv]||fetch)(r.href,{body:n,headers:Object.fromEntries(i.entries()),method:t,redirect:"manual",signal:iP(r,s?.signal)});return s?.DPoP?.cacheNonce(a,r),a}async function nt(e,t,r,i){iW(e),iJ(t);let n=iY(e,"userinfo_endpoint",t.use_mtls_endpoint_aliases,i?.[ig]!==!0),s=iO(i?.headers);return t.userinfo_signed_response_alg?s.set("accept","application/jwt"):(s.set("accept","application/json"),s.append("accept","application/jwt")),ne(r,"GET",n,s,null,{...i,[ib]:iB(t)})}let nr=Symbol();function ni(e){return e.headers.get("content-type")?.split(";")[0]}async function nn(e,t,r,i,n){let s;if(iW(e),iJ(t),!ih(i,Response))throw im('"response" must be an instance of Response',iy);if(nd(i),200!==i.status)throw iq('"response" is not a conform UserInfo Endpoint response (unexpected HTTP status code)',nI,i);if(nB(i),"application/jwt"===ni(i)){let{claims:r,jwt:a}=await nQ(await i.text(),nW.bind(void 0,t.userinfo_signed_response_alg,e.userinfo_signing_alg_values_supported,void 0),iB(t),iH(t),n?.[iS]).then(nh.bind(void 0,t.client_id)).then(np.bind(void 0,e));nl.set(i,a),s=r}else{if(t.userinfo_signed_response_alg)throw iq("JWT UserInfo Response expected",n$,i);s=await nz(i)}if(ij(s.sub,'"response" body "sub" property',nP,{body:s}),r===nr);else if(ij(r,'"expectedSubject"'),s.sub!==r)throw iq('unexpected "response" body "sub" property value',nK,{expected:r,body:s,attribute:"sub"});return s}async function ns(e,t,r,i,n,s,a){return await r(e,t,n,s),s.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(a?.[iv]||fetch)(i.href,{body:n,headers:Object.fromEntries(s.entries()),method:"POST",redirect:"manual",signal:iP(i,a?.signal)})}async function na(e,t,r,i,n,s){let a=iY(e,"token_endpoint",t.use_mtls_endpoint_aliases,s?.[ig]!==!0);n.set("grant_type",i);let o=iO(s?.headers);o.set("accept","application/json"),s?.DPoP!==void 0&&(i7(s.DPoP),await s.DPoP.addProof(a,o,"POST"));let l=await ns(e,t,r,a,n,o,s);return s?.DPoP?.cacheNonce(l,a),l}let no=new WeakMap,nl=new WeakMap;function nc(e){if(!e.id_token)return;let t=no.get(e);if(!t)throw im('"ref" was already garbage collected or did not resolve from the proper sources',ip);return t}async function nu(e,t,r,i,n,s){if(iW(e),iJ(t),!ih(r,Response))throw im('"response" must be an instance of Response',iy);await i9(r,200,"Token Endpoint"),nB(r);let a=await nz(r);if(ij(a.access_token,'"response" body "access_token" property',nP,{body:a}),ij(a.token_type,'"response" body "token_type" property',nP,{body:a}),a.token_type=a.token_type.toLowerCase(),void 0!==a.expires_in){let e="number"!=typeof a.expires_in?parseFloat(a.expires_in):a.expires_in;iL(e,!0,'"response" body "expires_in" property',nP,{body:a}),a.expires_in=e}if(void 0!==a.refresh_token&&ij(a.refresh_token,'"response" body "refresh_token" property',nP,{body:a}),void 0!==a.scope&&"string"!=typeof a.scope)throw iq('"response" body "scope" property must be a string',nP,{body:a});if(void 0!==a.id_token){ij(a.id_token,'"response" body "id_token" property',nP,{body:a});let s=["aud","exp","iat","iss","sub"];!0===t.require_auth_time&&s.push("auth_time"),void 0!==t.default_max_age&&(iL(t.default_max_age,!0,'"client.default_max_age"'),s.push("auth_time")),i?.length&&s.push(...i);let{claims:o,jwt:l}=await nQ(a.id_token,nW.bind(void 0,t.id_token_signed_response_alg,e.id_token_signing_alg_values_supported,"RS256"),iB(t),iH(t),n).then(nv.bind(void 0,s)).then(ny.bind(void 0,e)).then(nf.bind(void 0,t.client_id));if(Array.isArray(o.aud)&&1!==o.aud.length){if(void 0===o.azp)throw iq('ID Token "aud" (audience) claim includes additional untrusted audiences',nN,{claims:o,claim:"aud"});if(o.azp!==t.client_id)throw iq('unexpected ID Token "azp" (authorized party) claim value',nN,{expected:t.client_id,claims:o,claim:"azp"})}void 0!==o.auth_time&&iL(o.auth_time,!0,'ID Token "auth_time" (authentication time)',nP,{claims:o}),nl.set(r,l),no.set(a,o)}if(s?.[a.token_type]!==void 0)s[a.token_type](r,a);else if("dpop"!==a.token_type&&"bearer"!==a.token_type)throw new iE("unsupported `token_type` value",{cause:{body:a}});return a}function nd(e){let t;if(t=function(e){if(!ih(e,Response))throw im('"response" must be an instance of Response',iy);let t=e.headers.get("www-authenticate");if(null===t)return;let r=[],i=t;for(;i;){let e,t=i.match(i5),n=t?.["1"].toLowerCase();if(!n)return;let s=i.substring(t[0].length);if(s&&!s.match(/^[\s,]/))return;let a=s.match(/^\s+(.*)$/),o=!!a;i=a?a[1]:void 0;let l={};if(o)for(;i;){let r,n;if(t=i.match(i8)){if([,r,n,i]=t,n.includes("\\"))try{n=JSON.parse(`"${n}"`)}catch{}l[r.toLowerCase()]=n;continue}if(t=i.match(i3)){[,r,n,i]=t,l[r.toLowerCase()]=n;continue}if(t=i.match(i4)){if(Object.keys(l).length)break;[,e,i]=t;break}return}else i=s||void 0;let c={scheme:n,parameters:l};e&&(c.token68=e),r.push(c)}if(r.length)return r}(e))throw new i1("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:t,response:e})}function nh(e,t){return void 0!==t.claims.aud?nf(e,t):t}function nf(e,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e))throw iq('unexpected JWT "aud" (audience) claim value',nN,{expected:e,claims:t.claims,claim:"aud"})}else if(t.claims.aud!==e)throw iq('unexpected JWT "aud" (audience) claim value',nN,{expected:e,claims:t.claims,claim:"aud"});return t}function np(e,t){return void 0!==t.claims.iss?ny(e,t):t}function ny(e,t){let r=e[nX]?.(t)??e.issuer;if(t.claims.iss!==r)throw iq('unexpected JWT "iss" (issuer) claim value',nN,{expected:r,claims:t.claims,claim:"iss"});return t}let nm=new WeakSet,ng=Symbol();async function nb(e,t,r,i,n,s,a){if(iW(e),iJ(t),!nm.has(i))throw im('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',ip);ij(n,'"redirectUri"');let o=nJ(i,"code");if(!o)throw iq('no authorization code in "callbackParameters"',nP);let l=new URLSearchParams(a?.additionalParameters);return l.set("redirect_uri",n),l.set("code",o),s!==ng&&(ij(s,'"codeVerifier"'),l.set("code_verifier",s)),na(e,t,r,"authorization_code",l,a)}let nw={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function nv(e,t){for(let r of e)if(void 0===t.claims[r])throw iq(`JWT "${r}" (${nw[r]}) claim missing`,nP,{claims:t.claims});return t}let n_=Symbol(),nS=Symbol();async function nA(e,t,r,i){return"string"==typeof i?.expectedNonce||"number"==typeof i?.maxAge||i?.requireIdToken?nk(e,t,r,i.expectedNonce,i.maxAge,i[iS],i.recognizedTokenTypes):nT(e,t,r,i?.[iS],i?.recognizedTokenTypes)}async function nk(e,t,r,i,n,s,a){let o=[];switch(i){case void 0:i=n_;break;case n_:break;default:ij(i,'"expectedNonce" argument'),o.push("nonce")}switch(n??=t.default_max_age){case void 0:n=nS;break;case nS:break;default:iL(n,!0,'"maxAge" argument'),o.push("auth_time")}let l=await nu(e,t,r,o,s,a);ij(l.id_token,'"response" body "id_token" property',nP,{body:l});let c=nc(l);if(n!==nS){let e=iQ()+iB(t),r=iH(t);if(c.auth_time+n<e-r)throw iq("too much time has elapsed since the last End-User authentication",nj,{claims:c,now:e,tolerance:r,claim:"auth_time"})}if(i===n_){if(void 0!==c.nonce)throw iq('unexpected ID Token "nonce" claim value',nN,{expected:void 0,claims:c,claim:"nonce"})}else if(c.nonce!==i)throw iq('unexpected ID Token "nonce" claim value',nN,{expected:i,claims:c,claim:"nonce"});return l}async function nT(e,t,r,i,n){let s=await nu(e,t,r,void 0,i,n),a=nc(s);if(a){if(void 0!==t.default_max_age){iL(t.default_max_age,!0,'"client.default_max_age"');let e=iQ()+iB(t),r=iH(t);if(a.auth_time+t.default_max_age<e-r)throw iq("too much time has elapsed since the last End-User authentication",nj,{claims:a,now:e,tolerance:r,claim:"auth_time"})}if(void 0!==a.nonce)throw iq('unexpected ID Token "nonce" claim value',nN,{expected:void 0,claims:a,claim:"nonce"})}return s}let nx="OAUTH_WWW_AUTHENTICATE_CHALLENGE",nE="OAUTH_RESPONSE_BODY_ERROR",nC="OAUTH_UNSUPPORTED_OPERATION",nq="OAUTH_AUTHORIZATION_RESPONSE_ERROR",n$="OAUTH_JWT_USERINFO_EXPECTED",nO="OAUTH_PARSE_ERROR",nP="OAUTH_INVALID_RESPONSE",nR="OAUTH_RESPONSE_IS_NOT_JSON",nI="OAUTH_RESPONSE_IS_NOT_CONFORM",nU="OAUTH_HTTP_REQUEST_FORBIDDEN",nL="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",nj="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",nN="OAUTH_JWT_CLAIM_COMPARISON_FAILED",nK="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",nD="OAUTH_MISSING_SERVER_METADATA",nM="OAUTH_INVALID_SERVER_METADATA";function nB(e){if(e.bodyUsed)throw im('"response" body has been used already',ip)}function nH(e){let{algorithm:t}=e;if("number"!=typeof t.modulusLength||t.modulusLength<2048)throw new iE(`unsupported ${t.name} modulusLength`,{cause:e})}async function nQ(e,t,r,i,n){let s,a,{0:o,1:l,length:c}=e.split(".");if(5===c)if(void 0!==n)e=await n(e),{0:o,1:l,length:c}=e.split(".");else throw new iE("JWE decryption is not configured",{cause:e});if(3!==c)throw iq("Invalid JWT",nP,e);try{s=JSON.parse(iT(ix(o)))}catch(e){throw iq("failed to parse JWT Header body as base64url encoded JSON",nO,e)}if(!i$(s))throw iq("JWT Header must be a top level object",nP,e);if(t(s),void 0!==s.crit)throw new iE('no JWT "crit" header parameter extensions are supported',{cause:{header:s}});try{a=JSON.parse(iT(ix(l)))}catch(e){throw iq("failed to parse JWT Payload body as base64url encoded JSON",nO,e)}if(!i$(a))throw iq("JWT Payload must be a top level object",nP,e);let u=iQ()+r;if(void 0!==a.exp){if("number"!=typeof a.exp)throw iq('unexpected JWT "exp" (expiration time) claim type',nP,{claims:a});if(a.exp<=u-i)throw iq('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',nj,{claims:a,now:u,tolerance:i,claim:"exp"})}if(void 0!==a.iat&&"number"!=typeof a.iat)throw iq('unexpected JWT "iat" (issued at) claim type',nP,{claims:a});if(void 0!==a.iss&&"string"!=typeof a.iss)throw iq('unexpected JWT "iss" (issuer) claim type',nP,{claims:a});if(void 0!==a.nbf){if("number"!=typeof a.nbf)throw iq('unexpected JWT "nbf" (not before) claim type',nP,{claims:a});if(a.nbf>u+i)throw iq('unexpected JWT "nbf" (not before) claim value',nj,{claims:a,now:u,tolerance:i,claim:"nbf"})}if(void 0!==a.aud&&"string"!=typeof a.aud&&!Array.isArray(a.aud))throw iq('unexpected JWT "aud" (audience) claim type',nP,{claims:a});return{header:s,claims:a,jwt:e}}function nW(e,t,r,i){if(void 0!==e){if("string"==typeof e?i.alg!==e:!e.includes(i.alg))throw iq('unexpected JWT "alg" header parameter',nP,{header:i,expected:e,reason:"client configuration"});return}if(Array.isArray(t)){if(!t.includes(i.alg))throw iq('unexpected JWT "alg" header parameter',nP,{header:i,expected:t,reason:"authorization server metadata"});return}if(void 0!==r){if("string"==typeof r?i.alg!==r:"function"==typeof r?!r(i.alg):!r.includes(i.alg))throw iq('unexpected JWT "alg" header parameter',nP,{header:i,expected:r,reason:"default value"});return}throw iq('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:e,issuer:t,fallback:r})}function nJ(e,t){let{0:r,length:i}=e.getAll(t);if(i>1)throw iq(`"${t}" parameter must be provided only once`,nP);return r}let nF=Symbol(),nV=Symbol();async function nz(e,t=iK){let r;try{r=await e.json()}catch(r){throw t(e),iq('failed to parse "response" body as JSON',nO,r)}if(!i$(r))throw iq('"response" body must be a top level object',nP,{body:r});return r}let nG=Symbol(),nX=Symbol();async function nY(e,t,r){let{cookies:i,logger:n}=r,s=i[e],a=new Date;a.setTime(a.getTime()+9e5),n.debug(`CREATE_${e.toUpperCase()}`,{name:s.name,payload:t,COOKIE_TTL:900,expires:a});let o=await tB({...r.jwt,maxAge:900,token:{value:t},salt:s.name}),l={...s.options,expires:a};return{name:s.name,value:o,options:l}}async function nZ(e,t,r){try{let{logger:i,cookies:n,jwt:s}=r;if(i.debug(`PARSE_${e.toUpperCase()}`,{cookie:t}),!t)throw new _(`${e} cookie was missing`);let a=await tH({...s,token:t,salt:n[e].name});if(a?.value)return a.value;throw Error("Invalid cookie")}catch(t){throw new _(`${e} value could not be parsed`,{cause:t})}}function n0(e,t,r){let{logger:i,cookies:n}=t,s=n[e];i.debug(`CLEAR_${e.toUpperCase()}`,{cookie:s}),r.push({name:s.name,value:"",options:{...n[e].options,maxAge:0}})}function n1(e,t){return async function(r,i,n){let{provider:s,logger:a}=n;if(!s?.checks?.includes(e))return;let o=r?.[n.cookies[t].name];a.debug(`USE_${t.toUpperCase()}`,{value:o});let l=await nZ(t,o,n);return n0(t,n,i),l}}let n2={async create(e){let t=iD(),r=await iM(t);return{cookie:await nY("pkceCodeVerifier",t,e),value:r}},use:n1("pkce","pkceCodeVerifier")},n5="encodedState",n8={async create(e,t){let{provider:r}=e;if(!r.checks.includes("state")){if(t)throw new _("State data was provided but the provider is not configured to use state");return}let i={origin:t,random:iD()},n=await tB({secret:e.jwt.secret,token:i,salt:n5,maxAge:900});return{cookie:await nY("state",n,e),value:n}},use:n1("state","state"),async decode(e,t){try{t.logger.debug("DECODE_STATE",{state:e});let r=await tH({secret:t.jwt.secret,token:e,salt:n5});if(r)return r;throw Error("Invalid state")}catch(e){throw new _("State could not be decoded",{cause:e})}}},n3={async create(e){if(!e.provider.checks.includes("nonce"))return;let t=iD();return{cookie:await nY("nonce",t,e),value:t}},use:n1("nonce","nonce")},n4="encodedWebauthnChallenge",n6={create:async(e,t,r)=>({cookie:await nY("webauthnChallenge",await tB({secret:e.jwt.secret,token:{challenge:t,registerData:r},salt:n4,maxAge:900}),e)}),async use(e,t,r){let i=t?.[e.cookies.webauthnChallenge.name],n=await nZ("webauthnChallenge",i,e),s=await tH({secret:e.jwt.secret,token:n,salt:n4});if(n0("webauthnChallenge",e,r),!s)throw new _("WebAuthn challenge was missing");return s}};function n9(e){return encodeURIComponent(e).replace(/%20/g,"+")}async function n7(e,t,r){var i,n;let s,a,o,l,c,{logger:u,provider:d}=r,{token:h,userinfo:f}=d;if(h?.url&&"authjs.dev"!==h.url.host||f?.url&&"authjs.dev"!==f.url.host)s={issuer:d.issuer??"https://authjs.dev",token_endpoint:h?.url.toString(),userinfo_endpoint:f?.url.toString()};else{let e=new URL(d.issuer),t=await iU(e,{[ig]:!0,[iv]:d[re]});if(!(s=await iN(e,t)).token_endpoint)throw TypeError("TODO: Authorization server did not provide a token endpoint.");if(!s.userinfo_endpoint)throw TypeError("TODO: Authorization server did not provide a userinfo endpoint.")}let p={client_id:d.clientId,...d.client};switch(p.token_endpoint_auth_method){case void 0:case"client_secret_basic":a=(e,t,r,i)=>{var n,s;let a,o,l;i.set("authorization",(n=d.clientId,s=d.clientSecret,a=n9(n),o=n9(s),l=btoa(`${a}:${o}`),`Basic ${l}`))};break;case"client_secret_post":ij(i=d.clientSecret,'"clientSecret"'),a=(e,t,r,n)=>{r.set("client_id",t.client_id),r.set("client_secret",i)};break;case"client_secret_jwt":ij(n=d.clientSecret,'"clientSecret"'),c=void 0,a=async(e,t,r,i)=>{l||=await crypto.subtle.importKey("raw",iT(n),{hash:"SHA-256",name:"HMAC"},!1,["sign"]);let s={alg:"HS256"},a=iF(e,t);c?.(s,a);let o=`${ix(iT(JSON.stringify(s)))}.${ix(iT(JSON.stringify(a)))}`,u=await crypto.subtle.sign(l.algorithm,l,iT(o));r.set("client_id",t.client_id),r.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),r.set("client_assertion",`${o}.${ix(new Uint8Array(u))}`)};break;case"private_key_jwt":a=function(e,t){let{key:r,kid:i}=e instanceof CryptoKey?{key:e}:e?.key instanceof CryptoKey?(void 0!==e.kid&&ij(e.kid,'"kid"'),{key:e.key,kid:e.kid}):{};var n='"clientPrivateKey.key"';if(!(r instanceof CryptoKey))throw im(`${n} must be a CryptoKey`,iy);if("private"!==r.type)throw im(`${n} must be a private CryptoKey`,ip);return async(e,n,s,a)=>{let o={alg:function(e){switch(e.algorithm.name){case"RSA-PSS":switch(e.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new iE("unsupported RsaHashedKeyAlgorithm hash name",{cause:e})}case"RSASSA-PKCS1-v1_5":switch(e.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new iE("unsupported RsaHashedKeyAlgorithm hash name",{cause:e})}case"ECDSA":switch(e.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new iE("unsupported EcKeyAlgorithm namedCurve",{cause:e})}case"Ed25519":case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return e.algorithm.name;case"EdDSA":return"Ed25519";default:throw new iE("unsupported CryptoKey algorithm name",{cause:e})}}(r),kid:i},l=iF(e,n);t?.[i_]?.(o,l),s.set("client_id",n.client_id),s.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),s.set("client_assertion",await iV(o,l,r))}}(d.token.clientPrivateKey,{[i_](e,t){t.aud=[s.issuer,s.token_endpoint]}});break;case"none":a=(e,t,r,i)=>{r.set("client_id",t.client_id)};break;default:throw Error("unsupported client authentication method")}let y=[],m=await n8.use(t,y,r);try{o=function(e,t,r,i){var n;if(iW(e),iJ(t),r instanceof URL&&(r=r.searchParams),!(r instanceof URLSearchParams))throw im('"parameters" must be an instance of URLSearchParams, or URL',iy);if(nJ(r,"response"))throw iq('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',nP,{parameters:r});let s=nJ(r,"iss"),a=nJ(r,"state");if(!s&&e.authorization_response_iss_parameter_supported)throw iq('response parameter "iss" (issuer) missing',nP,{parameters:r});if(s&&s!==e.issuer)throw iq('unexpected "iss" (issuer) response parameter value',nP,{expected:e.issuer,parameters:r});switch(i){case void 0:case nV:if(void 0!==a)throw iq('unexpected "state" response parameter encountered',nP,{expected:void 0,parameters:r});break;case nF:break;default:if(ij(i,'"expectedState" argument'),a!==i)throw iq(void 0===a?'response parameter "state" missing':'unexpected "state" response parameter value',nP,{expected:i,parameters:r})}if(nJ(r,"error"))throw new i0("authorization response from the server is an error",{cause:r});let o=nJ(r,"id_token"),l=nJ(r,"token");if(void 0!==o||void 0!==l)throw new iE("implicit and hybrid flows are not supported");return n=new URLSearchParams(r),nm.add(n),n}(s,p,new URLSearchParams(e),d.checks.includes("state")?m:nF)}catch(e){if(e instanceof i0){let t={providerId:d.id,...Object.fromEntries(e.cause.entries())};throw u.debug("OAuthCallbackError",t),new C("OAuth Provider returned an error",t)}throw e}let g=await n2.use(t,y,r),b=d.callbackUrl;!r.isOnRedirectProxy&&d.redirectProxyUrl&&(b=d.redirectProxyUrl);let w=await nb(s,p,a,o,b,g??"decoy",{[ig]:!0,[iv]:(...e)=>(d.checks.includes("pkce")||e[1].body.delete("code_verifier"),(d[re]??fetch)(...e))});d.token?.conform&&(w=await d.token.conform(w.clone())??w);let v={},_="oidc"===d.type;if(d[rt])switch(d.id){case"microsoft-entra-id":case"azure-ad":{let e=await w.clone().json();if(e.error){let t={providerId:d.id,...e};throw new C(`OAuth Provider returned an error: ${e.error}`,t)}let{tid:t}=function(e){let t,r;if("string"!=typeof e)throw new ew("JWTs must use Compact JWS serialization, JWT must be a string");let{1:i,length:n}=e.split(".");if(5===n)throw new ew("Only JWTs using Compact JWS serialization can be decoded");if(3!==n)throw new ew("Invalid JWT");if(!i)throw new ew("JWTs must contain a payload");try{t=ec(i)}catch{throw new ew("Failed to base64url decode the payload")}try{r=JSON.parse(ei.decode(t))}catch{throw new ew("Failed to parse the decoded payload as JSON")}if(!eZ(r))throw new ew("Invalid JWT Claims Set");return r}(e.id_token);if("string"==typeof t){let e=s.issuer?.match(/microsoftonline\.com\/(\w+)\/v2\.0/)?.[1]??"common",r=new URL(s.issuer.replace(e,t)),i=await iU(r,{[iv]:d[re]});s=await iN(r,i)}}}let S=await nA(s,p,w,{expectedNonce:await n3.use(t,y,r),requireIdToken:_});if(_){let t=nc(S);if(v=t,d[rt]&&"apple"===d.id)try{v.user=JSON.parse(e?.user)}catch{}if(!1===d.idToken){let e=await nt(s,p,S.access_token,{[iv]:d[re],[ig]:!0});v=await nn(s,p,t.sub,e)}}else if(f?.request){let e=await f.request({tokens:S,provider:d});e instanceof Object&&(v=e)}else if(f?.url){let e=await nt(s,p,S.access_token,{[iv]:d[re],[ig]:!0});v=await e.json()}else throw TypeError("No userinfo endpoint configured");return S.expires_in&&(S.expires_at=Math.floor(Date.now()/1e3)+Number(S.expires_in)),{...await se(v,d,S,u),profile:v,cookies:y}}async function se(e,t,r,i){try{let i=await t.profile(e,r);return{user:{...i,id:crypto.randomUUID(),email:i.email?.toLowerCase()},account:{...r,provider:t.id,type:t.type,providerAccountId:i.id??crypto.randomUUID()}}}catch(r){i.debug("getProfile error details",e),i.error(new q(r,{provider:t.id}))}}async function st(e,t,r,i){let n=await sa(e,t,r),{cookie:s}=await n6.create(e,n.challenge,r);return{status:200,cookies:[...i??[],s],body:{action:"register",options:n},headers:{"Content-Type":"application/json"}}}async function sr(e,t,r,i){let n=await ss(e,t,r),{cookie:s}=await n6.create(e,n.challenge);return{status:200,cookies:[...i??[],s],body:{action:"authenticate",options:n},headers:{"Content-Type":"application/json"}}}async function si(e,t,r){let i,{adapter:n,provider:s}=e,a=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!a||"object"!=typeof a||!("id"in a)||"string"!=typeof a.id)throw new d("Invalid WebAuthn Authentication response");let o=sc(sl(a.id)),l=await n.getAuthenticator(o);if(!l)throw new d(`WebAuthn authenticator not found in database: ${JSON.stringify({credentialID:o})}`);let{challenge:c}=await n6.use(e,t.cookies,r);try{var u;let r=s.getRelayingParty(e,t);i=await s.simpleWebAuthn.verifyAuthenticationResponse({...s.verifyAuthenticationOptions,expectedChallenge:c,response:a,authenticator:{...u=l,credentialDeviceType:u.credentialDeviceType,transports:su(u.transports),credentialID:sl(u.credentialID),credentialPublicKey:sl(u.credentialPublicKey)},expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new M(e)}let{verified:h,authenticationInfo:p}=i;if(!h)throw new M("WebAuthn authentication response could not be verified");try{let{newCounter:e}=p;await n.updateAuthenticatorCounter(l.credentialID,e)}catch(e){throw new f(`Failed to update authenticator counter. This may cause future authentication attempts to fail. ${JSON.stringify({credentialID:o,oldCounter:l.counter,newCounter:p.newCounter})}`,e)}let y=await n.getAccount(l.providerAccountId,s.id);if(!y)throw new d(`WebAuthn account not found in database: ${JSON.stringify({credentialID:o,providerAccountId:l.providerAccountId})}`);let m=await n.getUser(y.userId);if(!m)throw new d(`WebAuthn user not found in database: ${JSON.stringify({credentialID:o,providerAccountId:l.providerAccountId,userID:y.userId})}`);return{account:y,user:m}}async function sn(e,t,r){var i;let n,{provider:s}=e,a=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!a||"object"!=typeof a||!("id"in a)||"string"!=typeof a.id)throw new d("Invalid WebAuthn Registration response");let{challenge:o,registerData:l}=await n6.use(e,t.cookies,r);if(!l)throw new d("Missing user registration data in WebAuthn challenge cookie");try{let r=s.getRelayingParty(e,t);n=await s.simpleWebAuthn.verifyRegistrationResponse({...s.verifyRegistrationOptions,expectedChallenge:o,response:a,expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new M(e)}if(!n.verified||!n.registrationInfo)throw new M("WebAuthn registration response could not be verified");let c={providerAccountId:sc(n.registrationInfo.credentialID),provider:e.provider.id,type:s.type},u={providerAccountId:c.providerAccountId,counter:n.registrationInfo.counter,credentialID:sc(n.registrationInfo.credentialID),credentialPublicKey:sc(n.registrationInfo.credentialPublicKey),credentialBackedUp:n.registrationInfo.credentialBackedUp,credentialDeviceType:n.registrationInfo.credentialDeviceType,transports:(i=a.response.transports,i?.join(","))};return{user:l,account:c,authenticator:u}}async function ss(e,t,r){let{provider:i,adapter:n}=e,s=r&&r.id?await n.listAuthenticatorsByUserId(r.id):null,a=i.getRelayingParty(e,t);return await i.simpleWebAuthn.generateAuthenticationOptions({...i.authenticationOptions,rpID:a.id,allowCredentials:s?.map(e=>({id:sl(e.credentialID),type:"public-key",transports:su(e.transports)}))})}async function sa(e,t,r){let{provider:i,adapter:n}=e,s=r.id?await n.listAuthenticatorsByUserId(r.id):null,a=t5(32),o=i.getRelayingParty(e,t);return await i.simpleWebAuthn.generateRegistrationOptions({...i.registrationOptions,userID:a,userName:r.email,userDisplayName:r.name??void 0,rpID:o.id,rpName:o.name,excludeCredentials:s?.map(e=>({id:sl(e.credentialID),type:"public-key",transports:su(e.transports)}))})}function so(e){let{provider:t,adapter:r}=e;if(!r)throw new A("An adapter is required for the WebAuthn provider");if(!t||"webauthn"!==t.type)throw new I("Provider must be WebAuthn");return{...e,provider:t,adapter:r}}function sl(e){return new Uint8Array(Buffer.from(e,"base64"))}function sc(e){return Buffer.from(e).toString("base64")}function su(e){return e?e.split(","):void 0}async function sd(e,t,r,i){if(!t.provider)throw new I("Callback route called without provider");let{query:n,body:s,method:a,headers:o}=e,{provider:l,adapter:c,url:u,callbackUrl:h,pages:f,jwt:p,events:m,callbacks:g,session:{strategy:b,maxAge:v},logger:_}=t,S="jwt"===b;try{if("oauth"===l.type||"oidc"===l.type){let a,o=l.authorization?.url.searchParams.get("response_mode")==="form_post"?s:n;if(t.isOnRedirectProxy&&o?.state){let e=await n8.decode(o.state,t);if(e?.origin&&new URL(e.origin).origin!==t.url.origin){let t=`${e.origin}?${new URLSearchParams(o)}`;return _.debug("Proxy redirecting to",t),{redirect:t,cookies:i}}}let d=await n7(o,e.cookies,t);d.cookies.length&&i.push(...d.cookies),_.debug("authorization result",d);let{user:y,account:b,profile:w}=d;if(!y||!b||!w)return{redirect:`${u}/signin`,cookies:i};if(c){let{getUserByAccount:e}=c;a=await e({providerAccountId:b.providerAccountId,provider:l.id})}let A=await sh({user:a??y,account:b,profile:w},t);if(A)return{redirect:A,cookies:i};let{user:k,session:T,isNewUser:x}=await id(r.value,y,b,t);if(S){let e={name:k.name,email:k.email,picture:k.image,sub:k.id?.toString()},n=await g.jwt({token:e,user:k,account:b,profile:w,isNewUser:x,trigger:x?"signUp":"signIn"});if(null===n)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,s=await p.encode({...p,token:n,salt:e}),a=new Date;a.setTime(a.getTime()+1e3*v);let o=r.chunk(s,{expires:a});i.push(...o)}}else i.push({name:t.cookies.sessionToken.name,value:T.sessionToken,options:{...t.cookies.sessionToken.options,expires:T.expires}});if(await m.signIn?.({user:k,account:b,profile:w,isNewUser:x}),x&&f.newUser)return{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:h})}`,cookies:i};return{redirect:h,cookies:i}}if("email"===l.type){let e=n?.token,s=n?.email;if(!e){let t=TypeError("Missing token. The sign-in URL was manually opened without token or the link was not sent correctly in the email.",{cause:{hasToken:!!e}});throw t.name="Configuration",t}let a=l.secret??t.secret,o=await c.useVerificationToken({identifier:s,token:await t2(`${e}${a}`)}),u=!!o,d=u&&o.expires.valueOf()<Date.now();if(!u||d||s&&o.identifier!==s)throw new L({hasInvite:u,expired:d});let{identifier:y}=o,b=await c.getUserByEmail(y)??{id:crypto.randomUUID(),email:y,emailVerified:null},w={providerAccountId:b.email,userId:b.id,type:"email",provider:l.id},_=await sh({user:b,account:w},t);if(_)return{redirect:_,cookies:i};let{user:A,session:k,isNewUser:T}=await id(r.value,b,w,t);if(S){let e={name:A.name,email:A.email,picture:A.image,sub:A.id?.toString()},n=await g.jwt({token:e,user:A,account:w,isNewUser:T,trigger:T?"signUp":"signIn"});if(null===n)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,s=await p.encode({...p,token:n,salt:e}),a=new Date;a.setTime(a.getTime()+1e3*v);let o=r.chunk(s,{expires:a});i.push(...o)}}else i.push({name:t.cookies.sessionToken.name,value:k.sessionToken,options:{...t.cookies.sessionToken.options,expires:k.expires}});if(await m.signIn?.({user:A,account:w,isNewUser:T}),T&&f.newUser)return{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:h})}`,cookies:i};return{redirect:h,cookies:i}}if("credentials"===l.type&&"POST"===a){let e=s??{};Object.entries(n??{}).forEach(([e,t])=>u.searchParams.set(e,t));let c=await l.authorize(e,new Request(u,{headers:o,method:a,body:JSON.stringify(s)}));if(c)c.id=c.id?.toString()??crypto.randomUUID();else throw new w;let d={providerAccountId:c.id,type:"credentials",provider:l.id},f=await sh({user:c,account:d,credentials:e},t);if(f)return{redirect:f,cookies:i};let y={name:c.name,email:c.email,picture:c.image,sub:c.id},b=await g.jwt({token:y,user:c,account:d,isNewUser:!1,trigger:"signIn"});if(null===b)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,n=await p.encode({...p,token:b,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*v);let a=r.chunk(n,{expires:s});i.push(...a)}return await m.signIn?.({user:c,account:d}),{redirect:h,cookies:i}}else if("webauthn"===l.type&&"POST"===a){let n,s,a,o=e.body?.action;if("string"!=typeof o||"authenticate"!==o&&"register"!==o)throw new d("Invalid action parameter");let l=so(t);switch(o){case"authenticate":{let t=await si(l,e,i);n=t.user,s=t.account;break}case"register":{let r=await sn(t,e,i);n=r.user,s=r.account,a=r.authenticator}}await sh({user:n,account:s},t);let{user:c,isNewUser:u,session:y,account:b}=await id(r.value,n,s,t);if(!b)throw new d("Error creating or finding account");if(a&&c.id&&await l.adapter.createAuthenticator({...a,userId:c.id}),S){let e={name:c.name,email:c.email,picture:c.image,sub:c.id?.toString()},n=await g.jwt({token:e,user:c,account:b,isNewUser:u,trigger:u?"signUp":"signIn"});if(null===n)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,s=await p.encode({...p,token:n,salt:e}),a=new Date;a.setTime(a.getTime()+1e3*v);let o=r.chunk(s,{expires:a});i.push(...o)}}else i.push({name:t.cookies.sessionToken.name,value:y.sessionToken,options:{...t.cookies.sessionToken.options,expires:y.expires}});if(await m.signIn?.({user:c,account:b,isNewUser:u}),u&&f.newUser)return{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:h})}`,cookies:i};return{redirect:h,cookies:i}}throw new I(`Callback for provider type (${l.type}) is not supported`)}catch(t){if(t instanceof d)throw t;let e=new y(t,{provider:l.id});throw _.debug("callback route error details",{method:a,query:n,body:s}),e}}async function sh(e,t){let r,{signIn:i,redirect:n}=t.callbacks;try{r=await i(e)}catch(e){if(e instanceof d)throw e;throw new p(e)}if(!r)throw new p("AccessDenied");if("string"==typeof r)return await n({url:r,baseUrl:t.url.origin})}async function sf(e,t,r,i,n){let{adapter:s,jwt:a,events:o,callbacks:l,logger:c,session:{strategy:u,maxAge:d}}=e,h={body:null,headers:{"Content-Type":"application/json",...!i&&{"Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"}},cookies:r},f=t.value;if(!f)return h;if("jwt"===u){try{let r=e.cookies.sessionToken.name,s=await a.decode({...a,token:f,salt:r});if(!s)throw Error("Invalid JWT");let c=await l.jwt({token:s,...i&&{trigger:"update"},session:n}),u=iu(d);if(null!==c){let e={user:{name:c.name,email:c.email,image:c.picture},expires:u.toISOString()},i=await l.session({session:e,token:c});h.body=i;let n=await a.encode({...a,token:c,salt:r}),s=t.chunk(n,{expires:u});h.cookies?.push(...s),await o.session?.({session:i,token:c})}else h.cookies?.push(...t.clean())}catch(e){c.error(new S(e)),h.cookies?.push(...t.clean())}return h}try{let{getSessionAndUser:r,deleteSession:a,updateSession:c}=s,u=await r(f);if(u&&u.session.expires.valueOf()<Date.now()&&(await a(f),u=null),u){let{user:t,session:r}=u,s=e.session.updateAge,a=r.expires.valueOf()-1e3*d+1e3*s,p=iu(d);a<=Date.now()&&await c({sessionToken:f,expires:p});let y=await l.session({session:{...r,user:t},user:t,newSession:n,...i?{trigger:"update"}:{}});h.body=y,h.cookies?.push({name:e.cookies.sessionToken.name,value:f,options:{...e.cookies.sessionToken.options,expires:p}}),await o.session?.({session:y})}else f&&h.cookies?.push(...t.clean())}catch(e){c.error(new $(e))}return h}async function sp(e,t){let r,i,{logger:n,provider:s}=t,a=s.authorization?.url;if(!a||"authjs.dev"===a.host){let e=new URL(s.issuer),t=await iU(e,{[iv]:s[re],[ig]:!0}),r=await iN(e,t).catch(t=>{if(!(t instanceof TypeError)||"Invalid URL"!==t.message)throw t;throw TypeError(`Discovery request responded with an invalid issuer. expected: ${e}`)});if(!r.authorization_endpoint)throw TypeError("Authorization server did not provide an authorization endpoint.");a=new URL(r.authorization_endpoint)}let o=a.searchParams,l=s.callbackUrl;!t.isOnRedirectProxy&&s.redirectProxyUrl&&(l=s.redirectProxyUrl,i=s.callbackUrl,n.debug("using redirect proxy",{redirect_uri:l,data:i}));let c=Object.assign({response_type:"code",client_id:s.clientId,redirect_uri:l,...s.authorization?.params},Object.fromEntries(s.authorization?.url.searchParams??[]),e);for(let e in c)o.set(e,c[e]);let u=[];s.authorization?.url.searchParams.get("response_mode")==="form_post"&&(t.cookies.state.options.sameSite="none",t.cookies.state.options.secure=!0,t.cookies.nonce.options.sameSite="none",t.cookies.nonce.options.secure=!0);let d=await n8.create(t,i);if(d&&(o.set("state",d.value),u.push(d.cookie)),s.checks?.includes("pkce"))if(r&&!r.code_challenge_methods_supported?.includes("S256"))"oidc"===s.type&&(s.checks=["nonce"]);else{let{value:e,cookie:r}=await n2.create(t);o.set("code_challenge",e),o.set("code_challenge_method","S256"),u.push(r)}let h=await n3.create(t);return h&&(o.set("nonce",h.value),u.push(h.cookie)),"oidc"!==s.type||a.searchParams.has("scope")||a.searchParams.set("scope","openid profile email"),n.debug("authorization url is ready",{url:a,cookies:u,provider:s}),{redirect:a.toString(),cookies:u}}async function sy(e,t){let r,{body:i}=e,{provider:n,callbacks:s,adapter:a}=t,o=(n.normalizeIdentifier??function(e){if(!e)throw Error("Missing email from request body.");let[t,r]=e.toLowerCase().trim().split("@");return r=r.split(",")[0],`${t}@${r}`})(i?.email),l={id:crypto.randomUUID(),email:o,emailVerified:null},c=await a.getUserByEmail(o)??l,u={providerAccountId:o,userId:c.id,type:"email",provider:n.id};try{r=await s.signIn({user:c,account:u,email:{verificationRequest:!0}})}catch(e){throw new p(e)}if(!r)throw new p("AccessDenied");if("string"==typeof r)return{redirect:await s.redirect({url:r,baseUrl:t.url.origin})};let{callbackUrl:d,theme:h}=t,f=await n.generateVerificationToken?.()??t5(32),y=new Date(Date.now()+(n.maxAge??86400)*1e3),m=n.secret??t.secret,g=new URL(t.basePath,t.url.origin),b=n.sendVerificationRequest({identifier:o,token:f,expires:y,url:`${g}/callback/${n.id}?${new URLSearchParams({callbackUrl:d,token:f,email:o})}`,provider:n,theme:h,request:new Request(e.url,{headers:e.headers,method:e.method,body:"POST"===e.method?JSON.stringify(e.body??{}):void 0})}),w=a.createVerificationToken?.({identifier:o,token:await t2(`${f}${m}`),expires:y});return await Promise.all([b,w]),{redirect:`${g}/verify-request?${new URLSearchParams({provider:n.id,type:n.type})}`}}async function sm(e,t,r){let i=`${r.url.origin}${r.basePath}/signin`;if(!r.provider)return{redirect:i,cookies:t};switch(r.provider.type){case"oauth":case"oidc":{let{redirect:i,cookies:n}=await sp(e.query,r);return n&&t.push(...n),{redirect:i,cookies:t}}case"email":return{...await sy(e,r),cookies:t};default:return{redirect:i,cookies:t}}}async function sg(e,t,r){let{jwt:i,events:n,callbackUrl:s,logger:a,session:o}=r,l=t.value;if(!l)return{redirect:s,cookies:e};try{if("jwt"===o.strategy){let e=r.cookies.sessionToken.name,t=await i.decode({...i,token:l,salt:e});await n.signOut?.({token:t})}else{let e=await r.adapter?.deleteSession(l);await n.signOut?.({session:e})}}catch(e){a.error(new O(e))}return e.push(...t.clean()),{redirect:s,cookies:e}}async function sb(e,t){let{adapter:r,jwt:i,session:{strategy:n}}=e,s=t.value;if(!s)return null;if("jwt"===n){let t=e.cookies.sessionToken.name,r=await i.decode({...i,token:s,salt:t});if(r&&r.sub)return{id:r.sub,name:r.name,email:r.email,image:r.picture}}else{let e=await r?.getSessionAndUser(s);if(e)return e.user}return null}async function sw(e,t,r,i){let n=so(t),{provider:s}=n,{action:a}=e.query??{};if("register"!==a&&"authenticate"!==a&&void 0!==a)return{status:400,body:{error:"Invalid action"},cookies:i,headers:{"Content-Type":"application/json"}};let o=await sb(t,r),l=o?{user:o,exists:!0}:await s.getUserInfo(t,e),c=l?.user;switch(function(e,t,r){let{user:i,exists:n=!1}=r??{};switch(e){case"authenticate":return"authenticate";case"register":if(i&&t===n)return"register";break;case void 0:if(!t)if(!i)return"authenticate";else if(n)return"authenticate";else return"register"}return null}(a,!!o,l)){case"authenticate":return sr(n,e,c,i);case"register":if("string"==typeof c?.email)return st(n,e,c,i);break;default:return{status:400,body:{error:"Invalid request"},cookies:i,headers:{"Content-Type":"application/json"}}}}async function sv(e,t){let{action:r,providerId:i,error:n,method:s}=e,a=t.skipCSRFCheck===t9,{options:o,cookies:l}=await ro({authOptions:t,action:r,providerId:i,url:e.url,callbackUrl:e.body?.callbackUrl??e.query?.callbackUrl,csrfToken:e.body?.csrfToken,cookies:e.cookies,isPost:"POST"===s,csrfDisabled:a}),c=new u(o.cookies.sessionToken,e.cookies,o.logger);if("GET"===s){let t=ic({...o,query:e.query,cookies:l});switch(r){case"callback":return await sd(e,o,c,l);case"csrf":return t.csrf(a,o,l);case"error":return t.error(n);case"providers":return t.providers(o.providers);case"session":return await sf(o,c,l);case"signin":return t.signin(i,n);case"signout":return t.signout();case"verify-request":return t.verifyRequest();case"webauthn-options":return await sw(e,o,c,l)}}else{let{csrfTokenVerified:t}=o;switch(r){case"callback":return"credentials"===o.provider.type&&t3(r,t),await sd(e,o,c,l);case"session":return t3(r,t),await sf(o,c,l,!0,e.body?.data);case"signin":return t3(r,t),await sm(e,l,o);case"signout":return t3(r,t),await sg(l,c,o)}}throw new P(`Cannot handle action: ${r}`)}function s_(e,t,r,i,n){let s,a=n?.basePath,o=i.AUTH_URL??i.NEXTAUTH_URL;if(o)s=new URL(o),a&&"/"!==a&&"/"!==s.pathname&&(s.pathname!==a&&tz(n).warn("env-url-basepath-mismatch"),s.pathname="/");else{let e=r.get("x-forwarded-host")??r.get("host"),i=r.get("x-forwarded-proto")??t??"https",n=i.endsWith(":")?i:i+":";s=new URL(`${n}//${e}`)}let l=s.toString().replace(/\/$/,"");if(a){let t=a?.replace(/(^\/|\/$)/g,"")??"";return new URL(`${l}/${t}/${e}`)}return new URL(`${l}/${e}`)}async function sS(e,t){let r=tz(t),i=await t0(e,t);if(!i)return Response.json("Bad request.",{status:400});let n=function(e,t){let{url:r}=e,i=[];if(!Q&&t.debug&&i.push("debug-enabled"),!t.trustHost)return new U(`Host must be trusted. URL was: ${e.url}`);if(!t.secret?.length)return new x("Please define a `secret`");let n=e.query?.callbackUrl;if(n&&!W(n,r.origin))return new b(`Invalid callback URL. Received: ${n}`);let{callbackUrl:s}=c(t.useSecureCookies??"https:"===r.protocol),a=e.cookies?.[t.cookies?.callbackUrl?.name??s.name];if(a&&!W(a,r.origin))return new b(`Invalid callback URL. Received: ${a}`);let o=!1;for(let e of t.providers){let t="function"==typeof e?e():e;if(("oauth"===t.type||"oidc"===t.type)&&!(t.issuer??t.options?.issuer)){let e,{authorization:r,token:i,userinfo:n}=t;if("string"==typeof r||r?.url?"string"==typeof i||i?.url?"string"==typeof n||n?.url||(e="userinfo"):e="token":e="authorization",e)return new v(`Provider "${t.id}" is missing both \`issuer\` and \`${e}\` endpoint config. At least one of them is required`)}if("credentials"===t.type)J=!0;else if("email"===t.type)F=!0;else if("webauthn"===t.type){var l;if(V=!0,t.simpleWebAuthnBrowserVersion&&(l=t.simpleWebAuthnBrowserVersion,!/^v\d+(?:\.\d+){0,2}$/.test(l)))return new d(`Invalid provider config for "${t.id}": simpleWebAuthnBrowserVersion "${t.simpleWebAuthnBrowserVersion}" must be a valid semver string.`);if(t.enableConditionalUI){if(o)return new K("Multiple webauthn providers have 'enableConditionalUI' set to True. Only one provider can have this option enabled at a time");if(o=!0,!Object.values(t.formFields).some(e=>e.autocomplete&&e.autocomplete.toString().indexOf("webauthn")>-1))return new D(`Provider "${t.id}" has 'enableConditionalUI' set to True, but none of its formFields have 'webauthn' in their autocomplete param`)}}}if(J){let e=t.session?.strategy==="database",r=!t.providers.some(e=>"credentials"!==("function"==typeof e?e():e).type);if(e&&r)return new R("Signing in with credentials only supported if JWT strategy is enabled");if(t.providers.some(e=>{let t="function"==typeof e?e():e;return"credentials"===t.type&&!t.authorize}))return new T("Must define an authorize() handler to use credentials authentication provider")}let{adapter:u,session:h}=t,f=[];if(F||h?.strategy==="database"||!h?.strategy&&u)if(F){if(!u)return new A("Email login requires an adapter");f.push(...z)}else{if(!u)return new A("Database session requires an adapter");f.push(...G)}if(V){if(!t.experimental?.enableWebAuthn)return new H("WebAuthn is an experimental feature. To enable it, set `experimental.enableWebAuthn` to `true` in your config");if(i.push("experimental-webauthn"),!u)return new A("WebAuthn requires an adapter");f.push(...X)}if(u){let e=f.filter(e=>!(e in u));if(e.length)return new k(`Required adapter methods were missing: ${e.join(", ")}`)}return Q||(Q=!0),i}(i,t);if(Array.isArray(n))n.forEach(r.warn);else if(n){if(r.error(n),!new Set(["signin","signout","error","verify-request"]).has(i.action)||"GET"!==i.method)return Response.json({message:"There was a problem with the server configuration. Check the server logs for more information."},{status:500});let{pages:e,theme:s}=t,a=e?.error&&i.url.searchParams.get("callbackUrl")?.startsWith(e.error);if(!e?.error||a)return a&&r.error(new m(`The error page ${e?.error} should not require authentication`)),t1(ic({theme:s}).error("Configuration"));let o=`${i.url.origin}${e.error}?error=Configuration`;return Response.redirect(o)}let s=e.headers?.has("X-Auth-Return-Redirect"),a=t.raw===t7;try{let e=await sv(i,t);if(a)return e;let r=t1(e),n=r.headers.get("Location");if(!s||!n)return r;return Response.json({url:n},{headers:r.headers})}catch(h){r.error(h);let n=h instanceof d;if(n&&a&&!s)throw h;if("POST"===e.method&&"session"===i.action)return Response.json(null,{status:400});let o=new URLSearchParams({error:h instanceof d&&N.has(h.type)?h.type:"Configuration"});h instanceof w&&o.set("code",h.code);let l=n&&h.kind||"error",c=t.pages?.[l]??`${t.basePath}/${l.toLowerCase()}`,u=`${i.url.origin}${c}?${o}`;if(s)return Response.json({url:u});return Response.redirect(u)}}var sA=e.i(89171);function sk(e){let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return e;let{origin:r}=new URL(t),{href:i,origin:n}=e.nextUrl;return new sA.NextRequest(i.replace(n,r),e)}function sT(e){try{e.secret??(e.secret=process.env.AUTH_SECRET??process.env.NEXTAUTH_SECRET);let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return;let{pathname:r}=new URL(t);if("/"===r)return;e.basePath||(e.basePath=r)}catch{}finally{e.basePath||(e.basePath="/api/auth"),function(e,t,r=!1){try{let i=e.AUTH_URL;i&&(t.basePath?r||tz(t).warn("env-url-basepath-redundant"):t.basePath=new URL(i).pathname)}catch{}finally{t.basePath??(t.basePath="/auth")}if(!t.secret?.length){t.secret=[];let r=e.AUTH_SECRET;for(let i of(r&&t.secret.push(r),[1,2,3])){let r=e[`AUTH_SECRET_${i}`];r&&t.secret.unshift(r)}}t.redirectProxyUrl??(t.redirectProxyUrl=e.AUTH_REDIRECT_PROXY_URL),t.trustHost??(t.trustHost=!!(e.AUTH_URL??e.AUTH_TRUST_HOST??e.VERCEL??e.CF_PAGES??"production"!==e.NODE_ENV)),t.providers=t.providers.map(t=>{let{id:r}="function"==typeof t?t({}):t,i=r.toUpperCase().replace(/-/g,"_"),n=e[`AUTH_${i}_ID`],s=e[`AUTH_${i}_SECRET`],a=e[`AUTH_${i}_ISSUER`],o=e[`AUTH_${i}_KEY`],l="function"==typeof t?t({clientId:n,clientSecret:s,issuer:a,apiKey:o}):t;return"oauth"===l.type||"oidc"===l.type?(l.clientId??(l.clientId=n),l.clientSecret??(l.clientSecret=s),l.issuer??(l.issuer=a)):"email"===l.type&&(l.apiKey??(l.apiKey=o)),l})}(process.env,e,!0)}}var sx=e.i(93458);async function sE(e,t){return sS(new Request(s_("session",e.get("x-forwarded-proto"),e,process.env,t),{headers:{cookie:e.get("cookie")??""}}),{...t,callbacks:{...t.callbacks,async session(...e){let r=await t.callbacks?.session?.(...e)??{...e[0].session,expires:e[0].session.expires?.toISOString?.()??e[0].session.expires};return{user:e[0].user??e[0].token,...r}}}})}function sC(e){return"function"==typeof e}function sq(e,t){return"function"==typeof e?async(...r)=>{if(!r.length){let r=await (0,sx.headers)(),i=await e(void 0);return t?.(i),sE(r,i).then(e=>e.json())}if(r[0]instanceof Request){let i=r[0],n=r[1],s=await e(i);return t?.(s),s$([i,n],s)}if(sC(r[0])){let i=r[0];return async(...r)=>{let n=await e(r[0]);return t?.(n),s$(r,n,i)}}let i="req"in r[0]?r[0].req:r[0],n="res"in r[0]?r[0].res:r[1],s=await e(i);return t?.(s),sE(new Headers(i.headers),s).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in n?n.headers.append("set-cookie",t):n.appendHeader("set-cookie",t);return t})}:(...t)=>{if(!t.length)return Promise.resolve((0,sx.headers)()).then(t=>sE(t,e).then(e=>e.json()));if(t[0]instanceof Request)return s$([t[0],t[1]],e);if(sC(t[0])){let r=t[0];return async(...t)=>s$(t,e,r).then(e=>e)}let r="req"in t[0]?t[0].req:t[0],i="res"in t[0]?t[0].res:t[1];return sE(new Headers(r.headers),e).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in i?i.headers.append("set-cookie",t):i.appendHeader("set-cookie",t);return t})}}async function s$(e,t,r){let i=sk(e[0]),n=await sE(i.headers,t),s=await n.json(),a=!0;t.callbacks?.authorized&&(a=await t.callbacks.authorized({request:i,auth:s}));let o=sA.NextResponse.next?.();if(a instanceof Response){var l,c,u;let e,r;o=a;let n=a.headers.get("Location"),{pathname:s}=i.nextUrl;n&&(l=s,c=new URL(n).pathname,u=t,e=c.replace(`${l}/`,""),r=Object.values(u.pages??{}),(sO.has(e)||r.includes(c))&&c===l)&&(a=!0)}else if(r)i.auth=s,o=await r(i,e[1])??sA.NextResponse.next();else if(!a){let e=t.pages?.signIn??`${t.basePath}/signin`;if(i.nextUrl.pathname!==e){let t=i.nextUrl.clone();t.pathname=e,t.searchParams.set("callbackUrl",i.nextUrl.href),o=sA.NextResponse.redirect(t)}}let d=new Response(o?.body,o);for(let e of n.headers.getSetCookie())d.headers.append("set-cookie",e);return d}let sO=new Set(["providers","session","csrf","signin","signout","callback","verify-request","error"]);var sP=e.i(79509);async function sR(e,t={},r,i){let n=new Headers(await (0,sx.headers)()),{redirect:s=!0,redirectTo:a,...o}=t instanceof FormData?Object.fromEntries(t):t,l=a?.toString()??n.get("Referer")??"/",c=s_("signin",n.get("x-forwarded-proto"),n,process.env,i);if(!e)return c.searchParams.append("callbackUrl",l),s&&(0,sP.redirect)(c.toString()),c.toString();let u=`${c}/${e}?${new URLSearchParams(r)}`,d={};for(let t of i.providers){let{options:r,...i}="function"==typeof t?t():t,n=r?.id??i.id;if(n===e){d={id:n,type:r?.type??i.type};break}}if(!d.id){let e=`${c}?${new URLSearchParams({callbackUrl:l})}`;return s&&(0,sP.redirect)(e),e}"credentials"===d.type&&(u=u.replace("signin","callback")),n.set("Content-Type","application/x-www-form-urlencoded");let h=new Request(u,{method:"POST",headers:n,body:new URLSearchParams({...o,callbackUrl:l})}),f=await sS(h,{...i,raw:t7,skipCSRFCheck:t9}),p=await (0,sx.cookies)();for(let e of f?.cookies??[])p.set(e.name,e.value,e.options);let y=(f instanceof Response?f.headers.get("Location"):f.redirect)??u;return s?(0,sP.redirect)(y):y}async function sI(e,t){let r=new Headers(await (0,sx.headers)());r.set("Content-Type","application/x-www-form-urlencoded");let i=s_("signout",r.get("x-forwarded-proto"),r,process.env,t),n=new URLSearchParams({callbackUrl:e?.redirectTo??r.get("Referer")??"/"}),s=new Request(i,{method:"POST",headers:r,body:n}),a=await sS(s,{...t,raw:t7,skipCSRFCheck:t9}),o=await (0,sx.cookies)();for(let e of a?.cookies??[])o.set(e.name,e.value,e.options);return e?.redirect??!0?(0,sP.redirect)(a.redirect):a}async function sU(e,t){let r=new Headers(await (0,sx.headers)());r.set("Content-Type","application/json");let i=new Request(s_("session",r.get("x-forwarded-proto"),r,process.env,t),{method:"POST",headers:r,body:JSON.stringify({data:e})}),n=await sS(i,{...t,raw:t7,skipCSRFCheck:t9}),s=await (0,sx.cookies)();for(let e of n?.cookies??[])s.set(e.name,e.value,e.options);return n.body}var sL=e.i(44988),sj=e.i(47211),sN=e.i(18899),sK=e.i(92352),sD=sN;class sM extends sD.SQL{constructor(e){super(sM.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=sM.buildCount(e.source,e.filters)}sql;static [sL.entityKind]="MySqlCountBuilder";[Symbol.toStringTag]="MySqlCountBuilder";session;static buildEmbeddedCount(e,t){return sD.sql`(select count(*) from ${e}${sD.sql.raw(" where ").if(t)}${t})`}static buildCount(e,t){return sD.sql`select count(*) as count from ${e}${sD.sql.raw(" where ").if(t)}${t}`}then(e,t){return Promise.resolve(this.session.count(this.sql)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}var sB=e.i(98020),sH=e.i(69e3),sQ=e.i(88274);class sW{constructor(e,t){this.name=e,this.value=t}static [sL.entityKind]="MySqlCheckBuilder";brand;build(e){return new sJ(e,this)}}class sJ{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}static [sL.entityKind]="MySqlCheck";name;value}var sF=e.i(833);class sV{static [sL.entityKind]="MySqlForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:i}=e();return{name:t,columns:r,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new sz(e,this)}}class sz{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [sL.entityKind]="MySqlForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),i=t.map(e=>e.name),n=r.map(e=>e.name),s=[this.table[sF.TableName],...i,r[0].table[sF.TableName],...n];return e??`${s.join("_")}_fk`}}class sG{constructor(e,t){this.name=e,this.unique=t}static [sL.entityKind]="MySqlIndexBuilderOn";on(...e){return new sX(this.name,e,this.unique)}}class sX{static [sL.entityKind]="MySqlIndexBuilder";config;constructor(e,t,r){this.config={name:e,columns:t,unique:r}}using(e){return this.config.using=e,this}algorithm(e){return this.config.algorithm=e,this}lock(e){return this.config.lock=e,this}build(e){return new sY(this.config,e)}}class sY{static [sL.entityKind]="MySqlIndex";config;constructor(e,t){this.config={...e,table:t}}}var sZ=sH,s0=e.i(4313),s1=e.i(43179),s2=e.i(56325);function s5(e,t){return`${e[sF.TableName]}_${t.join("_")}_unique`}class s8{constructor(e,t){this.name=t,this.columns=e}static [sL.entityKind]="MySqlUniqueConstraintBuilder";columns;build(e){return new s4(e,this.columns,this.name)}}class s3{static [sL.entityKind]="MySqlUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new s8(e,this.name)}}class s4{constructor(e,t,r){this.table=e,this.columns=t,this.name=r??s5(this.table,this.columns.map(e=>e.name))}static [sL.entityKind]="MySqlUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}class s6 extends s1.ColumnBuilder{static [sL.entityKind]="MySqlColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}generatedAlwaysAs(e,t){return this.config.generated={as:e,type:"always",mode:t?.mode??"virtual"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:i})=>{let n;return n=new sV(()=>({columns:[e],foreignColumns:[r()]})),i.onUpdate&&n.onUpdate(i.onUpdate),i.onDelete&&n.onDelete(i.onDelete),n.build(t)})}}class s9 extends s2.Column{constructor(e,t){t.uniqueName||(t.uniqueName=s5(e,[t.name])),super(e,t),this.table=e}static [sL.entityKind]="MySqlColumn"}class s7 extends s6{static [sL.entityKind]="MySqlColumnBuilderWithAutoIncrement";constructor(e,t,r){super(e,t,r),this.config.autoIncrement=!1}autoincrement(){return this.config.autoIncrement=!0,this.config.hasDefault=!0,this}}class ae extends s9{static [sL.entityKind]="MySqlColumnWithAutoIncrement";autoIncrement=this.config.autoIncrement}class at extends s7{static [sL.entityKind]="MySqlBigInt53Builder";constructor(e,t=!1){super(e,"number","MySqlBigInt53"),this.config.unsigned=t}build(e){return new ar(e,this.config)}}class ar extends ae{static [sL.entityKind]="MySqlBigInt53";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class ai extends s7{static [sL.entityKind]="MySqlBigInt64Builder";constructor(e,t=!1){super(e,"bigint","MySqlBigInt64"),this.config.unsigned=t}build(e){return new an(e,this.config)}}class an extends ae{static [sL.entityKind]="MySqlBigInt64";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(e){return BigInt(e)}}function as(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return"number"===i.mode?new at(r,i.unsigned):new ai(r,i.unsigned)}class aa extends s6{static [sL.entityKind]="MySqlBinaryBuilder";constructor(e,t){super(e,"string","MySqlBinary"),this.config.length=t}build(e){return new ao(e,this.config)}}class ao extends s9{static [sL.entityKind]="MySqlBinary";length=this.config.length;mapFromDriverValue(e){if("string"==typeof e)return e;if(Buffer.isBuffer(e))return e.toString();let t=[];for(let r of e)t.push(49===r?"1":"0");return t.join("")}getSQLType(){return void 0===this.length?"binary":`binary(${this.length})`}}function al(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new aa(r,i.length)}class ac extends s6{static [sL.entityKind]="MySqlBooleanBuilder";constructor(e){super(e,"boolean","MySqlBoolean")}build(e){return new au(e,this.config)}}class au extends s9{static [sL.entityKind]="MySqlBoolean";getSQLType(){return"boolean"}mapFromDriverValue(e){return"boolean"==typeof e?e:1===e}}function ad(e){return new ac(e??"")}class ah extends s6{static [sL.entityKind]="MySqlCharBuilder";constructor(e,t){super(e,"string","MySqlChar"),this.config.length=t.length,this.config.enum=t.enum}build(e){return new af(e,this.config)}}class af extends s9{static [sL.entityKind]="MySqlChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function ap(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new ah(r,i)}class ay extends s6{static [sL.entityKind]="MySqlCustomColumnBuilder";constructor(e,t,r){super(e,"custom","MySqlCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new am(e,this.config)}}class am extends s9{static [sL.entityKind]="MySqlCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function ag(e){return(t,r)=>{let{name:i,config:n}=(0,s0.getColumnNameAndConfig)(t,r);return new ay(i,n,e)}}class ab extends s6{static [sL.entityKind]="MySqlDateBuilder";constructor(e){super(e,"date","MySqlDate")}build(e){return new aw(e,this.config)}}class aw extends s9{static [sL.entityKind]="MySqlDate";constructor(e,t){super(e,t)}getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}}class av extends s6{static [sL.entityKind]="MySqlDateStringBuilder";constructor(e){super(e,"string","MySqlDateString")}build(e){return new a_(e,this.config)}}class a_ extends s9{static [sL.entityKind]="MySqlDateString";constructor(e,t){super(e,t)}getSQLType(){return"date"}}function aS(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return i?.mode==="string"?new av(r):new ab(r)}class aA extends s6{static [sL.entityKind]="MySqlDateTimeBuilder";constructor(e,t){super(e,"date","MySqlDateTime"),this.config.fsp=t?.fsp}build(e){return new ak(e,this.config)}}class ak extends s9{static [sL.entityKind]="MySqlDateTime";fsp;constructor(e,t){super(e,t),this.fsp=t.fsp}getSQLType(){let e=void 0===this.fsp?"":`(${this.fsp})`;return`datetime${e}`}mapToDriverValue(e){return e.toISOString().replace("T"," ").replace("Z","")}mapFromDriverValue(e){return new Date(e.replace(" ","T")+"Z")}}class aT extends s6{static [sL.entityKind]="MySqlDateTimeStringBuilder";constructor(e,t){super(e,"string","MySqlDateTimeString"),this.config.fsp=t?.fsp}build(e){return new ax(e,this.config)}}class ax extends s9{static [sL.entityKind]="MySqlDateTimeString";fsp;constructor(e,t){super(e,t),this.fsp=t.fsp}getSQLType(){let e=void 0===this.fsp?"":`(${this.fsp})`;return`datetime${e}`}}function aE(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return i?.mode==="string"?new aT(r,i):new aA(r,i)}class aC extends s7{static [sL.entityKind]="MySqlDecimalBuilder";constructor(e,t){super(e,"string","MySqlDecimal"),this.config.precision=t?.precision,this.config.scale=t?.scale,this.config.unsigned=t?.unsigned}build(e){return new aq(e,this.config)}}class aq extends ae{static [sL.entityKind]="MySqlDecimal";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(e){return"string"==typeof e?e:String(e)}getSQLType(){let e="";return void 0!==this.precision&&void 0!==this.scale?e+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?e+="decimal":e+=`decimal(${this.precision})`,e="decimal(10,0)"===e||"decimal(10)"===e?"decimal":e,this.unsigned?`${e} unsigned`:e}}class a$ extends s7{static [sL.entityKind]="MySqlDecimalNumberBuilder";constructor(e,t){super(e,"number","MySqlDecimalNumber"),this.config.precision=t?.precision,this.config.scale=t?.scale,this.config.unsigned=t?.unsigned}build(e){return new aO(e,this.config)}}class aO extends ae{static [sL.entityKind]="MySqlDecimalNumber";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}mapToDriverValue=String;getSQLType(){let e="";return void 0!==this.precision&&void 0!==this.scale?e+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?e+="decimal":e+=`decimal(${this.precision})`,e="decimal(10,0)"===e||"decimal(10)"===e?"decimal":e,this.unsigned?`${e} unsigned`:e}}class aP extends s7{static [sL.entityKind]="MySqlDecimalBigIntBuilder";constructor(e,t){super(e,"bigint","MySqlDecimalBigInt"),this.config.precision=t?.precision,this.config.scale=t?.scale,this.config.unsigned=t?.unsigned}build(e){return new aR(e,this.config)}}class aR extends ae{static [sL.entityKind]="MySqlDecimalBigInt";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){let e="";return void 0!==this.precision&&void 0!==this.scale?e+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?e+="decimal":e+=`decimal(${this.precision})`,e="decimal(10,0)"===e||"decimal(10)"===e?"decimal":e,this.unsigned?`${e} unsigned`:e}}function aI(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t),n=i?.mode;return"number"===n?new a$(r,i):"bigint"===n?new aP(r,i):new aC(r,i)}class aU extends s7{static [sL.entityKind]="MySqlDoubleBuilder";constructor(e,t){super(e,"number","MySqlDouble"),this.config.precision=t?.precision,this.config.scale=t?.scale,this.config.unsigned=t?.unsigned}build(e){return new aL(e,this.config)}}class aL extends ae{static [sL.entityKind]="MySqlDouble";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let e="";return void 0!==this.precision&&void 0!==this.scale?e+=`double(${this.precision},${this.scale})`:void 0===this.precision?e+="double":e+=`double(${this.precision})`,this.unsigned?`${e} unsigned`:e}}function aj(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new aU(r,i)}class aN extends s6{static [sL.entityKind]="MySqlEnumColumnBuilder";constructor(e,t){super(e,"string","MySqlEnumColumn"),this.config.enumValues=t}build(e){return new aK(e,this.config)}}class aK extends s9{static [sL.entityKind]="MySqlEnumColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(e=>`'${e}'`).join(",")})`}}class aD extends s6{static [sL.entityKind]="MySqlEnumObjectColumnBuilder";constructor(e,t){super(e,"string","MySqlEnumObjectColumn"),this.config.enumValues=t}build(e){return new aM(e,this.config)}}class aM extends s9{static [sL.entityKind]="MySqlEnumObjectColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(e=>`'${e}'`).join(",")})`}}function aB(e,t){if("string"==typeof e&&Array.isArray(t)||Array.isArray(e)){let r="string"==typeof e&&e.length>0?e:"",i=("string"==typeof e?t:e)??[];if(0===i.length)throw Error(`You have an empty array for "${r}" enum values`);return new aN(r,i)}if("string"==typeof e&&"object"==typeof t||"object"==typeof e){let r="object"==typeof e?"":e,i="object"==typeof e?Object.values(e):"object"==typeof t?Object.values(t):[];if(0===i.length)throw Error(`You have an empty array for "${r}" enum values`);return new aD(r,i)}}class aH extends s7{static [sL.entityKind]="MySqlFloatBuilder";constructor(e,t){super(e,"number","MySqlFloat"),this.config.precision=t?.precision,this.config.scale=t?.scale,this.config.unsigned=t?.unsigned}build(e){return new aQ(e,this.config)}}class aQ extends ae{static [sL.entityKind]="MySqlFloat";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let e="";return void 0!==this.precision&&void 0!==this.scale?e+=`float(${this.precision},${this.scale})`:void 0===this.precision?e+="float":e+=`float(${this.precision})`,this.unsigned?`${e} unsigned`:e}}function aW(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new aH(r,i)}class aJ extends s7{static [sL.entityKind]="MySqlIntBuilder";constructor(e,t){super(e,"number","MySqlInt"),this.config.unsigned=!!t&&t.unsigned}build(e){return new aF(e,this.config)}}class aF extends ae{static [sL.entityKind]="MySqlInt";getSQLType(){return`int${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}function aV(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new aJ(r,i)}class az extends s6{static [sL.entityKind]="MySqlJsonBuilder";constructor(e){super(e,"json","MySqlJson")}build(e){return new aG(e,this.config)}}class aG extends s9{static [sL.entityKind]="MySqlJson";getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}}function aX(e){return new az(e??"")}class aY extends s7{static [sL.entityKind]="MySqlMediumIntBuilder";constructor(e,t){super(e,"number","MySqlMediumInt"),this.config.unsigned=!!t&&t.unsigned}build(e){return new aZ(e,this.config)}}class aZ extends ae{static [sL.entityKind]="MySqlMediumInt";getSQLType(){return`mediumint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}function a0(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new aY(r,i)}class a1 extends s7{static [sL.entityKind]="MySqlRealBuilder";constructor(e,t){super(e,"number","MySqlReal"),this.config.precision=t?.precision,this.config.scale=t?.scale}build(e){return new a2(e,this.config)}}class a2 extends ae{static [sL.entityKind]="MySqlReal";precision=this.config.precision;scale=this.config.scale;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`real(${this.precision}, ${this.scale})`:void 0===this.precision?"real":`real(${this.precision})`}}function a5(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new a1(r,i)}class a8 extends s7{static [sL.entityKind]="MySqlSerialBuilder";constructor(e){super(e,"number","MySqlSerial"),this.config.hasDefault=!0,this.config.autoIncrement=!0}build(e){return new a3(e,this.config)}}class a3 extends ae{static [sL.entityKind]="MySqlSerial";getSQLType(){return"serial"}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}function a4(e){return new a8(e??"")}class a6 extends s7{static [sL.entityKind]="MySqlSmallIntBuilder";constructor(e,t){super(e,"number","MySqlSmallInt"),this.config.unsigned=!!t&&t.unsigned}build(e){return new a9(e,this.config)}}class a9 extends ae{static [sL.entityKind]="MySqlSmallInt";getSQLType(){return`smallint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}function a7(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new a6(r,i)}class oe extends s6{static [sL.entityKind]="MySqlTextBuilder";constructor(e,t,r){super(e,"string","MySqlText"),this.config.textType=t,this.config.enumValues=r.enum}build(e){return new ot(e,this.config)}}class ot extends s9{static [sL.entityKind]="MySqlText";textType=this.config.textType;enumValues=this.config.enumValues;getSQLType(){return this.textType}}function or(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new oe(r,"text",i)}function oi(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new oe(r,"tinytext",i)}function on(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new oe(r,"mediumtext",i)}function os(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new oe(r,"longtext",i)}class oa extends s6{static [sL.entityKind]="MySqlTimeBuilder";constructor(e,t){super(e,"string","MySqlTime"),this.config.fsp=t?.fsp}build(e){return new oo(e,this.config)}}class oo extends s9{static [sL.entityKind]="MySqlTime";fsp=this.config.fsp;getSQLType(){let e=void 0===this.fsp?"":`(${this.fsp})`;return`time${e}`}}function ol(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new oa(r,i)}class oc extends s6{static [sL.entityKind]="MySqlDateColumnBuilder";defaultNow(){return this.default(sN.sql`(now())`)}onUpdateNow(){return this.config.hasOnUpdateNow=!0,this.config.hasDefault=!0,this}}class ou extends s9{static [sL.entityKind]="MySqlDateColumn";hasOnUpdateNow=this.config.hasOnUpdateNow}class od extends oc{static [sL.entityKind]="MySqlTimestampBuilder";constructor(e,t){super(e,"date","MySqlTimestamp"),this.config.fsp=t?.fsp}build(e){return new oh(e,this.config)}}class oh extends ou{static [sL.entityKind]="MySqlTimestamp";fsp=this.config.fsp;getSQLType(){let e=void 0===this.fsp?"":`(${this.fsp})`;return`timestamp${e}`}mapFromDriverValue(e){return new Date(e+"+0000")}mapToDriverValue(e){return e.toISOString().slice(0,-1).replace("T"," ")}}class of extends oc{static [sL.entityKind]="MySqlTimestampStringBuilder";constructor(e,t){super(e,"string","MySqlTimestampString"),this.config.fsp=t?.fsp}build(e){return new op(e,this.config)}}class op extends ou{static [sL.entityKind]="MySqlTimestampString";fsp=this.config.fsp;getSQLType(){let e=void 0===this.fsp?"":`(${this.fsp})`;return`timestamp${e}`}}function oy(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return i?.mode==="string"?new of(r,i):new od(r,i)}class om extends s7{static [sL.entityKind]="MySqlTinyIntBuilder";constructor(e,t){super(e,"number","MySqlTinyInt"),this.config.unsigned=!!t&&t.unsigned}build(e){return new og(e,this.config)}}class og extends ae{static [sL.entityKind]="MySqlTinyInt";getSQLType(){return`tinyint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}function ob(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new om(r,i)}class ow extends s6{static [sL.entityKind]="MySqlVarBinaryBuilder";constructor(e,t){super(e,"string","MySqlVarBinary"),this.config.length=t?.length}build(e){return new ov(e,this.config)}}class ov extends s9{static [sL.entityKind]="MySqlVarBinary";length=this.config.length;mapFromDriverValue(e){if("string"==typeof e)return e;if(Buffer.isBuffer(e))return e.toString();let t=[];for(let r of e)t.push(49===r?"1":"0");return t.join("")}getSQLType(){return void 0===this.length?"varbinary":`varbinary(${this.length})`}}function o_(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new ow(r,i)}class oS extends s6{static [sL.entityKind]="MySqlVarCharBuilder";constructor(e,t){super(e,"string","MySqlVarChar"),this.config.length=t.length,this.config.enum=t.enum}build(e){return new oA(e,this.config)}}class oA extends s9{static [sL.entityKind]="MySqlVarChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function ok(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return new oS(r,i)}class oT extends s6{static [sL.entityKind]="MySqlYearBuilder";constructor(e){super(e,"number","MySqlYear")}build(e){return new ox(e,this.config)}}class ox extends s9{static [sL.entityKind]="MySqlYear";getSQLType(){return"year"}}function oE(e){return new oT(e??"")}let oC=Symbol.for("drizzle:MySqlInlineForeignKeys");class oq extends sZ.Table{static [sL.entityKind]="MySqlTable";static Symbol=Object.assign({},sZ.Table.Symbol,{InlineForeignKeys:oC});[sZ.Table.Symbol.Columns];[oC]=[];[sZ.Table.Symbol.ExtraConfigBuilder]=void 0}let o$=(e,t,r)=>(function(e,t,r,i,n=e){let s=new oq(e,i,n),a=Object.fromEntries(Object.entries("function"==typeof t?t({bigint:as,binary:al,boolean:ad,char:ap,customType:ag,date:aS,datetime:aE,decimal:aI,double:aj,mysqlEnum:aB,float:aW,int:aV,json:aX,mediumint:a0,real:a5,serial:a4,smallint:a7,text:or,time:ol,timestamp:oy,tinyint:ob,varbinary:o_,varchar:ok,year:oE,longtext:os,mediumtext:on,tinytext:oi}):t).map(([e,t])=>{t.setName(e);let r=t.build(s);return s[oC].push(...t.buildForeignKeys(r,s)),[e,r]})),o=Object.assign(s,a);return o[sZ.Table.Symbol.Columns]=a,o[sZ.Table.Symbol.ExtraConfigColumns]=a,r&&(o[oq.Symbol.ExtraConfigBuilder]=r),o})(e,t,r,void 0,e);function oO(...e){return e[0].columns?new oP(e[0].columns,e[0].name):new oP(e)}class oP{static [sL.entityKind]="MySqlPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new oR(e,this.columns,this.name)}}class oR{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static [sL.entityKind]="MySqlPrimaryKey";columns;name;getName(){return this.name??`${this.table[oq.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}function oI(e){return(0,sL.is)(e,oq)?[`${e[sH.Table.Symbol.BaseName]}`]:(0,sL.is)(e,sK.Subquery)?e._.usedTables??[]:(0,sL.is)(e,sN.SQL)?e.usedTables??[]:[]}function oU(e){return e.map(e=>"object"==typeof e?e.config.name:e)}function oL(e){return Array.isArray(e)?e:[e]}Symbol.for("drizzle:MySqlViewConfig");class oj extends sB.QueryPromise{constructor(e,t,r,i){super(),this.table=e,this.session=t,this.dialect=r,this.config={table:e,withList:i}}static [sL.entityKind]="MySqlDelete";config;where(e){return this.config.where=e,this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.table[sH.Table.Symbol.Columns],new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.orderBy=r}else this.config.orderBy=e;return this}limit(e){return this.config.limit=e,this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}prepare(){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,void 0,void 0,void 0,{type:"delete",tables:oI(this.config.table)})}execute=e=>this.prepare().execute(e);createIterator=()=>{let e=this;return async function*(t){yield*e.prepare().iterator(t)}};iterator=this.createIterator();$dynamic(){return this}}var oN=sB,oK=e.i(5672),oD=e.i(22689),oM=e.i(71783),oB=e.i(79822),oH=e.i(75225),oQ=sN;class oW extends oQ.View{static [sL.entityKind]="MySqlViewBase"}class oJ{static [sL.entityKind]="MySqlDialect";casing;constructor(e){this.casing=new oD.CasingCache(e?.casing)}async migrate(e,t,r){let i=r.migrationsTable??"__drizzle_migrations",n=sN.sql`
			create table if not exists ${sN.sql.identifier(i)} (
				id serial primary key,
				hash text not null,
				created_at bigint
			)
		`;await t.execute(n);let s=(await t.all(sN.sql`select id, hash, created_at from ${sN.sql.identifier(i)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for(let r of e)if(!s||Number(s.created_at)<r.folderMillis){for(let e of r.sql)await t.execute(sN.sql.raw(e));await t.execute(sN.sql`insert into ${sN.sql.identifier(i)} (\`hash\`, \`created_at\`) values(${r.hash}, ${r.folderMillis})`)}})}escapeName(e){return`\`${e}\``}escapeParam(e){return"?"}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[sN.sql`with `];for(let[r,i]of e.entries())t.push(sN.sql`${sN.sql.identifier(i._.alias)} as (${i._.sql})`),r<e.length-1&&t.push(sN.sql`, `);return t.push(sN.sql` `),sN.sql.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:i,limit:n,orderBy:s}){let a=this.buildWithCTE(i),o=r?sN.sql` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,l=t?sN.sql` where ${t}`:void 0,c=this.buildOrderBy(s),u=this.buildLimit(n);return sN.sql`${a}delete from ${e}${l}${c}${u}${o}`}buildUpdateSet(e,t){let r=e[sH.Table.Symbol.Columns],i=Object.keys(r).filter(e=>void 0!==t[e]||r[e]?.onUpdateFn!==void 0),n=i.length;return sN.sql.join(i.flatMap((e,i)=>{let s=r[e],a=s.onUpdateFn?.(),o=t[e]??((0,sL.is)(a,sN.SQL)?a:sN.sql.param(a,s)),l=sN.sql`${sN.sql.identifier(this.casing.getColumnCasing(s))} = ${o}`;return i<n-1?[l,sN.sql.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:t,where:r,returning:i,withList:n,limit:s,orderBy:a}){let o=this.buildWithCTE(n),l=this.buildUpdateSet(e,t),c=i?sN.sql` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,u=r?sN.sql` where ${r}`:void 0,d=this.buildOrderBy(a),h=this.buildLimit(s);return sN.sql`${o}update ${e} set ${l}${u}${d}${h}${c}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,i=e.flatMap(({field:e},i)=>{let n=[];if((0,sL.is)(e,sN.SQL.Aliased)&&e.isSelectionField)n.push(sN.sql.identifier(e.fieldAlias));else if((0,sL.is)(e,sN.SQL.Aliased)||(0,sL.is)(e,sN.SQL)){let r=(0,sL.is)(e,sN.SQL.Aliased)?e.sql:e;t?n.push(new sN.SQL(r.queryChunks.map(e=>(0,sL.is)(e,s9)?sN.sql.identifier(this.casing.getColumnCasing(e)):e))):n.push(r),(0,sL.is)(e,sN.SQL.Aliased)&&n.push(sN.sql` as ${sN.sql.identifier(e.fieldAlias)}`)}else if((0,sL.is)(e,s2.Column))t?n.push(sN.sql.identifier(this.casing.getColumnCasing(e))):n.push(e);else if((0,sL.is)(e,sK.Subquery)){let t=Object.entries(e._.selectedFields);if(1===t.length){let r=t[0][1],i=(0,sL.is)(r,sN.SQL)?r.decoder:(0,sL.is)(r,s2.Column)?{mapFromDriverValue:e=>r.mapFromDriverValue(e)}:r.sql.decoder;i&&(e._.sql.decoder=i)}n.push(e)}return i<r-1&&n.push(sN.sql`, `),n});return sN.sql.join(i)}buildLimit(e){return"object"==typeof e||"number"==typeof e&&e>=0?sN.sql` limit ${e}`:void 0}buildOrderBy(e){return e&&e.length>0?sN.sql` order by ${sN.sql.join(e,sN.sql`, `)}`:void 0}buildIndex({indexes:e,indexFor:t}){return e&&e.length>0?sN.sql` ${sN.sql.raw(t)} INDEX (${sN.sql.raw(e.join(", "))})`:void 0}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:i,having:n,table:s,joins:a,orderBy:o,groupBy:l,limit:c,offset:u,lockingClause:d,distinct:h,setOperators:f,useIndex:p,forceIndex:y,ignoreIndex:m}){let g,b=r??(0,s0.orderSelectedFields)(t);for(let e of b){let t;if((0,sL.is)(e.field,s2.Column)&&(0,sH.getTableName)(e.field.table)!==((0,sL.is)(s,sK.Subquery)?s._.alias:(0,sL.is)(s,oW)?s[sQ.ViewBaseConfig].name:(0,sL.is)(s,sN.SQL)?void 0:(0,sH.getTableName)(s))&&(t=e.field.table,!a?.some(({alias:e})=>e===(t[sH.Table.Symbol.IsAlias]?(0,sH.getTableName)(t):t[sH.Table.Symbol.BaseName])))){let t=(0,sH.getTableName)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let w=!a||0===a.length,v=this.buildWithCTE(e),_=h?sN.sql` distinct`:void 0,S=this.buildSelection(b,{isSingleTable:w}),A=(0,sL.is)(s,sH.Table)&&s[sH.Table.Symbol.IsAlias]?sN.sql`${sN.sql`${sN.sql.identifier(s[sH.Table.Symbol.Schema]??"")}.`.if(s[sH.Table.Symbol.Schema])}${sN.sql.identifier(s[sH.Table.Symbol.OriginalName])} ${sN.sql.identifier(s[sH.Table.Symbol.Name])}`:s,k=[];if(a)for(let[e,t]of a.entries()){0===e&&k.push(sN.sql` `);let r=t.table,i=t.lateral?sN.sql` lateral`:void 0,n=t.on?sN.sql` on ${t.on}`:void 0;if((0,sL.is)(r,oq)){let e=r[oq.Symbol.Name],s=r[oq.Symbol.Schema],a=r[oq.Symbol.OriginalName],o=e===a?void 0:t.alias,l=this.buildIndex({indexes:t.useIndex,indexFor:"USE"}),c=this.buildIndex({indexes:t.forceIndex,indexFor:"FORCE"}),u=this.buildIndex({indexes:t.ignoreIndex,indexFor:"IGNORE"});k.push(sN.sql`${sN.sql.raw(t.joinType)} join${i} ${s?sN.sql`${sN.sql.identifier(s)}.`:void 0}${sN.sql.identifier(a)}${l}${c}${u}${o&&sN.sql` ${sN.sql.identifier(o)}`}${n}`)}else if((0,sL.is)(r,sN.View)){let e=r[sQ.ViewBaseConfig].name,s=r[sQ.ViewBaseConfig].schema,a=r[sQ.ViewBaseConfig].originalName,o=e===a?void 0:t.alias;k.push(sN.sql`${sN.sql.raw(t.joinType)} join${i} ${s?sN.sql`${sN.sql.identifier(s)}.`:void 0}${sN.sql.identifier(a)}${o&&sN.sql` ${sN.sql.identifier(o)}`}${n}`)}else k.push(sN.sql`${sN.sql.raw(t.joinType)} join${i} ${r}${n}`);e<a.length-1&&k.push(sN.sql` `)}let T=sN.sql.join(k),x=i?sN.sql` where ${i}`:void 0,E=n?sN.sql` having ${n}`:void 0,C=this.buildOrderBy(o),q=l&&l.length>0?sN.sql` group by ${sN.sql.join(l,sN.sql`, `)}`:void 0,$=this.buildLimit(c),O=u?sN.sql` offset ${u}`:void 0,P=this.buildIndex({indexes:p,indexFor:"USE"}),R=this.buildIndex({indexes:y,indexFor:"FORCE"}),I=this.buildIndex({indexes:m,indexFor:"IGNORE"});if(d){let{config:e,strength:t}=d;g=sN.sql` for ${sN.sql.raw(t)}`,e.noWait?g.append(sN.sql` nowait`):e.skipLocked&&g.append(sN.sql` skip locked`)}let U=sN.sql`${v}select${_} ${S} from ${A}${P}${R}${I}${T}${x}${q}${E}${C}${$}${O}${g}`;return f.length>0?this.buildSetOperations(U,f):U}buildSetOperations(e,t){let[r,...i]=t;if(!r)throw Error("Cannot pass undefined values to any set operator");return 0===i.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:i,limit:n,orderBy:s,offset:a}}){let o,l=sN.sql`(${e.getSQL()}) `,c=sN.sql`(${i.getSQL()})`;if(s&&s.length>0){let e=[];for(let t of s)if((0,sL.is)(t,s9))e.push(sN.sql.identifier(this.casing.getColumnCasing(t)));else if((0,sL.is)(t,sN.SQL)){for(let e=0;e<t.queryChunks.length;e++){let r=t.queryChunks[e];(0,sL.is)(r,s9)&&(t.queryChunks[e]=sN.sql.identifier(this.casing.getColumnCasing(r)))}e.push(sN.sql`${t}`)}else e.push(sN.sql`${t}`);o=sN.sql` order by ${sN.sql.join(e,sN.sql`, `)} `}let u="object"==typeof n||"number"==typeof n&&n>=0?sN.sql` limit ${n}`:void 0,d=sN.sql.raw(`${t} ${r?"all ":""}`),h=a?sN.sql` offset ${a}`:void 0;return sN.sql`${l}${d}${c}${o}${u}${h}`}buildInsertQuery({table:e,values:t,ignore:r,onConflict:i,select:n}){let s=[],a=Object.entries(e[sH.Table.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),o=a.map(([,e])=>sN.sql.identifier(this.casing.getColumnCasing(e))),l=[];if(n)(0,sL.is)(t,sN.SQL)?s.push(t):s.push(t.getSQL());else for(let[e,r]of(s.push(sN.sql.raw("values ")),t.entries())){let i={},n=[];for(let[e,t]of a){let s=r[e];if(void 0===s||(0,sL.is)(s,sN.Param)&&void 0===s.value)if(void 0!==t.defaultFn){let r=t.defaultFn();i[e]=r;let s=(0,sL.is)(r,sN.SQL)?r:sN.sql.param(r,t);n.push(s)}else if(t.default||void 0===t.onUpdateFn)n.push(sN.sql`default`);else{let e=t.onUpdateFn(),r=(0,sL.is)(e,sN.SQL)?e:sN.sql.param(e,t);n.push(r)}else t.defaultFn&&(0,sL.is)(s,sN.Param)&&(i[e]=s.value),n.push(s)}l.push(i),s.push(n),e<t.length-1&&s.push(sN.sql`, `)}let c=sN.sql.join(s),u=r?sN.sql` ignore`:void 0,d=i?sN.sql` on duplicate key ${i}`:void 0;return{sql:sN.sql`insert${u} into ${e} ${o} ${c}${d}`,generatedIds:l}}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:t})}buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:i,tableConfig:n,queryConfig:s,tableAlias:a,nestedQueryRelation:o,joinOn:l}){let c,u,d,h,f,p=[],y=[];if(!0===s)p=Object.entries(n.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:(0,oK.aliasedTableColumn)(t,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let i=Object.fromEntries(Object.entries(n.columns).map(([e,t])=>[e,(0,oK.aliasedTableColumn)(t,a)]));if(s.where){let e="function"==typeof s.where?s.where(i,(0,oB.getOperators)()):s.where;h=e&&(0,oK.mapColumnsInSQLToAlias)(e,a)}let o=[],l=[];if(s.columns){let e=!1;for(let[t,r]of Object.entries(s.columns))void 0!==r&&t in n.columns&&(e||!0!==r||(e=!0),l.push(t));l.length>0&&(l=e?l.filter(e=>s.columns?.[e]===!0):Object.keys(n.columns).filter(e=>!l.includes(e)))}else l=Object.keys(n.columns);for(let e of l){let t=n.columns[e];o.push({tsKey:e,value:t})}let f=[];if(s.with&&(f=Object.entries(s.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:n.relations[e]}))),s.extras)for(let[e,t]of Object.entries("function"==typeof s.extras?s.extras(i,{sql:sN.sql}):s.extras))o.push({tsKey:e,value:(0,oK.mapColumnsInAliasedSQLToAlias)(t,a)});for(let{tsKey:e,value:t}of o)p.push({dbKey:(0,sL.is)(t,sN.SQL.Aliased)?t.fieldAlias:n.columns[e].name,tsKey:e,field:(0,sL.is)(t,s2.Column)?(0,oK.aliasedTableColumn)(t,a):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let m="function"==typeof s.orderBy?s.orderBy(i,(0,oB.getOrderByOperators)()):s.orderBy??[];for(let{tsKey:i,queryConfig:n,relation:o}of(Array.isArray(m)||(m=[m]),d=m.map(e=>(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):(0,oK.mapColumnsInSQLToAlias)(e,a)),c=s.limit,u=s.offset,f)){let s=(0,oB.normalizeRelation)(t,r,o),l=r[(0,sH.getTableUniqueName)(o.referencedTable)],c=`${a}_${i}`,u=(0,oH.and)(...s.fields.map((e,t)=>(0,oH.eq)((0,oK.aliasedTableColumn)(s.references[t],c),(0,oK.aliasedTableColumn)(e,a)))),d=this.buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:e[l],tableConfig:t[l],queryConfig:(0,sL.is)(o,oB.One)?!0===n?{limit:1}:{...n,limit:1}:n,tableAlias:c,joinOn:u,nestedQueryRelation:o}),h=sN.sql`${sN.sql.identifier(c)}.${sN.sql.identifier("data")}`.as(i);y.push({on:sN.sql`true`,table:new sK.Subquery(d.sql,{},c),alias:c,joinType:"left",lateral:!0}),p.push({dbKey:i,tsKey:i,field:h,relationTableTsKey:l,isJson:!0,selection:d.selection})}}if(0===p.length)throw new oM.DrizzleError({message:`No fields selected for table "${n.tsName}" ("${a}")`});if(h=(0,oH.and)(l,h),o){let e=sN.sql`json_array(${sN.sql.join(p.map(({field:e,tsKey:t,isJson:r})=>r?sN.sql`${sN.sql.identifier(`${a}_${t}`)}.${sN.sql.identifier("data")}`:(0,sL.is)(e,sN.SQL.Aliased)?e.sql:e),sN.sql`, `)})`;(0,sL.is)(o,oB.Many)&&(e=sN.sql`coalesce(json_arrayagg(${e}), json_array())`);let t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:n.tsName,selection:p}];void 0!==c||void 0!==u||(d?.length??0)>0?(f=this.buildSelectQuery({table:(0,oK.aliasedTable)(i,a),fields:{},fieldsFlat:[{path:[],field:sN.sql.raw("*")},...(d?.length??0)>0?[{path:[],field:sN.sql`row_number() over (order by ${sN.sql.join(d,sN.sql`, `)})`}]:[]],where:h,limit:c,offset:u,setOperators:[]}),h=void 0,c=void 0,u=void 0,d=void 0):f=(0,oK.aliasedTable)(i,a),f=this.buildSelectQuery({table:(0,sL.is)(f,oq)?f:new sK.Subquery(f,{},a),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):e})),joins:y,where:h,limit:c,offset:u,orderBy:d,setOperators:[]})}else f=this.buildSelectQuery({table:(0,oK.aliasedTable)(i,a),fields:{},fieldsFlat:p.map(({field:e})=>({path:[],field:(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):e})),joins:y,where:h,limit:c,offset:u,orderBy:d,setOperators:[]});return{tableTsKey:n.tsName,sql:f,selection:p}}buildRelationalQueryWithoutLateralSubqueries({fullSchema:e,schema:t,tableNamesMap:r,table:i,tableConfig:n,queryConfig:s,tableAlias:a,nestedQueryRelation:o,joinOn:l}){let c,u=[],d,h,f=[],p;if(!0===s)u=Object.entries(n.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:(0,oK.aliasedTableColumn)(t,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let i=Object.fromEntries(Object.entries(n.columns).map(([e,t])=>[e,(0,oK.aliasedTableColumn)(t,a)]));if(s.where){let e="function"==typeof s.where?s.where(i,(0,oB.getOperators)()):s.where;p=e&&(0,oK.mapColumnsInSQLToAlias)(e,a)}let o=[],l=[];if(s.columns){let e=!1;for(let[t,r]of Object.entries(s.columns))void 0!==r&&t in n.columns&&(e||!0!==r||(e=!0),l.push(t));l.length>0&&(l=e?l.filter(e=>s.columns?.[e]===!0):Object.keys(n.columns).filter(e=>!l.includes(e)))}else l=Object.keys(n.columns);for(let e of l){let t=n.columns[e];o.push({tsKey:e,value:t})}let c=[];if(s.with&&(c=Object.entries(s.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:n.relations[e]}))),s.extras)for(let[e,t]of Object.entries("function"==typeof s.extras?s.extras(i,{sql:sN.sql}):s.extras))o.push({tsKey:e,value:(0,oK.mapColumnsInAliasedSQLToAlias)(t,a)});for(let{tsKey:e,value:t}of o)u.push({dbKey:(0,sL.is)(t,sN.SQL.Aliased)?t.fieldAlias:n.columns[e].name,tsKey:e,field:(0,sL.is)(t,s2.Column)?(0,oK.aliasedTableColumn)(t,a):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let y="function"==typeof s.orderBy?s.orderBy(i,(0,oB.getOrderByOperators)()):s.orderBy??[];for(let{tsKey:i,queryConfig:n,relation:o}of(Array.isArray(y)||(y=[y]),f=y.map(e=>(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):(0,oK.mapColumnsInSQLToAlias)(e,a)),d=s.limit,h=s.offset,c)){let s=(0,oB.normalizeRelation)(t,r,o),l=r[(0,sH.getTableUniqueName)(o.referencedTable)],c=`${a}_${i}`,d=(0,oH.and)(...s.fields.map((e,t)=>(0,oH.eq)((0,oK.aliasedTableColumn)(s.references[t],c),(0,oK.aliasedTableColumn)(e,a)))),h=this.buildRelationalQueryWithoutLateralSubqueries({fullSchema:e,schema:t,tableNamesMap:r,table:e[l],tableConfig:t[l],queryConfig:(0,sL.is)(o,oB.One)?!0===n?{limit:1}:{...n,limit:1}:n,tableAlias:c,joinOn:d,nestedQueryRelation:o}),f=sN.sql`(${h.sql})`;(0,sL.is)(o,oB.Many)&&(f=sN.sql`coalesce(${f}, json_array())`);let p=f.as(i);u.push({dbKey:i,tsKey:i,field:p,relationTableTsKey:l,isJson:!0,selection:h.selection})}}if(0===u.length)throw new oM.DrizzleError({message:`No fields selected for table "${n.tsName}" ("${a}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});if(p=(0,oH.and)(l,p),o){let e=sN.sql`json_array(${sN.sql.join(u.map(({field:e})=>(0,sL.is)(e,s9)?sN.sql.identifier(this.casing.getColumnCasing(e)):(0,sL.is)(e,sN.SQL.Aliased)?e.sql:e),sN.sql`, `)})`;(0,sL.is)(o,oB.Many)&&(e=sN.sql`json_arrayagg(${e})`);let t=[{dbKey:"data",tsKey:"data",field:e,isJson:!0,relationTableTsKey:n.tsName,selection:u}];void 0!==d||void 0!==h||f.length>0?(c=this.buildSelectQuery({table:(0,oK.aliasedTable)(i,a),fields:{},fieldsFlat:[{path:[],field:sN.sql.raw("*")},...f.length>0?[{path:[],field:sN.sql`row_number() over (order by ${sN.sql.join(f,sN.sql`, `)})`}]:[]],where:p,limit:d,offset:h,setOperators:[]}),p=void 0,d=void 0,h=void 0,f=void 0):c=(0,oK.aliasedTable)(i,a),c=this.buildSelectQuery({table:(0,sL.is)(c,oq)?c:new sK.Subquery(c,{},a),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):e})),where:p,limit:d,offset:h,orderBy:f,setOperators:[]})}else c=this.buildSelectQuery({table:(0,oK.aliasedTable)(i,a),fields:{},fieldsFlat:u.map(({field:e})=>({path:[],field:(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):e})),where:p,limit:d,offset:h,orderBy:f,setOperators:[]});return{tableTsKey:n.tsName,sql:c,selection:u}}}var oF=e.i(57235);class oV{static [sL.entityKind]="MySqlSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e,t){let r,i=!!this.fields;r=this.fields?this.fields:(0,sL.is)(e,sK.Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,sL.is)(e,oW)?e[sQ.ViewBaseConfig].selectedFields:(0,sL.is)(e,sN.SQL)?{}:(0,s0.getTableColumns)(e);let n=[],s=[],a=[];return(0,sL.is)(e,oq)&&t&&"string"!=typeof t&&(t.useIndex&&(n=oU(oL(t.useIndex))),t.forceIndex&&(s=oU(oL(t.forceIndex))),t.ignoreIndex&&(a=oU(oL(t.ignoreIndex)))),new oG({table:e,fields:r,isPartialSelect:i,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct,useIndex:n,forceIndex:s,ignoreIndex:a})}}class oz extends oF.TypedQueryBuilder{static [sL.entityKind]="MySqlSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:r,session:i,dialect:n,withList:s,distinct:a,useIndex:o,forceIndex:l,ignoreIndex:c}){for(const u of(super(),this.config={withList:s,table:e,fields:{...t},distinct:a,setOperators:[],useIndex:o,forceIndex:l,ignoreIndex:c},this.isPartialSelect=r,this.session=i,this.dialect=n,this._={selectedFields:t,config:this.config},this.tableName=(0,s0.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},oI(e)))this.usedTables.add(u)}getUsedTables(){return[...this.usedTables]}createJoin(e,t){return(r,i,n)=>{let s="cross"===e,a=s?void 0:i,o=s?i:n,l=this.tableName,c=(0,s0.getTableLikeName)(r);for(let e of oI(r))this.usedTables.add(e);if("string"==typeof c&&this.config.joins?.some(e=>e.alias===c))throw Error(`Alias "${c}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof l&&(this.config.fields={[l]:this.config.fields}),"string"==typeof c&&!(0,sL.is)(r,sN.SQL))){let e=(0,sL.is)(r,sK.Subquery)?r._.selectedFields:(0,sL.is)(r,sN.View)?r[sQ.ViewBaseConfig].selectedFields:r[sH.Table.Symbol.Columns];this.config.fields[c]=e}"function"==typeof a&&(a=a(new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]);let u=[],d=[],h=[];if((0,sL.is)(r,oq)&&o&&"string"!=typeof o&&(o.useIndex&&(u=oU(oL(o.useIndex))),o.forceIndex&&(d=oU(oL(o.forceIndex))),o.ignoreIndex&&(h=oU(oL(o.ignoreIndex)))),this.config.joins.push({on:a,table:r,joinType:e,alias:c,useIndex:u,forceIndex:d,ignoreIndex:h,lateral:t}),"string"==typeof c)switch(e){case"left":this.joinsNotNullableMap[c]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[c]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[c]=!0}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(e,t){return r=>{let i="function"==typeof r?r(oY()):r;if(!(0,s0.haveSameKeys)(this.getSelectedFields(),i.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){let t=[];if(t.push(...oI(this.config.table)),this.config.joins)for(let e of this.config.joins)t.push(...oI(e.table));return new Proxy(new sK.Subquery(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new sj.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new sj.SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(e){return this.cacheConfig=void 0===e?{config:{},enable:!0,autoInvalidate:!0}:!1===e?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}}class oG extends oz{static [sL.entityKind]="MySqlSelect";prepare(){if(!this.session)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let e=(0,s0.orderSelectedFields)(this.config.fields),t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),e,void 0,void 0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}execute=e=>this.prepare().execute(e);createIterator=()=>{let e=this;return async function*(t){yield*e.prepare().iterator(t)}};iterator=this.createIterator()}function oX(e,t){return(r,i,...n)=>{let s=[i,...n].map(r=>({type:e,isAll:t,rightSelect:r}));for(let e of s)if(!(0,s0.haveSameKeys)(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(s)}}(0,s0.applyMixins)(oG,[sB.QueryPromise]);let oY=()=>({union:oZ,unionAll:o0,intersect:o1,intersectAll:o2,except:o5,exceptAll:o8}),oZ=oX("union",!1),o0=oX("union",!0),o1=oX("intersect",!1),o2=oX("intersect",!0),o5=oX("except",!1),o8=oX("except",!0);class o3{static [sL.entityKind]="MySqlQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,sL.is)(e,oJ)?e:void 0,this.dialectConfig=(0,sL.is)(e,oJ)?void 0:e}$with=(e,t)=>{let r=this;return{as:i=>("function"==typeof i&&(i=i(r)),new Proxy(new sK.WithSubquery(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new sj.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;return{select:function(r){return new oV({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(r){return new oV({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e,distinct:!0})}}}select(e){return new oV({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new oV({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new oJ(this.dialectConfig)),this.dialect}}class o4{constructor(e,t,r){this.table=e,this.session=t,this.dialect=r}static [sL.entityKind]="MySqlInsertBuilder";shouldIgnore=!1;ignore(){return this.shouldIgnore=!0,this}values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let t=e.map(e=>{let t={},r=this.table[sH.Table.Symbol.Columns];for(let i of Object.keys(e)){let n=e[i];t[i]=(0,sL.is)(n,sN.SQL)?n:new sN.Param(n,r[i])}return t});return new o6(this.table,t,this.shouldIgnore,this.session,this.dialect)}select(e){let t="function"==typeof e?e(new o3):e;if(!(0,sL.is)(t,sN.SQL)&&!(0,s0.haveSameKeys)(this.table[sH.Columns],t._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new o6(this.table,t,this.shouldIgnore,this.session,this.dialect,!0)}}class o6 extends oN.QueryPromise{constructor(e,t,r,i,n,s){super(),this.session=i,this.dialect=n,this.config={table:e,values:t,select:s,ignore:r}}static [sL.entityKind]="MySqlInsert";config;cacheConfig;onDuplicateKeyUpdate(e){let t=this.dialect.buildUpdateSet(this.config.table,(0,s0.mapUpdateSet)(this.config.table,e.set));return this.config.onConflict=sN.sql`update ${t}`,this}$returningId(){let e=[];for(let[t,r]of Object.entries(this.config.table[sH.Table.Symbol.Columns]))r.primary&&e.push({field:r,path:[t]});return this.config.returning=e,this}getSQL(){return this.dialect.buildInsertQuery(this.config).sql}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}prepare(){let{sql:e,generatedIds:t}=this.dialect.buildInsertQuery(this.config);return this.session.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,t,this.config.returning,{type:"insert",tables:oI(this.config.table)},this.cacheConfig)}execute=e=>this.prepare().execute(e);createIterator=()=>{let e=this;return async function*(t){yield*e.prepare().iterator(t)}};iterator=this.createIterator();$dynamic(){return this}}var o9=sB;class o7{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static [sL.entityKind]="MySqlUpdateBuilder";set(e){return new le(this.table,(0,s0.mapUpdateSet)(this.table,e),this.session,this.dialect,this.withList)}}class le extends o9.QueryPromise{constructor(e,t,r,i,n){super(),this.session=r,this.dialect=i,this.config={set:t,table:e,withList:n}}static [sL.entityKind]="MySqlUpdate";config;cacheConfig;where(e){return this.config.where=e,this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.table[sH.Table.Symbol.Columns],new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.orderBy=r}else this.config.orderBy=e;return this}limit(e){return this.config.limit=e,this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}prepare(){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,void 0,void 0,this.config.returning,{type:"insert",tables:oI(this.config.table)},this.cacheConfig)}execute=e=>this.prepare().execute(e);createIterator=()=>{let e=this;return async function*(t){yield*e.prepare().iterator(t)}};iterator=this.createIterator();$dynamic(){return this}}var lt=sB;class lr{constructor(e,t,r,i,n,s,a,o){this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=a,this.mode=o}static [sL.entityKind]="MySqlRelationalQueryBuilder";findMany(e){return new li(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many",this.mode)}findFirst(e){return new li(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first",this.mode)}}class li extends lt.QueryPromise{constructor(e,t,r,i,n,s,a,o,l,c){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=a,this.config=o,this.queryMode=l,this.mode=c}static [sL.entityKind]="MySqlRelationalQuery";prepare(){let{query:e,builtQuery:t}=this._toSQL();return this.session.prepareQuery(t,void 0,t=>{let r=t.map(t=>(0,oB.mapRelationalRow)(this.schema,this.tableConfig,t,e.selection));return"first"===this.queryMode?r[0]:r})}_getQuery(){return"planetscale"===this.mode?this.dialect.buildRelationalQueryWithoutLateralSubqueries({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}):this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}_toSQL(){let e=this._getQuery();return{builtQuery:this.dialect.sqlToQuery(e.sql),query:e}}getSQL(){return this._getQuery().sql}toSQL(){return this._toSQL().builtQuery}execute(){return this.prepare().execute()}}class ln{constructor(e,t,r,i){if(this.dialect=e,this.session=t,this.mode=i,this._=r?{schema:r.schema,fullSchema:r.fullSchema,tableNamesMap:r.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={},this._.schema)for(const[i,n]of Object.entries(this._.schema))this.query[i]=new lr(r.fullSchema,this._.schema,this._.tableNamesMap,r.fullSchema[i],n,e,t,this.mode);this.$cache={invalidate:async e=>{}}}static [sL.entityKind]="MySqlDatabase";query;$with=(e,t)=>{let r=this;return{as:i=>("function"==typeof i&&(i=i(new o3(r.dialect))),new Proxy(new sK.WithSubquery(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new sj.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new sM({source:e,filters:t,session:this.session})}$cache;with(...e){let t=this;return{select:function(r){return new oV({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new oV({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},update:function(r){return new o7(r,t.session,t.dialect,e)},delete:function(r){return new oj(r,t.session,t.dialect,e)}}}select(e){return new oV({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new oV({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(e){return new o7(e,this.session,this.dialect)}insert(e){return new o4(e,this.session,this.dialect)}delete(e){return new oj(e,this.session,this.dialect)}execute(e){return this.session.execute("string"==typeof e?sN.sql.raw(e):e.getSQL())}transaction(e,t){return this.session.transaction(e,t)}}var ls=e.i(44482),la=s1,lo=s2;class ll{static [sL.entityKind]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:i}=e();return{name:t,columns:r,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new lc(e,this)}}class lc{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [sL.entityKind]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),i=t.map(e=>e.name),n=r.map(e=>e.name),s=[this.table[sF.TableName],...i,r[0].table[sF.TableName],...n];return e??`${s.join("_")}_fk`}}function lu(e,t){return`${e[sF.TableName]}_${t.join("_")}_unique`}class ld{constructor(e,t){this.name=t,this.columns=e}static [sL.entityKind]="SQLiteUniqueConstraintBuilder";columns;build(e){return new lf(e,this.columns,this.name)}}class lh{static [sL.entityKind]="SQLiteUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new ld(e,this.name)}}class lf{constructor(e,t,r){this.table=e,this.columns=t,this.name=r??lu(this.table,this.columns.map(e=>e.name))}static [sL.entityKind]="SQLiteUniqueConstraint";columns;name;getName(){return this.name}}class lp extends la.ColumnBuilder{static [sL.entityKind]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}generatedAlwaysAs(e,t){return this.config.generated={as:e,type:"always",mode:t?.mode??"virtual"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:i})=>{let n;return n=new ll(()=>({columns:[e],foreignColumns:[r()]})),i.onUpdate&&n.onUpdate(i.onUpdate),i.onDelete&&n.onDelete(i.onDelete),n.build(t)})}}class ly extends lo.Column{constructor(e,t){t.uniqueName||(t.uniqueName=lu(e,[t.name])),super(e,t),this.table=e}static [sL.entityKind]="SQLiteColumn"}var lm=sH;class lg extends lp{static [sL.entityKind]="SQLiteBigIntBuilder";constructor(e){super(e,"bigint","SQLiteBigInt")}build(e){return new lb(e,this.config)}}class lb extends ly{static [sL.entityKind]="SQLiteBigInt";getSQLType(){return"blob"}mapFromDriverValue(e){return"undefined"!=typeof Buffer&&Buffer.from?BigInt((Buffer.isBuffer(e)?e:e instanceof ArrayBuffer?Buffer.from(e):e.buffer?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e)).toString("utf8")):BigInt(s0.textDecoder.decode(e))}mapToDriverValue(e){return Buffer.from(e.toString())}}class lw extends lp{static [sL.entityKind]="SQLiteBlobJsonBuilder";constructor(e){super(e,"json","SQLiteBlobJson")}build(e){return new lv(e,this.config)}}class lv extends ly{static [sL.entityKind]="SQLiteBlobJson";getSQLType(){return"blob"}mapFromDriverValue(e){return"undefined"!=typeof Buffer&&Buffer.from?JSON.parse((Buffer.isBuffer(e)?e:e instanceof ArrayBuffer?Buffer.from(e):e.buffer?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e)).toString("utf8")):JSON.parse(s0.textDecoder.decode(e))}mapToDriverValue(e){return Buffer.from(JSON.stringify(e))}}class l_ extends lp{static [sL.entityKind]="SQLiteBlobBufferBuilder";constructor(e){super(e,"buffer","SQLiteBlobBuffer")}build(e){return new lS(e,this.config)}}class lS extends ly{static [sL.entityKind]="SQLiteBlobBuffer";mapFromDriverValue(e){return Buffer.isBuffer(e)?e:Buffer.from(e)}getSQLType(){return"blob"}}function lA(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return i?.mode==="json"?new lw(r):i?.mode==="bigint"?new lg(r):new l_(r)}class lk extends lp{static [sL.entityKind]="SQLiteCustomColumnBuilder";constructor(e,t,r){super(e,"custom","SQLiteCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new lT(e,this.config)}}class lT extends ly{static [sL.entityKind]="SQLiteCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function lx(e){return(t,r)=>{let{name:i,config:n}=(0,s0.getColumnNameAndConfig)(t,r);return new lk(i,n,e)}}class lE extends lp{static [sL.entityKind]="SQLiteBaseIntegerBuilder";constructor(e,t,r){super(e,t,r),this.config.autoIncrement=!1}primaryKey(e){return e?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class lC extends ly{static [sL.entityKind]="SQLiteBaseInteger";autoIncrement=this.config.autoIncrement;getSQLType(){return"integer"}}class lq extends lE{static [sL.entityKind]="SQLiteIntegerBuilder";constructor(e){super(e,"number","SQLiteInteger")}build(e){return new l$(e,this.config)}}class l$ extends lC{static [sL.entityKind]="SQLiteInteger"}class lO extends lE{static [sL.entityKind]="SQLiteTimestampBuilder";constructor(e,t){super(e,"date","SQLiteTimestamp"),this.config.mode=t}defaultNow(){return this.default(sN.sql`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(e){return new lP(e,this.config)}}class lP extends lC{static [sL.entityKind]="SQLiteTimestamp";mode=this.config.mode;mapFromDriverValue(e){return new Date("timestamp"===this.config.mode?1e3*e:e)}mapToDriverValue(e){let t=e.getTime();return"timestamp"===this.config.mode?Math.floor(t/1e3):t}}class lR extends lE{static [sL.entityKind]="SQLiteBooleanBuilder";constructor(e,t){super(e,"boolean","SQLiteBoolean"),this.config.mode=t}build(e){return new lI(e,this.config)}}class lI extends lC{static [sL.entityKind]="SQLiteBoolean";mode=this.config.mode;mapFromDriverValue(e){return 1===Number(e)}mapToDriverValue(e){return+!!e}}function lU(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return i?.mode==="timestamp"||i?.mode==="timestamp_ms"?new lO(r,i.mode):i?.mode==="boolean"?new lR(r,i.mode):new lq(r)}class lL extends lp{static [sL.entityKind]="SQLiteNumericBuilder";constructor(e){super(e,"string","SQLiteNumeric")}build(e){return new lj(e,this.config)}}class lj extends ly{static [sL.entityKind]="SQLiteNumeric";mapFromDriverValue(e){return"string"==typeof e?e:String(e)}getSQLType(){return"numeric"}}class lN extends lp{static [sL.entityKind]="SQLiteNumericNumberBuilder";constructor(e){super(e,"number","SQLiteNumericNumber")}build(e){return new lK(e,this.config)}}class lK extends ly{static [sL.entityKind]="SQLiteNumericNumber";mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}mapToDriverValue=String;getSQLType(){return"numeric"}}class lD extends lp{static [sL.entityKind]="SQLiteNumericBigIntBuilder";constructor(e){super(e,"bigint","SQLiteNumericBigInt")}build(e){return new lM(e,this.config)}}class lM extends ly{static [sL.entityKind]="SQLiteNumericBigInt";mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return"numeric"}}function lB(e,t){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t),n=i?.mode;return"number"===n?new lN(r):"bigint"===n?new lD(r):new lL(r)}class lH extends lp{static [sL.entityKind]="SQLiteRealBuilder";constructor(e){super(e,"number","SQLiteReal")}build(e){return new lQ(e,this.config)}}class lQ extends ly{static [sL.entityKind]="SQLiteReal";getSQLType(){return"real"}}function lW(e){return new lH(e??"")}class lJ extends lp{static [sL.entityKind]="SQLiteTextBuilder";constructor(e,t){super(e,"string","SQLiteText"),this.config.enumValues=t.enum,this.config.length=t.length}build(e){return new lF(e,this.config)}}class lF extends ly{static [sL.entityKind]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(e,t){super(e,t)}getSQLType(){return`text${this.config.length?`(${this.config.length})`:""}`}}class lV extends lp{static [sL.entityKind]="SQLiteTextJsonBuilder";constructor(e){super(e,"json","SQLiteTextJson")}build(e){return new lz(e,this.config)}}class lz extends ly{static [sL.entityKind]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(e){return JSON.parse(e)}mapToDriverValue(e){return JSON.stringify(e)}}function lG(e,t={}){let{name:r,config:i}=(0,s0.getColumnNameAndConfig)(e,t);return"json"===i.mode?new lV(r):new lJ(r,i)}let lX=Symbol.for("drizzle:SQLiteInlineForeignKeys");class lY extends lm.Table{static [sL.entityKind]="SQLiteTable";static Symbol=Object.assign({},lm.Table.Symbol,{InlineForeignKeys:lX});[lm.Table.Symbol.Columns];[lX]=[];[lm.Table.Symbol.ExtraConfigBuilder]=void 0}let lZ=(e,t,r)=>(function(e,t,r,i,n=e){let s=new lY(e,void 0,n),a=Object.fromEntries(Object.entries("function"==typeof t?t({blob:lA,customType:lx,integer:lU,numeric:lB,real:lW,text:lG}):t).map(([e,t])=>{t.setName(e);let r=t.build(s);return s[lX].push(...t.buildForeignKeys(r,s)),[e,r]})),o=Object.assign(s,a);return o[lm.Table.Symbol.Columns]=a,o[lm.Table.Symbol.ExtraConfigColumns]=a,r&&(o[lY.Symbol.ExtraConfigBuilder]=r),o})(e,t,r);var l0=sN;class l1 extends l0.View{static [sL.entityKind]="SQLiteViewBase"}class l2{static [sL.entityKind]="SQLiteDialect";casing;constructor(e){this.casing=new oD.CasingCache(e?.casing)}escapeName(e){return`"${e}"`}escapeParam(e){return"?"}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[sN.sql`with `];for(let[r,i]of e.entries())t.push(sN.sql`${sN.sql.identifier(i._.alias)} as (${i._.sql})`),r<e.length-1&&t.push(sN.sql`, `);return t.push(sN.sql` `),sN.sql.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:i,limit:n,orderBy:s}){let a=this.buildWithCTE(i),o=r?sN.sql` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,l=t?sN.sql` where ${t}`:void 0,c=this.buildOrderBy(s),u=this.buildLimit(n);return sN.sql`${a}delete from ${e}${l}${o}${c}${u}`}buildUpdateSet(e,t){let r=e[sH.Table.Symbol.Columns],i=Object.keys(r).filter(e=>void 0!==t[e]||r[e]?.onUpdateFn!==void 0),n=i.length;return sN.sql.join(i.flatMap((e,i)=>{let s=r[e],a=s.onUpdateFn?.(),o=t[e]??((0,sL.is)(a,sN.SQL)?a:sN.sql.param(a,s)),l=sN.sql`${sN.sql.identifier(this.casing.getColumnCasing(s))} = ${o}`;return i<n-1?[l,sN.sql.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:t,where:r,returning:i,withList:n,joins:s,from:a,limit:o,orderBy:l}){let c=this.buildWithCTE(n),u=this.buildUpdateSet(e,t),d=a&&sN.sql.join([sN.sql.raw(" from "),this.buildFromTable(a)]),h=this.buildJoins(s),f=i?sN.sql` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,p=r?sN.sql` where ${r}`:void 0,y=this.buildOrderBy(l),m=this.buildLimit(o);return sN.sql`${c}update ${e} set ${u}${d}${h}${p}${f}${y}${m}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,i=e.flatMap(({field:e},i)=>{let n=[];if((0,sL.is)(e,sN.SQL.Aliased)&&e.isSelectionField)n.push(sN.sql.identifier(e.fieldAlias));else if((0,sL.is)(e,sN.SQL.Aliased)||(0,sL.is)(e,sN.SQL)){let r=(0,sL.is)(e,sN.SQL.Aliased)?e.sql:e;t?n.push(new sN.SQL(r.queryChunks.map(e=>(0,sL.is)(e,s2.Column)?sN.sql.identifier(this.casing.getColumnCasing(e)):e))):n.push(r),(0,sL.is)(e,sN.SQL.Aliased)&&n.push(sN.sql` as ${sN.sql.identifier(e.fieldAlias)}`)}else if((0,sL.is)(e,s2.Column)){let r=e.table[sH.Table.Symbol.Name];"SQLiteNumericBigInt"===e.columnType?t?n.push(sN.sql`cast(${sN.sql.identifier(this.casing.getColumnCasing(e))} as text)`):n.push(sN.sql`cast(${sN.sql.identifier(r)}.${sN.sql.identifier(this.casing.getColumnCasing(e))} as text)`):t?n.push(sN.sql.identifier(this.casing.getColumnCasing(e))):n.push(sN.sql`${sN.sql.identifier(r)}.${sN.sql.identifier(this.casing.getColumnCasing(e))}`)}else if((0,sL.is)(e,sK.Subquery)){let t=Object.entries(e._.selectedFields);if(1===t.length){let r=t[0][1],i=(0,sL.is)(r,sN.SQL)?r.decoder:(0,sL.is)(r,s2.Column)?{mapFromDriverValue:e=>r.mapFromDriverValue(e)}:r.sql.decoder;i&&(e._.sql.decoder=i)}n.push(e)}return i<r-1&&n.push(sN.sql`, `),n});return sN.sql.join(i)}buildJoins(e){if(!e||0===e.length)return;let t=[];if(e)for(let[r,i]of e.entries()){0===r&&t.push(sN.sql` `);let n=i.table,s=i.on?sN.sql` on ${i.on}`:void 0;if((0,sL.is)(n,lY)){let e=n[lY.Symbol.Name],r=n[lY.Symbol.Schema],a=n[lY.Symbol.OriginalName],o=e===a?void 0:i.alias;t.push(sN.sql`${sN.sql.raw(i.joinType)} join ${r?sN.sql`${sN.sql.identifier(r)}.`:void 0}${sN.sql.identifier(a)}${o&&sN.sql` ${sN.sql.identifier(o)}`}${s}`)}else t.push(sN.sql`${sN.sql.raw(i.joinType)} join ${n}${s}`);r<e.length-1&&t.push(sN.sql` `)}return sN.sql.join(t)}buildLimit(e){return"object"==typeof e||"number"==typeof e&&e>=0?sN.sql` limit ${e}`:void 0}buildOrderBy(e){let t=[];if(e)for(let[r,i]of e.entries())t.push(i),r<e.length-1&&t.push(sN.sql`, `);return t.length>0?sN.sql` order by ${sN.sql.join(t)}`:void 0}buildFromTable(e){return(0,sL.is)(e,sH.Table)&&e[sH.Table.Symbol.IsAlias]?sN.sql`${sN.sql`${sN.sql.identifier(e[sH.Table.Symbol.Schema]??"")}.`.if(e[sH.Table.Symbol.Schema])}${sN.sql.identifier(e[sH.Table.Symbol.OriginalName])} ${sN.sql.identifier(e[sH.Table.Symbol.Name])}`:e}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:i,having:n,table:s,joins:a,orderBy:o,groupBy:l,limit:c,offset:u,distinct:d,setOperators:h}){let f=r??(0,s0.orderSelectedFields)(t);for(let e of f){let t;if((0,sL.is)(e.field,s2.Column)&&(0,sH.getTableName)(e.field.table)!==((0,sL.is)(s,sK.Subquery)?s._.alias:(0,sL.is)(s,l1)?s[sQ.ViewBaseConfig].name:(0,sL.is)(s,sN.SQL)?void 0:(0,sH.getTableName)(s))&&(t=e.field.table,!a?.some(({alias:e})=>e===(t[sH.Table.Symbol.IsAlias]?(0,sH.getTableName)(t):t[sH.Table.Symbol.BaseName])))){let t=(0,sH.getTableName)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let p=!a||0===a.length,y=this.buildWithCTE(e),m=d?sN.sql` distinct`:void 0,g=this.buildSelection(f,{isSingleTable:p}),b=this.buildFromTable(s),w=this.buildJoins(a),v=i?sN.sql` where ${i}`:void 0,_=n?sN.sql` having ${n}`:void 0,S=[];if(l)for(let[e,t]of l.entries())S.push(t),e<l.length-1&&S.push(sN.sql`, `);let A=S.length>0?sN.sql` group by ${sN.sql.join(S)}`:void 0,k=this.buildOrderBy(o),T=this.buildLimit(c),x=u?sN.sql` offset ${u}`:void 0,E=sN.sql`${y}select${m} ${g} from ${b}${w}${v}${A}${_}${k}${T}${x}`;return h.length>0?this.buildSetOperations(E,h):E}buildSetOperations(e,t){let[r,...i]=t;if(!r)throw Error("Cannot pass undefined values to any set operator");return 0===i.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:i,limit:n,orderBy:s,offset:a}}){let o,l=sN.sql`${e.getSQL()} `,c=sN.sql`${i.getSQL()}`;if(s&&s.length>0){let e=[];for(let t of s)if((0,sL.is)(t,ly))e.push(sN.sql.identifier(t.name));else if((0,sL.is)(t,sN.SQL)){for(let e=0;e<t.queryChunks.length;e++){let r=t.queryChunks[e];(0,sL.is)(r,ly)&&(t.queryChunks[e]=sN.sql.identifier(this.casing.getColumnCasing(r)))}e.push(sN.sql`${t}`)}else e.push(sN.sql`${t}`);o=sN.sql` order by ${sN.sql.join(e,sN.sql`, `)}`}let u="object"==typeof n||"number"==typeof n&&n>=0?sN.sql` limit ${n}`:void 0,d=sN.sql.raw(`${t} ${r?"all ":""}`),h=a?sN.sql` offset ${a}`:void 0;return sN.sql`${l}${d}${c}${o}${u}${h}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:i,withList:n,select:s}){let a=[],o=Object.entries(e[sH.Table.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),l=o.map(([,e])=>sN.sql.identifier(this.casing.getColumnCasing(e)));if(s)(0,sL.is)(t,sN.SQL)?a.push(t):a.push(t.getSQL());else for(let[e,r]of(a.push(sN.sql.raw("values ")),t.entries())){let i=[];for(let[e,t]of o){let n=r[e];if(void 0===n||(0,sL.is)(n,sN.Param)&&void 0===n.value){let e;if(null!==t.default&&void 0!==t.default)e=(0,sL.is)(t.default,sN.SQL)?t.default:sN.sql.param(t.default,t);else if(void 0!==t.defaultFn){let r=t.defaultFn();e=(0,sL.is)(r,sN.SQL)?r:sN.sql.param(r,t)}else if(t.default||void 0===t.onUpdateFn)e=sN.sql`null`;else{let r=t.onUpdateFn();e=(0,sL.is)(r,sN.SQL)?r:sN.sql.param(r,t)}i.push(e)}else i.push(n)}a.push(i),e<t.length-1&&a.push(sN.sql`, `)}let c=this.buildWithCTE(n),u=sN.sql.join(a),d=i?sN.sql` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,h=r?.length?sN.sql.join(r):void 0;return sN.sql`${c}insert into ${e} ${l} ${u}${h}${d}`}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:t})}buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:i,tableConfig:n,queryConfig:s,tableAlias:a,nestedQueryRelation:o,joinOn:l}){let c,u=[],d,h,f=[],p,y=[];if(!0===s)u=Object.entries(n.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:(0,oK.aliasedTableColumn)(t,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let i=Object.fromEntries(Object.entries(n.columns).map(([e,t])=>[e,(0,oK.aliasedTableColumn)(t,a)]));if(s.where){let e="function"==typeof s.where?s.where(i,(0,oB.getOperators)()):s.where;p=e&&(0,oK.mapColumnsInSQLToAlias)(e,a)}let o=[],l=[];if(s.columns){let e=!1;for(let[t,r]of Object.entries(s.columns))void 0!==r&&t in n.columns&&(e||!0!==r||(e=!0),l.push(t));l.length>0&&(l=e?l.filter(e=>s.columns?.[e]===!0):Object.keys(n.columns).filter(e=>!l.includes(e)))}else l=Object.keys(n.columns);for(let e of l){let t=n.columns[e];o.push({tsKey:e,value:t})}let c=[];if(s.with&&(c=Object.entries(s.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:n.relations[e]}))),s.extras)for(let[e,t]of Object.entries("function"==typeof s.extras?s.extras(i,{sql:sN.sql}):s.extras))o.push({tsKey:e,value:(0,oK.mapColumnsInAliasedSQLToAlias)(t,a)});for(let{tsKey:e,value:t}of o)u.push({dbKey:(0,sL.is)(t,sN.SQL.Aliased)?t.fieldAlias:n.columns[e].name,tsKey:e,field:(0,sL.is)(t,s2.Column)?(0,oK.aliasedTableColumn)(t,a):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let y="function"==typeof s.orderBy?s.orderBy(i,(0,oB.getOrderByOperators)()):s.orderBy??[];for(let{tsKey:i,queryConfig:n,relation:o}of(Array.isArray(y)||(y=[y]),f=y.map(e=>(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):(0,oK.mapColumnsInSQLToAlias)(e,a)),d=s.limit,h=s.offset,c)){let s=(0,oB.normalizeRelation)(t,r,o),l=r[(0,sH.getTableUniqueName)(o.referencedTable)],c=`${a}_${i}`,d=(0,oH.and)(...s.fields.map((e,t)=>(0,oH.eq)((0,oK.aliasedTableColumn)(s.references[t],c),(0,oK.aliasedTableColumn)(e,a)))),h=this.buildRelationalQuery({fullSchema:e,schema:t,tableNamesMap:r,table:e[l],tableConfig:t[l],queryConfig:(0,sL.is)(o,oB.One)?!0===n?{limit:1}:{...n,limit:1}:n,tableAlias:c,joinOn:d,nestedQueryRelation:o}),f=sN.sql`(${h.sql})`.as(i);u.push({dbKey:i,tsKey:i,field:f,relationTableTsKey:l,isJson:!0,selection:h.selection})}}if(0===u.length)throw new oM.DrizzleError({message:`No fields selected for table "${n.tsName}" ("${a}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});if(p=(0,oH.and)(l,p),o){let e=sN.sql`json_array(${sN.sql.join(u.map(({field:e})=>(0,sL.is)(e,ly)?sN.sql.identifier(this.casing.getColumnCasing(e)):(0,sL.is)(e,sN.SQL.Aliased)?e.sql:e),sN.sql`, `)})`;(0,sL.is)(o,oB.Many)&&(e=sN.sql`coalesce(json_group_array(${e}), json_array())`);let t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:n.tsName,selection:u}];void 0!==d||void 0!==h||f.length>0?(c=this.buildSelectQuery({table:(0,oK.aliasedTable)(i,a),fields:{},fieldsFlat:[{path:[],field:sN.sql.raw("*")}],where:p,limit:d,offset:h,orderBy:f,setOperators:[]}),p=void 0,d=void 0,h=void 0,f=void 0):c=(0,oK.aliasedTable)(i,a),c=this.buildSelectQuery({table:(0,sL.is)(c,lY)?c:new sK.Subquery(c,{},a),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):e})),joins:y,where:p,limit:d,offset:h,orderBy:f,setOperators:[]})}else c=this.buildSelectQuery({table:(0,oK.aliasedTable)(i,a),fields:{},fieldsFlat:u.map(({field:e})=>({path:[],field:(0,sL.is)(e,s2.Column)?(0,oK.aliasedTableColumn)(e,a):e})),joins:y,where:p,limit:d,offset:h,orderBy:f,setOperators:[]});return{tableTsKey:n.tsName,sql:c,selection:u}}}class l5 extends l2{static [sL.entityKind]="SQLiteSyncDialect";migrate(e,t,r){let i=void 0===r||"string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",n=sN.sql`
			CREATE TABLE IF NOT EXISTS ${sN.sql.identifier(i)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;t.run(n);let s=t.values(sN.sql`SELECT id, hash, created_at FROM ${sN.sql.identifier(i)} ORDER BY created_at DESC LIMIT 1`)[0]??void 0;t.run(sN.sql`BEGIN`);try{for(let r of e)if(!s||Number(s[2])<r.folderMillis){for(let e of r.sql)t.run(sN.sql.raw(e));t.run(sN.sql`INSERT INTO ${sN.sql.identifier(i)} ("hash", "created_at") VALUES(${r.hash}, ${r.folderMillis})`)}t.run(sN.sql`COMMIT`)}catch(e){throw t.run(sN.sql`ROLLBACK`),e}}}class l8 extends l2{static [sL.entityKind]="SQLiteAsyncDialect";async migrate(e,t,r){let i=void 0===r||"string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",n=sN.sql`
			CREATE TABLE IF NOT EXISTS ${sN.sql.identifier(i)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await t.run(n);let s=(await t.values(sN.sql`SELECT id, hash, created_at FROM ${sN.sql.identifier(i)} ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await t.transaction(async t=>{for(let r of e)if(!s||Number(s[2])<r.folderMillis){for(let e of r.sql)await t.run(sN.sql.raw(e));await t.run(sN.sql`INSERT INTO ${sN.sql.identifier(i)} ("hash", "created_at") VALUES(${r.hash}, ${r.folderMillis})`)}})}}var l3=oF;class l4{constructor(e,t){this.name=e,this.value=t}static [sL.entityKind]="SQLiteCheckBuilder";brand;build(e){return new l6(e,this)}}class l6{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}static [sL.entityKind]="SQLiteCheck";name;value}class l9{constructor(e,t){this.name=e,this.unique=t}static [sL.entityKind]="SQLiteIndexBuilderOn";on(...e){return new l7(this.name,e,this.unique)}}class l7{static [sL.entityKind]="SQLiteIndexBuilder";config;constructor(e,t,r){this.config={name:e,columns:t,unique:r,where:void 0}}where(e){return this.config.where=e,this}build(e){return new ce(this.config,e)}}class ce{static [sL.entityKind]="SQLiteIndex";config;constructor(e,t){this.config={...e,table:t}}}function ct(...e){return e[0].columns?new cr(e[0].columns,e[0].name):new cr(e)}class cr{static [sL.entityKind]="SQLitePrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new ci(e,this.columns,this.name)}}class ci{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static [sL.entityKind]="SQLitePrimaryKey";columns;name;getName(){return this.name??`${this.table[lY.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}function cn(e){return(0,sL.is)(e,lY)?[`${e[sH.Table.Symbol.BaseName]}`]:(0,sL.is)(e,sK.Subquery)?e._.usedTables??[]:(0,sL.is)(e,sN.SQL)?e.usedTables??[]:[]}class cs{static [sL.entityKind]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,this.withList=e.withList,this.distinct=e.distinct}from(e){let t,r=!!this.fields;return t=this.fields?this.fields:(0,sL.is)(e,sK.Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,sL.is)(e,l1)?e[sQ.ViewBaseConfig].selectedFields:(0,sL.is)(e,sN.SQL)?{}:(0,s0.getTableColumns)(e),new co({table:e,fields:t,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class ca extends l3.TypedQueryBuilder{static [sL.entityKind]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:r,session:i,dialect:n,withList:s,distinct:a}){for(const o of(super(),this.config={withList:s,table:e,fields:{...t},distinct:a,setOperators:[]},this.isPartialSelect=r,this.session=i,this.dialect=n,this._={selectedFields:t,config:this.config},this.tableName=(0,s0.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},cn(e)))this.usedTables.add(o)}getUsedTables(){return[...this.usedTables]}createJoin(e){return(t,r)=>{let i=this.tableName,n=(0,s0.getTableLikeName)(t);for(let e of cn(t))this.usedTables.add(e);if("string"==typeof n&&this.config.joins?.some(e=>e.alias===n))throw Error(`Alias "${n}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof i&&(this.config.fields={[i]:this.config.fields}),"string"==typeof n&&!(0,sL.is)(t,sN.SQL))){let e=(0,sL.is)(t,sK.Subquery)?t._.selectedFields:(0,sL.is)(t,sN.View)?t[sQ.ViewBaseConfig].selectedFields:t[sH.Table.Symbol.Columns];this.config.fields[n]=e}if("function"==typeof r&&(r=r(new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:n}),"string"==typeof n)switch(e){case"left":this.joinsNotNullableMap[n]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[n]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[n]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[n]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");crossJoin=this.createJoin("cross");createSetOperator(e,t){return r=>{let i="function"==typeof r?r(cc()):r;if(!(0,s0.haveSameKeys)(this.getSelectedFields(),i.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){let t=[];if(t.push(...cn(this.config.table)),this.config.joins)for(let e of this.config.joins)t.push(...cn(e.table));return new Proxy(new sK.Subquery(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new sj.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new sj.SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class co extends ca{static [sL.entityKind]="SQLiteSelect";_prepare(e=!0){if(!this.session)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let t=(0,s0.orderSelectedFields)(this.config.fields),r=this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),t,"all",!0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}$withCache(e){return this.cacheConfig=void 0===e?{config:{},enable:!0,autoInvalidate:!0}:!1===e?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.all()}}function cl(e,t){return(r,i,...n)=>{let s=[i,...n].map(r=>({type:e,isAll:t,rightSelect:r}));for(let e of s)if(!(0,s0.haveSameKeys)(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(s)}}(0,s0.applyMixins)(co,[sB.QueryPromise]);let cc=()=>({union:cu,unionAll:cd,intersect:ch,except:cf}),cu=cl("union",!1),cd=cl("union",!0),ch=cl("intersect",!1),cf=cl("except",!1);class cp{static [sL.entityKind]="SQLiteQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,sL.is)(e,l2)?e:void 0,this.dialectConfig=(0,sL.is)(e,l2)?void 0:e}$with=(e,t)=>{let r=this;return{as:i=>("function"==typeof i&&(i=i(r)),new Proxy(new sK.WithSubquery(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new sj.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;return{select:function(r){return new cs({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(r){return new cs({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e,distinct:!0})}}}select(e){return new cs({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new cs({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new l5(this.dialectConfig)),this.dialect}}var cy=sB;class cm extends cy.QueryPromise{constructor(e,t,r,i){super(),this.table=e,this.session=t,this.dialect=r,this.config={table:e,withList:i}}static [sL.entityKind]="SQLiteDelete";config;where(e){return this.config.where=e,this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.table[sH.Table.Symbol.Columns],new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.orderBy=r}else this.config.orderBy=e;return this}limit(e){return this.config.limit=e,this}returning(e=this.table[lY.Symbol.Columns]){return this.config.returning=(0,s0.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"delete",tables:cn(this.config.table)})}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(e){return this._prepare().execute(e)}$dynamic(){return this}}var cg=sB;class cb{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static [sL.entityKind]="SQLiteInsertBuilder";values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let t=e.map(e=>{let t={},r=this.table[sH.Table.Symbol.Columns];for(let i of Object.keys(e)){let n=e[i];t[i]=(0,sL.is)(n,sN.SQL)?n:new sN.Param(n,r[i])}return t});return new cw(this.table,t,this.session,this.dialect,this.withList)}select(e){let t="function"==typeof e?e(new cp):e;if(!(0,sL.is)(t,sN.SQL)&&!(0,s0.haveSameKeys)(this.table[sH.Columns],t._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new cw(this.table,t,this.session,this.dialect,this.withList,!0)}}class cw extends cg.QueryPromise{constructor(e,t,r,i,n,s){super(),this.session=r,this.dialect=i,this.config={table:e,values:t,withList:n,select:s}}static [sL.entityKind]="SQLiteInsert";config;returning(e=this.config.table[lY.Symbol.Columns]){return this.config.returning=(0,s0.orderSelectedFields)(e),this}onConflictDoNothing(e={}){if(this.config.onConflict||(this.config.onConflict=[]),void 0===e.target)this.config.onConflict.push(sN.sql` on conflict do nothing`);else{let t=Array.isArray(e.target)?sN.sql`${e.target}`:sN.sql`${[e.target]}`,r=e.where?sN.sql` where ${e.where}`:sN.sql``;this.config.onConflict.push(sN.sql` on conflict ${t} do nothing${r}`)}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');this.config.onConflict||(this.config.onConflict=[]);let t=e.where?sN.sql` where ${e.where}`:void 0,r=e.targetWhere?sN.sql` where ${e.targetWhere}`:void 0,i=e.setWhere?sN.sql` where ${e.setWhere}`:void 0,n=Array.isArray(e.target)?sN.sql`${e.target}`:sN.sql`${[e.target]}`,s=this.dialect.buildUpdateSet(this.config.table,(0,s0.mapUpdateSet)(this.config.table,e.set));return this.config.onConflict.push(sN.sql` on conflict ${n}${r} do update set ${s}${t}${i}`),this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:cn(this.config.table)})}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}var cv=sB;class c_{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static [sL.entityKind]="SQLiteUpdateBuilder";set(e){return new cS(this.table,(0,s0.mapUpdateSet)(this.table,e),this.session,this.dialect,this.withList)}}class cS extends cv.QueryPromise{constructor(e,t,r,i,n){super(),this.session=r,this.dialect=i,this.config={set:t,table:e,withList:n,joins:[]}}static [sL.entityKind]="SQLiteUpdate";config;from(e){return this.config.from=e,this}createJoin(e){return(t,r)=>{let i=(0,s0.getTableLikeName)(t);if("string"==typeof i&&this.config.joins.some(e=>e.alias===i))throw Error(`Alias "${i}" is already used in this query`);if("function"==typeof r){let e=this.config.from?(0,sL.is)(t,lY)?t[sH.Table.Symbol.Columns]:(0,sL.is)(t,sK.Subquery)?t._.selectedFields:(0,sL.is)(t,l1)?t[sQ.ViewBaseConfig].selectedFields:void 0:void 0;r=r(new Proxy(this.config.table[sH.Table.Symbol.Columns],new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),e&&new Proxy(e,new sj.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}return this.config.joins.push({on:r,table:t,joinType:e,alias:i}),this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.table[sH.Table.Symbol.Columns],new sj.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.orderBy=r}else this.config.orderBy=e;return this}limit(e){return this.config.limit=e,this}returning(e=this.config.table[lY.Symbol.Columns]){return this.config.returning=(0,s0.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e=!0){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:cn(this.config.table)})}prepare(){return this._prepare(!1)}run=e=>this._prepare().run(e);all=e=>this._prepare().all(e);get=e=>this._prepare().get(e);values=e=>this._prepare().values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}var cA=sN;class ck extends cA.SQL{constructor(e){super(ck.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.session=e.session,this.sql=ck.buildCount(e.source,e.filters)}sql;static [sL.entityKind]="SQLiteCountBuilderAsync";[Symbol.toStringTag]="SQLiteCountBuilderAsync";session;static buildEmbeddedCount(e,t){return cA.sql`(select count(*) from ${e}${cA.sql.raw(" where ").if(t)}${t})`}static buildCount(e,t){return cA.sql`select count(*) from ${e}${cA.sql.raw(" where ").if(t)}${t}`}then(e,t){return Promise.resolve(this.session.count(this.sql)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}var cT=sB;class cx{constructor(e,t,r,i,n,s,a,o){this.mode=e,this.fullSchema=t,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=s,this.dialect=a,this.session=o}static [sL.entityKind]="SQLiteAsyncRelationalQueryBuilder";findMany(e){return"sync"===this.mode?new cC(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many"):new cE(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return"sync"===this.mode?new cC(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first"):new cE(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class cE extends cT.QueryPromise{constructor(e,t,r,i,n,s,a,o,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=a,this.config=o,this.mode=l}static [sL.entityKind]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}_prepare(e=!1){let{query:t,builtQuery:r}=this._toSQL();return this.session[e?"prepareOneTimeQuery":"prepareQuery"](r,void 0,"first"===this.mode?"get":"all",!0,(e,r)=>{let i=e.map(e=>(0,oB.mapRelationalRow)(this.schema,this.tableConfig,e,t.selection,r));return"first"===this.mode?i[0]:i})}prepare(){return this._prepare(!1)}_toSQL(){let e=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return"first"===this.mode?this._prepare(!1).get():this._prepare(!1).all()}async execute(){return this.executeRaw()}}class cC extends cE{static [sL.entityKind]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}var cq=sB;class c$ extends cq.QueryPromise{constructor(e,t,r,i,n){super(),this.execute=e,this.getSQL=t,this.dialect=i,this.mapBatchResult=n,this.config={action:r}}static [sL.entityKind]="SQLiteRaw";config;getQuery(){return{...this.dialect.sqlToQuery(this.getSQL()),method:this.config.action}}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class cO{constructor(e,t,r,i){this.resultKind=e,this.dialect=t,this.session=r,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={};const n=this.query;if(this._.schema)for(const[s,a]of Object.entries(this._.schema))n[s]=new cx(e,i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[s],a,t,r);this.$cache={invalidate:async e=>{}}}static [sL.entityKind]="BaseSQLiteDatabase";query;$with=(e,t)=>{let r=this;return{as:i=>("function"==typeof i&&(i=i(new cp(r.dialect))),new Proxy(new sK.WithSubquery(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new sj.SelectionProxyHandler({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new ck({source:e,filters:t,session:this.session})}with(...e){let t=this;return{select:function(r){return new cs({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new cs({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},update:function(r){return new c_(r,t.session,t.dialect,e)},insert:function(r){return new cb(r,t.session,t.dialect,e)},delete:function(r){return new cm(r,t.session,t.dialect,e)}}}select(e){return new cs({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new cs({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(e){return new c_(e,this.session,this.dialect)}$cache;insert(e){return new cb(e,this.session,this.dialect)}delete(e){return new cm(e,this.session,this.dialect)}run(e){let t="string"==typeof e?sN.sql.raw(e):e.getSQL();return"async"===this.resultKind?new c$(async()=>this.session.run(t),()=>t,"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(t)}all(e){let t="string"==typeof e?sN.sql.raw(e):e.getSQL();return"async"===this.resultKind?new c$(async()=>this.session.all(t),()=>t,"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(t)}get(e){let t="string"==typeof e?sN.sql.raw(e):e.getSQL();return"async"===this.resultKind?new c$(async()=>this.session.get(t),()=>t,"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(t)}values(e){let t="string"==typeof e?sN.sql.raw(e):e.getSQL();return"async"===this.resultKind?new c$(async()=>this.session.values(t),()=>t,"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(t)}transaction(e,t){return this.session.transaction(e,t)}}var cP=e.i(2847),cR=e.i(70988),cI=e.i(94093),cU=e.i(44902),cL=e.i(84259),cj=e.i(3090),cN=e.i(42389),cK=e.i(18916);let cD=process.env.ADMIN_EMAILS?.split(",")??[],{handlers:cM,auth:cB,signIn:cH,signOut:cQ}=function(e){if("function"==typeof e){let t=async t=>{let r=await e(t);return sT(r),sS(sk(t),r)};return{handlers:{GET:t,POST:t},auth:sq(e,e=>sT(e)),signIn:async(t,r,i)=>{let n=await e(void 0);return sT(n),sR(t,r,i,n)},signOut:async t=>{let r=await e(void 0);return sT(r),sI(t,r)},unstable_update:async t=>{let r=await e(void 0);return sT(r),sU(t,r)}}}sT(e);let t=t=>sS(sk(t),e);return{handlers:{GET:t,POST:t},auth:sq(e),signIn:(t,r,i)=>sR(t,r,i,e),signOut:t=>sI(t,e),unstable_update:t=>sU(t,e)}}({adapter:function(e,t){if((0,sL.is)(e,ln))return function(e,t){let{usersTable:r,accountsTable:i,sessionsTable:n,verificationTokensTable:s,authenticatorsTable:a}=function(e={}){let t=e.usersTable??o$("user",{id:ok("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),name:ok("name",{length:255}),email:ok("email",{length:255}).unique(),emailVerified:oy("emailVerified",{mode:"date",fsp:3}),image:ok("image",{length:255})}),r=e.accountsTable??o$("account",{userId:ok("userId",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),type:ok("type",{length:255}).$type().notNull(),provider:ok("provider",{length:255}).notNull(),providerAccountId:ok("providerAccountId",{length:255}).notNull(),refresh_token:ok("refresh_token",{length:255}),access_token:ok("access_token",{length:255}),expires_at:aV("expires_at"),token_type:ok("token_type",{length:255}),scope:ok("scope",{length:255}),id_token:ok("id_token",{length:2048}),session_state:ok("session_state",{length:255})},e=>({compositePk:oO({columns:[e.provider,e.providerAccountId]})})),i=e.sessionsTable??o$("session",{sessionToken:ok("sessionToken",{length:255}).primaryKey(),userId:ok("userId",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),expires:oy("expires",{mode:"date"}).notNull()}),n=e.verificationTokensTable??o$("verificationToken",{identifier:ok("identifier",{length:255}).notNull(),token:ok("token",{length:255}).notNull(),expires:oy("expires",{mode:"date"}).notNull()},e=>({compositePk:oO({columns:[e.identifier,e.token]})})),s=e.authenticatorsTable??o$("authenticator",{credentialID:ok("credentialID",{length:255}).notNull().unique(),userId:ok("userId",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),providerAccountId:ok("providerAccountId",{length:255}).notNull(),credentialPublicKey:ok("credentialPublicKey",{length:255}).notNull(),counter:aV("counter").notNull(),credentialDeviceType:ok("credentialDeviceType",{length:255}).notNull(),credentialBackedUp:ad("credentialBackedUp").notNull(),transports:ok("transports",{length:255})},e=>({compositePk:oO({columns:[e.userId,e.credentialID]})}));return{usersTable:t,accountsTable:r,sessionsTable:i,verificationTokensTable:n,authenticatorsTable:s}}(t);return{async createUser(t){let{id:i,...n}=t,s=(0,s0.getTableColumns)(r).id.defaultFn,[a]=await e.insert(r).values(s?n:{...n,id:i}).$returningId();return e.select().from(r).where((0,oH.eq)(r.id,a?a.id:i)).then(e=>e[0])},getUser:async t=>e.select().from(r).where((0,oH.eq)(r.id,t)).then(e=>e.length>0?e[0]:null),getUserByEmail:async t=>e.select().from(r).where((0,oH.eq)(r.email,t)).then(e=>e.length>0?e[0]:null),createSession:async t=>(await e.insert(n).values(t),e.select().from(n).where((0,oH.eq)(n.sessionToken,t.sessionToken)).then(e=>e[0])),getSessionAndUser:async t=>e.select({session:n,user:r}).from(n).where((0,oH.eq)(n.sessionToken,t)).innerJoin(r,(0,oH.eq)(r.id,n.userId)).then(e=>e.length>0?e[0]:null),async updateUser(t){if(!t.id)throw Error("No user id.");await e.update(r).set(t).where((0,oH.eq)(r.id,t.id));let[i]=await e.select().from(r).where((0,oH.eq)(r.id,t.id));if(!i)throw Error("No user found.");return i},updateSession:async t=>(await e.update(n).set(t).where((0,oH.eq)(n.sessionToken,t.sessionToken)),e.select().from(n).where((0,oH.eq)(n.sessionToken,t.sessionToken)).then(e=>e[0])),async linkAccount(t){await e.insert(i).values(t)},async getUserByAccount(t){let n=await e.select({account:i,user:r}).from(i).innerJoin(r,(0,oH.eq)(i.userId,r.id)).where((0,oH.and)((0,oH.eq)(i.provider,t.provider),(0,oH.eq)(i.providerAccountId,t.providerAccountId))).then(e=>e[0]);return n?.user??null},async deleteSession(t){await e.delete(n).where((0,oH.eq)(n.sessionToken,t))},createVerificationToken:async t=>(await e.insert(s).values(t),e.select().from(s).where((0,oH.eq)(s.identifier,t.identifier)).then(e=>e[0])),async useVerificationToken(t){let r=await e.select().from(s).where((0,oH.and)((0,oH.eq)(s.identifier,t.identifier),(0,oH.eq)(s.token,t.token))).then(e=>e.length>0?e[0]:null);return r&&await e.delete(s).where((0,oH.and)((0,oH.eq)(s.identifier,t.identifier),(0,oH.eq)(s.token,t.token))),r},async deleteUser(t){await e.delete(r).where((0,oH.eq)(r.id,t))},async unlinkAccount(t){await e.delete(i).where((0,oH.and)((0,oH.eq)(i.provider,t.provider),(0,oH.eq)(i.providerAccountId,t.providerAccountId)))},getAccount:async(t,r)=>e.select().from(i).where((0,oH.and)((0,oH.eq)(i.provider,r),(0,oH.eq)(i.providerAccountId,t))).then(e=>e[0]??null),createAuthenticator:async t=>(await e.insert(a).values(t),await e.select().from(a).where((0,oH.eq)(a.credentialID,t.credentialID)).then(e=>e[0]??null)),getAuthenticator:async t=>await e.select().from(a).where((0,oH.eq)(a.credentialID,t)).then(e=>e[0]??null),listAuthenticatorsByUserId:async t=>await e.select().from(a).where((0,oH.eq)(a.userId,t)).then(e=>e),async updateAuthenticatorCounter(t,r){await e.update(a).set({counter:r}).where((0,oH.eq)(a.credentialID,t));let i=await e.select().from(a).where((0,oH.eq)(a.credentialID,t)).then(e=>e[0]);if(!i)throw Error("Authenticator not found.");return i}}}(e,t);if((0,sL.is)(e,ls.PgDatabase))return function(e,t){let{usersTable:r,accountsTable:i,sessionsTable:n,verificationTokensTable:s,authenticatorsTable:a}=function(e={}){let t=e.usersTable??(0,cI.pgTable)("user",{id:(0,cL.text)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),name:(0,cL.text)("name"),email:(0,cL.text)("email").unique(),emailVerified:(0,cj.timestamp)("emailVerified",{mode:"date"}),image:(0,cL.text)("image")}),r=e.accountsTable??(0,cI.pgTable)("account",{userId:(0,cL.text)("userId").notNull().references(()=>t.id,{onDelete:"cascade"}),type:(0,cL.text)("type").$type().notNull(),provider:(0,cL.text)("provider").notNull(),providerAccountId:(0,cL.text)("providerAccountId").notNull(),refresh_token:(0,cL.text)("refresh_token"),access_token:(0,cL.text)("access_token"),expires_at:(0,cR.integer)("expires_at"),token_type:(0,cL.text)("token_type"),scope:(0,cL.text)("scope"),id_token:(0,cL.text)("id_token"),session_state:(0,cL.text)("session_state")},e=>({compositePk:(0,cU.primaryKey)({columns:[e.provider,e.providerAccountId]})})),i=e.sessionsTable??(0,cI.pgTable)("session",{sessionToken:(0,cL.text)("sessionToken").primaryKey(),userId:(0,cL.text)("userId").notNull().references(()=>t.id,{onDelete:"cascade"}),expires:(0,cj.timestamp)("expires",{mode:"date"}).notNull()}),n=e.verificationTokensTable??(0,cI.pgTable)("verificationToken",{identifier:(0,cL.text)("identifier").notNull(),token:(0,cL.text)("token").notNull(),expires:(0,cj.timestamp)("expires",{mode:"date"}).notNull()},e=>({compositePk:(0,cU.primaryKey)({columns:[e.identifier,e.token]})})),s=e.authenticatorsTable??(0,cI.pgTable)("authenticator",{credentialID:(0,cL.text)("credentialID").notNull().unique(),userId:(0,cL.text)("userId").notNull().references(()=>t.id,{onDelete:"cascade"}),providerAccountId:(0,cL.text)("providerAccountId").notNull(),credentialPublicKey:(0,cL.text)("credentialPublicKey").notNull(),counter:(0,cR.integer)("counter").notNull(),credentialDeviceType:(0,cL.text)("credentialDeviceType").notNull(),credentialBackedUp:(0,cP.boolean)("credentialBackedUp").notNull(),transports:(0,cL.text)("transports")},e=>({compositePK:(0,cU.primaryKey)({columns:[e.userId,e.credentialID]})}));return{usersTable:t,accountsTable:r,sessionsTable:i,verificationTokensTable:n,authenticatorsTable:s}}(t);return{async createUser(t){let{id:i,...n}=t,s=(0,s0.getTableColumns)(r).id.hasDefault;return e.insert(r).values(s?n:{...n,id:i}).returning().then(e=>e[0])},getUser:async t=>e.select().from(r).where((0,oH.eq)(r.id,t)).then(e=>e.length>0?e[0]:null),getUserByEmail:async t=>e.select().from(r).where((0,oH.eq)(r.email,t)).then(e=>e.length>0?e[0]:null),createSession:async t=>e.insert(n).values(t).returning().then(e=>e[0]),getSessionAndUser:async t=>e.select({session:n,user:r}).from(n).where((0,oH.eq)(n.sessionToken,t)).innerJoin(r,(0,oH.eq)(r.id,n.userId)).then(e=>e.length>0?e[0]:null),async updateUser(t){if(!t.id)throw Error("No user id.");let[i]=await e.update(r).set(t).where((0,oH.eq)(r.id,t.id)).returning();if(!i)throw Error("No user found.");return i},updateSession:async t=>e.update(n).set(t).where((0,oH.eq)(n.sessionToken,t.sessionToken)).returning().then(e=>e[0]),async linkAccount(t){await e.insert(i).values(t)},async getUserByAccount(t){let n=await e.select({account:i,user:r}).from(i).innerJoin(r,(0,oH.eq)(i.userId,r.id)).where((0,oH.and)((0,oH.eq)(i.provider,t.provider),(0,oH.eq)(i.providerAccountId,t.providerAccountId))).then(e=>e[0]);return n?.user??null},async deleteSession(t){await e.delete(n).where((0,oH.eq)(n.sessionToken,t))},createVerificationToken:async t=>e.insert(s).values(t).returning().then(e=>e[0]),useVerificationToken:async t=>e.delete(s).where((0,oH.and)((0,oH.eq)(s.identifier,t.identifier),(0,oH.eq)(s.token,t.token))).returning().then(e=>e.length>0?e[0]:null),async deleteUser(t){await e.delete(r).where((0,oH.eq)(r.id,t))},async unlinkAccount(t){await e.delete(i).where((0,oH.and)((0,oH.eq)(i.provider,t.provider),(0,oH.eq)(i.providerAccountId,t.providerAccountId)))},getAccount:async(t,r)=>e.select().from(i).where((0,oH.and)((0,oH.eq)(i.provider,r),(0,oH.eq)(i.providerAccountId,t))).then(e=>e[0]??null),createAuthenticator:async t=>e.insert(a).values(t).returning().then(e=>e[0]??null),getAuthenticator:async t=>e.select().from(a).where((0,oH.eq)(a.credentialID,t)).then(e=>e[0]??null),listAuthenticatorsByUserId:async t=>e.select().from(a).where((0,oH.eq)(a.userId,t)).then(e=>e),async updateAuthenticatorCounter(t,r){let i=await e.update(a).set({counter:r}).where((0,oH.eq)(a.credentialID,t)).returning().then(e=>e[0]);if(!i)throw Error("Authenticator not found.");return i}}}(e,t);if((0,sL.is)(e,cO))return function(e,t){let{usersTable:r,accountsTable:i,sessionsTable:n,verificationTokensTable:s,authenticatorsTable:a}=function(e={}){let t=e.usersTable??lZ("user",{id:lG("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),name:lG("name"),email:lG("email").unique(),emailVerified:lU("emailVerified",{mode:"timestamp_ms"}),image:lG("image")}),r=e.accountsTable??lZ("account",{userId:lG("userId").notNull().references(()=>t.id,{onDelete:"cascade"}),type:lG("type").$type().notNull(),provider:lG("provider").notNull(),providerAccountId:lG("providerAccountId").notNull(),refresh_token:lG("refresh_token"),access_token:lG("access_token"),expires_at:lU("expires_at"),token_type:lG("token_type"),scope:lG("scope"),id_token:lG("id_token"),session_state:lG("session_state")},e=>({compositePk:ct({columns:[e.provider,e.providerAccountId]})})),i=e.sessionsTable??lZ("session",{sessionToken:lG("sessionToken").primaryKey(),userId:lG("userId").notNull().references(()=>t.id,{onDelete:"cascade"}),expires:lU("expires",{mode:"timestamp_ms"}).notNull()}),n=e.verificationTokensTable??lZ("verificationToken",{identifier:lG("identifier").notNull(),token:lG("token").notNull(),expires:lU("expires",{mode:"timestamp_ms"}).notNull()},e=>({compositePk:ct({columns:[e.identifier,e.token]})})),s=e.authenticatorsTable??lZ("authenticator",{credentialID:lG("credentialID").notNull().unique(),userId:lG("userId").notNull().references(()=>t.id,{onDelete:"cascade"}),providerAccountId:lG("providerAccountId").notNull(),credentialPublicKey:lG("credentialPublicKey").notNull(),counter:lU("counter").notNull(),credentialDeviceType:lG("credentialDeviceType").notNull(),credentialBackedUp:lU("credentialBackedUp",{mode:"boolean"}).notNull(),transports:lG("transports")},e=>({compositePK:ct({columns:[e.userId,e.credentialID]})}));return{usersTable:t,accountsTable:r,sessionsTable:i,verificationTokensTable:n,authenticatorsTable:s}}(t);return{async createUser(t){let{id:i,...n}=t,s=(0,s0.getTableColumns)(r).id.hasDefault;return e.insert(r).values(s?n:{...n,id:i}).returning().get()},getUser:async t=>await e.select().from(r).where((0,oH.eq)(r.id,t)).get()??null,getUserByEmail:async t=>await e.select().from(r).where((0,oH.eq)(r.email,t)).get()??null,createSession:async t=>e.insert(n).values(t).returning().get(),getSessionAndUser:async t=>await e.select({session:n,user:r}).from(n).where((0,oH.eq)(n.sessionToken,t)).innerJoin(r,(0,oH.eq)(r.id,n.userId)).get()??null,async updateUser(t){if(!t.id)throw Error("No user id.");let i=await e.update(r).set(t).where((0,oH.eq)(r.id,t.id)).returning().get();if(!i)throw Error("User not found.");return i},updateSession:async t=>await e.update(n).set(t).where((0,oH.eq)(n.sessionToken,t.sessionToken)).returning().get()??null,async linkAccount(t){await e.insert(i).values(t).run()},async getUserByAccount(t){let n=await e.select({account:i,user:r}).from(i).innerJoin(r,(0,oH.eq)(i.userId,r.id)).where((0,oH.and)((0,oH.eq)(i.provider,t.provider),(0,oH.eq)(i.providerAccountId,t.providerAccountId))).get();return n?.user??null},async deleteSession(t){await e.delete(n).where((0,oH.eq)(n.sessionToken,t)).run()},createVerificationToken:async t=>e.insert(s).values(t).returning().get(),useVerificationToken:async t=>await e.delete(s).where((0,oH.and)((0,oH.eq)(s.identifier,t.identifier),(0,oH.eq)(s.token,t.token))).returning().get()??null,async deleteUser(t){await e.delete(r).where((0,oH.eq)(r.id,t)).run()},async unlinkAccount(t){await e.delete(i).where((0,oH.and)((0,oH.eq)(i.provider,t.provider),(0,oH.eq)(i.providerAccountId,t.providerAccountId))).run()},getAccount:async(t,r)=>e.select().from(i).where((0,oH.and)((0,oH.eq)(i.provider,r),(0,oH.eq)(i.providerAccountId,t))).then(e=>e[0]??null),createAuthenticator:async t=>e.insert(a).values(t).returning().then(e=>e[0]??null),getAuthenticator:async t=>e.select().from(a).where((0,oH.eq)(a.credentialID,t)).then(e=>e[0]??null),listAuthenticatorsByUserId:async t=>e.select().from(a).where((0,oH.eq)(a.userId,t)).then(e=>e),async updateAuthenticatorCounter(t,r){let i=await e.update(a).set({counter:r}).where((0,oH.eq)(a.credentialID,t)).returning().then(e=>e[0]);if(!i)throw Error("Authenticator not found.");return i}}}(e,t);throw Error(`Unsupported database type (${typeof e}) in Auth.js Drizzle adapter.`)}(cN.db,{usersTable:cK.users,accountsTable:cK.accounts,sessionsTable:cK.sessions,verificationTokensTable:cK.verificationTokens}),providers:[{id:"google",name:"Google",type:"oidc",issuer:"https://accounts.google.com",style:{brandColor:"#1a73e8"},options:{clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}}],callbacks:{signIn:async({user:e})=>(e.email&&cD.includes(e.email)&&await cN.db.update(cK.users).set({isAdmin:!0}).where((0,oH.eq)(cK.users.email,e.email)),!0),async session({session:e,user:t}){let r=await cN.db.query.users.findFirst({where:(0,oH.eq)(cK.users.id,t.id)});return{...e,user:{...e.user,id:t.id,isAdmin:r?.isAdmin??!1}}}},pages:{signIn:"/login"},trustHost:!0});e.s(["auth",0,cB,"handlers",0,cM],79832)}];

//# sourceMappingURL=_c33e7995._.js.map